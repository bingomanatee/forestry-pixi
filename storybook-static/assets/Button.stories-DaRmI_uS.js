const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browserAll-BODYnKN9.js","./webworkerAll-6hH4FFJl.js","./Filter-CFOHMjB2.js","./preload-helper-PPVm8Dsz.js","./WebGPURenderer-DKtx2ycj.js","./BufferResource-DrwXaSpG.js","./RenderTargetSystem-3VGvhpXY.js","./WebGLRenderer-DHQmtMNf.js","./CanvasRenderer-CI5ejc0P.js","./BitmapFont-BcPVUjuR.js"])))=>i.map(i=>d[i]);
import{_ as Qe}from"./preload-helper-PPVm8Dsz.js";var E=(e=>(e.Application="application",e.WebGLPipes="webgl-pipes",e.WebGLPipesAdaptor="webgl-pipes-adaptor",e.WebGLSystem="webgl-system",e.WebGPUPipes="webgpu-pipes",e.WebGPUPipesAdaptor="webgpu-pipes-adaptor",e.WebGPUSystem="webgpu-system",e.CanvasSystem="canvas-system",e.CanvasPipesAdaptor="canvas-pipes-adaptor",e.CanvasPipes="canvas-pipes",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e.MaskEffect="mask-effect",e.BlendMode="blend-mode",e.TextureSource="texture-source",e.Environment="environment",e.ShapeBuilder="shape-builder",e.Batcher="batcher",e))(E||{});const Si=e=>{if(typeof e=="function"||typeof e=="object"&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={...typeof e.extension!="object"?{type:e.extension}:e.extension,ref:e}}if(typeof e=="object")e={...e};else throw new Error("Invalid extension type");return typeof e.type=="string"&&(e.type=[e.type]),e},Ar=(e,t)=>Si(e).priority??t,Y={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(Si).forEach(t=>{t.type.forEach(n=>this._removeHandlers[n]?.(t))}),this},add(...e){return e.map(Si).forEach(t=>{t.type.forEach(n=>{const r=this._addHandlers,s=this._queue;r[n]?r[n]?.(t):(s[n]=s[n]||[],s[n]?.push(t))})}),this},handle(e,t,n){const r=this._addHandlers,s=this._removeHandlers;if(r[e]||s[e])throw new Error(`Extension type ${e} already has a handler`);r[e]=t,s[e]=n;const i=this._queue;return i[e]&&(i[e]?.forEach(o=>t(o)),delete i[e]),this},handleByMap(e,t){return this.handle(e,n=>{n.name&&(t[n.name]=n.ref)},n=>{n.name&&delete t[n.name]})},handleByNamedList(e,t,n=-1){return this.handle(e,r=>{t.findIndex(i=>i.name===r.name)>=0||(t.push({name:r.name,value:r.ref}),t.sort((i,o)=>Ar(o.value,n)-Ar(i.value,n)))},r=>{const s=t.findIndex(i=>i.name===r.name);s!==-1&&t.splice(s,1)})},handleByList(e,t,n=-1){return this.handle(e,r=>{t.includes(r.ref)||(t.push(r.ref),t.sort((s,i)=>Ar(i,n)-Ar(s,n)))},r=>{const s=t.indexOf(r.ref);s!==-1&&t.splice(s,1)})},mixin(e,...t){for(const n of t)Object.defineProperties(e.prototype,Object.getOwnPropertyDescriptors(n))}},Ld={extension:{type:E.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Qe(()=>import("./browserAll-BODYnKN9.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)}},Gd={extension:{type:E.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Qe(()=>import("./webworkerAll-6hH4FFJl.js"),__vite__mapDeps([1,2,3]),import.meta.url)}};class yt{constructor(t,n,r){this._x=n||0,this._y=r||0,this._observer=t}clone(t){return new yt(t??this._observer,this._x,this._y)}set(t=0,n=t){return(this._x!==t||this._y!==n)&&(this._x=t,this._y=n,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}function Hh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Os={exports:{}},ua;function jd(){return ua||(ua=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,h,l){this.fn=c,this.context=h,this.once=l||!1}function i(c,h,l,u,f){if(typeof l!="function")throw new TypeError("The listener must be a function");var d=new s(l,u||c,f),p=n?n+h:h;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],d]:c._events[p].push(d):(c._events[p]=d,c._eventsCount++),c}function o(c,h){--c._eventsCount===0?c._events=new r:delete c._events[h]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],l,u;if(this._eventsCount===0)return h;for(u in l=this._events)t.call(l,u)&&h.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(l)):h},a.prototype.listeners=function(h){var l=n?n+h:h,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var f=0,d=u.length,p=new Array(d);f<d;f++)p[f]=u[f].fn;return p},a.prototype.listenerCount=function(h){var l=n?n+h:h,u=this._events[l];return u?u.fn?1:u.length:0},a.prototype.emit=function(h,l,u,f,d,p){var m=n?n+h:h;if(!this._events[m])return!1;var g=this._events[m],y=arguments.length,x,b;if(g.fn){switch(g.once&&this.removeListener(h,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,l),!0;case 3:return g.fn.call(g.context,l,u),!0;case 4:return g.fn.call(g.context,l,u,f),!0;case 5:return g.fn.call(g.context,l,u,f,d),!0;case 6:return g.fn.call(g.context,l,u,f,d,p),!0}for(b=1,x=new Array(y-1);b<y;b++)x[b-1]=arguments[b];g.fn.apply(g.context,x)}else{var _=g.length,v;for(b=0;b<_;b++)switch(g[b].once&&this.removeListener(h,g[b].fn,void 0,!0),y){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,l);break;case 3:g[b].fn.call(g[b].context,l,u);break;case 4:g[b].fn.call(g[b].context,l,u,f);break;default:if(!x)for(v=1,x=new Array(y-1);v<y;v++)x[v-1]=arguments[v];g[b].fn.apply(g[b].context,x)}}return!0},a.prototype.on=function(h,l,u){return i(this,h,l,u,!1)},a.prototype.once=function(h,l,u){return i(this,h,l,u,!0)},a.prototype.removeListener=function(h,l,u,f){var d=n?n+h:h;if(!this._events[d])return this;if(!l)return o(this,d),this;var p=this._events[d];if(p.fn)p.fn===l&&(!f||p.once)&&(!u||p.context===u)&&o(this,d);else{for(var m=0,g=[],y=p.length;m<y;m++)(p[m].fn!==l||f&&!p[m].once||u&&p[m].context!==u)&&g.push(p[m]);g.length?this._events[d]=g.length===1?g[0]:g:o(this,d)}return this},a.prototype.removeAllListeners=function(h){var l;return h?(l=n?n+h:h,this._events[l]&&o(this,l)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})(Os)),Os.exports}var Nd=jd();const qt=Hh(Nd),Ud=Math.PI*2,Wd=180/Math.PI,Vd=Math.PI/180;class At{constructor(t=0,n=0){this.x=0,this.y=0,this.x=t,this.y=n}clone(){return new At(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,n=t){return this.x=t,this.y=n,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Bs.x=0,Bs.y=0,Bs}}const Bs=new At;class D{constructor(t=1,n=0,r=0,s=1,i=0,o=0){this.array=null,this.a=t,this.b=n,this.c=r,this.d=s,this.tx=i,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,n,r,s,i,o){return this.a=t,this.b=n,this.c=r,this.d=s,this.tx=i,this.ty=o,this}toArray(t,n){this.array||(this.array=new Float32Array(9));const r=n||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,n){n=n||new At;const r=t.x,s=t.y;return n.x=this.a*r+this.c*s+this.tx,n.y=this.b*r+this.d*s+this.ty,n}applyInverse(t,n){n=n||new At;const r=this.a,s=this.b,i=this.c,o=this.d,a=this.tx,c=this.ty,h=1/(r*o+i*-s),l=t.x,u=t.y;return n.x=o*h*l+-i*h*u+(c*i-a*o)*h,n.y=r*h*u+-s*h*l+(-c*r+a*s)*h,n}translate(t,n){return this.tx+=t,this.ty+=n,this}scale(t,n){return this.a*=t,this.d*=n,this.c*=t,this.b*=n,this.tx*=t,this.ty*=n,this}rotate(t){const n=Math.cos(t),r=Math.sin(t),s=this.a,i=this.c,o=this.tx;return this.a=s*n-this.b*r,this.b=s*r+this.b*n,this.c=i*n-this.d*r,this.d=i*r+this.d*n,this.tx=o*n-this.ty*r,this.ty=o*r+this.ty*n,this}append(t){const n=this.a,r=this.b,s=this.c,i=this.d;return this.a=t.a*n+t.b*s,this.b=t.a*r+t.b*i,this.c=t.c*n+t.d*s,this.d=t.c*r+t.d*i,this.tx=t.tx*n+t.ty*s+this.tx,this.ty=t.tx*r+t.ty*i+this.ty,this}appendFrom(t,n){const r=t.a,s=t.b,i=t.c,o=t.d,a=t.tx,c=t.ty,h=n.a,l=n.b,u=n.c,f=n.d;return this.a=r*h+s*u,this.b=r*l+s*f,this.c=i*h+o*u,this.d=i*l+o*f,this.tx=a*h+c*u+n.tx,this.ty=a*l+c*f+n.ty,this}setTransform(t,n,r,s,i,o,a,c,h){return this.a=Math.cos(a+h)*i,this.b=Math.sin(a+h)*i,this.c=-Math.sin(a-c)*o,this.d=Math.cos(a-c)*o,this.tx=t-(r*this.a+s*this.c),this.ty=n-(r*this.b+s*this.d),this}prepend(t){const n=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const r=this.a,s=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=n*t.a+this.ty*t.c+t.tx,this.ty=n*t.b+this.ty*t.d+t.ty,this}decompose(t){const n=this.a,r=this.b,s=this.c,i=this.d,o=t.pivot,a=-Math.atan2(-s,i),c=Math.atan2(r,n),h=Math.abs(a+c);return h<1e-5||Math.abs(Ud-h)<1e-5?(t.rotation=c,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=c),t.scale.x=Math.sqrt(n*n+r*r),t.scale.y=Math.sqrt(s*s+i*i),t.position.x=this.tx+(o.x*n+o.y*s),t.position.y=this.ty+(o.x*r+o.y*i),t}invert(){const t=this.a,n=this.b,r=this.c,s=this.d,i=this.tx,o=t*s-n*r;return this.a=s/o,this.b=-n/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-s*i)/o,this.ty=-(t*this.ty-n*i)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new D;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return Hd.identity()}static get shared(){return Zd.identity()}}const Zd=new D,Hd=new D,Pe=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ke=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Me=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ee=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ai=[],Yh=[],Tr=Math.sign;function Yd(){for(let e=0;e<16;e++){const t=[];Ai.push(t);for(let n=0;n<16;n++){const r=Tr(Pe[e]*Pe[n]+Me[e]*ke[n]),s=Tr(ke[e]*Pe[n]+Ee[e]*ke[n]),i=Tr(Pe[e]*Me[n]+Me[e]*Ee[n]),o=Tr(ke[e]*Me[n]+Ee[e]*Ee[n]);for(let a=0;a<16;a++)if(Pe[a]===r&&ke[a]===s&&Me[a]===i&&Ee[a]===o){t.push(a);break}}}for(let e=0;e<16;e++){const t=new D;t.set(Pe[e],ke[e],Me[e],Ee[e],0,0),Yh.push(t)}}Yd();const V={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>Pe[e],uY:e=>ke[e],vX:e=>Me[e],vY:e=>Ee[e],inv:e=>e&8?e&15:-e&7,add:(e,t)=>Ai[e][t],sub:(e,t)=>Ai[e][V.inv(t)],rotate180:e=>e^4,isVertical:e=>(e&3)===2,byDirection:(e,t)=>Math.abs(e)*2<=Math.abs(t)?t>=0?V.S:V.N:Math.abs(t)*2<=Math.abs(e)?e>0?V.E:V.W:t>0?e>0?V.SE:V.SW:e>0?V.NE:V.NW,matrixAppendRotationInv:(e,t,n=0,r=0,s=0,i=0)=>{const o=Yh[V.inv(t)],a=o.a,c=o.b,h=o.c,l=o.d,u=n-Math.min(0,a*s,h*i,a*s+h*i),f=r-Math.min(0,c*s,l*i,c*s+l*i),d=e.a,p=e.b,m=e.c,g=e.d;e.a=a*d+c*m,e.b=a*p+c*g,e.c=h*d+l*m,e.d=h*p+l*g,e.tx=u*d+f*m+e.tx,e.ty=u*p+f*g+e.ty},transformRectCoords:(e,t,n,r)=>{const{x:s,y:i,width:o,height:a}=e,{x:c,y:h,width:l,height:u}=t;return n===V.E?(r.set(s+c,i+h,o,a),r):n===V.S?r.set(l-i-a+c,s+h,a,o):n===V.W?r.set(l-s-o+c,u-i-a+h,o,a):n===V.N?r.set(i+c,u-s-o+h,a,o):r.set(s+c,i+h,o,a)}},Cr=[new At,new At,new At,new At];class at{constructor(t=0,n=0,r=0,s=0){this.type="rectangle",this.x=Number(t),this.y=Number(n),this.width=Number(r),this.height=Number(s)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new at(0,0,0,0)}clone(){return new at(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,n){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&n>=this.y&&n<this.y+this.height}strokeContains(t,n,r,s=.5){const{width:i,height:o}=this;if(i<=0||o<=0)return!1;const a=this.x,c=this.y,h=r*(1-s),l=r-h,u=a-h,f=a+i+h,d=c-h,p=c+o+h,m=a+l,g=a+i-l,y=c+l,x=c+o-l;return t>=u&&t<=f&&n>=d&&n<=p&&!(t>m&&t<g&&n>y&&n<x)}intersects(t,n){if(!n){const k=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=k)return!1;const C=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>C}const r=this.left,s=this.right,i=this.top,o=this.bottom;if(s<=r||o<=i)return!1;const a=Cr[0].set(t.left,t.top),c=Cr[1].set(t.left,t.bottom),h=Cr[2].set(t.right,t.top),l=Cr[3].set(t.right,t.bottom);if(h.x<=a.x||c.y<=a.y)return!1;const u=Math.sign(n.a*n.d-n.b*n.c);if(u===0||(n.apply(a,a),n.apply(c,c),n.apply(h,h),n.apply(l,l),Math.max(a.x,c.x,h.x,l.x)<=r||Math.min(a.x,c.x,h.x,l.x)>=s||Math.max(a.y,c.y,h.y,l.y)<=i||Math.min(a.y,c.y,h.y,l.y)>=o))return!1;const f=u*(c.y-a.y),d=u*(a.x-c.x),p=f*r+d*i,m=f*s+d*i,g=f*r+d*o,y=f*s+d*o;if(Math.max(p,m,g,y)<=f*a.x+d*a.y||Math.min(p,m,g,y)>=f*l.x+d*l.y)return!1;const x=u*(a.y-h.y),b=u*(h.x-a.x),_=x*r+b*i,v=x*s+b*i,w=x*r+b*o,A=x*s+b*o;return!(Math.max(_,v,w,A)<=x*a.x+b*a.y||Math.min(_,v,w,A)>=x*l.x+b*l.y)}pad(t=0,n=t){return this.x-=t,this.y-=n,this.width+=t*2,this.height+=n*2,this}fit(t){const n=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=n,this.width=Math.max(r-n,0),this.y=s,this.height=Math.max(i-s,0),this}ceil(t=1,n=.001){const r=Math.ceil((this.x+this.width-n)*t)/t,s=Math.ceil((this.y+this.height-n)*t)/t;return this.x=Math.floor((this.x+n)*t)/t,this.y=Math.floor((this.y+n)*t)/t,this.width=r-this.x,this.height=s-this.y,this}scale(t,n=t){return this.x*=t,this.y*=n,this.width*=t,this.height*=n,this}enlarge(t){const n=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=n,this.width=r-n,this.y=s,this.height=i-s,this}getBounds(t){return t||(t=new at),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const n=t.x,r=t.y,s=t.x+t.width,i=t.y+t.height;return n>=this.x&&n<this.x+this.width&&r>=this.y&&r<this.y+this.height&&s>=this.x&&s<this.x+this.width&&i>=this.y&&i<this.y+this.height}set(t,n,r,s){return this.x=t,this.y=n,this.width=r,this.height=s,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Fs={default:-1};function it(e="default"){return Fs[e]===void 0&&(Fs[e]=-1),++Fs[e]}const da=new Set,st="8.0.0",Xd="8.3.4",Ye={quiet:!1,noColor:!1},G=((e,t,n=3)=>{if(Ye.quiet||da.has(t))return;let r=new Error().stack;const s=`${t}
Deprecated since v${e}`,i=typeof console.groupCollapsed=="function"&&!Ye.noColor;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",s):(r=r.split(`
`).splice(n).join(`
`),i?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",s),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",s),console.warn(r))),da.add(t)});Object.defineProperties(G,{quiet:{get:()=>Ye.quiet,set:e=>{Ye.quiet=e},enumerable:!0,configurable:!1},noColor:{get:()=>Ye.noColor,set:e=>{Ye.noColor=e},enumerable:!0,configurable:!1}});const Xh=()=>{};function on(e){return e+=e===0?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1}function fa(e){return!(e&e-1)&&!!e}function qh(e){const t={};for(const n in e)e[n]!==void 0&&(t[n]=e[n]);return t}const pa=Object.create(null);function qd(e){const t=pa[e];return t===void 0&&(pa[e]=it("resource")),t}const Kh=class Jh extends qt{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Jh.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){G(st,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this._sharedResourceId=null,this.emit("change",this)}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=qd(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Kh.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let an=Kh;const Qh=class tl extends qt{constructor(t={}){super(),this.options=t,this._gpuData=Object.create(null),this._gcLastUsed=-1,this.uid=it("textureSource"),this._resourceType="textureSource",this._resourceId=it("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.viewDimension="2d",this.arrayLayerCount=1,this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...tl.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.viewDimension=t.viewDimension??t.dimensions,this.arrayLayerCount=t.arrayLayerCount,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new an(qh(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){this.style!==t&&(this._style?.off("change",this._onStyleChange,this),this._style=t,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(t){this._style.maxAnisotropy=t}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.unload(),this.emit("destroy",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=it("resource"),this.emit("change",this),this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy?.();this._gpuData=Object.create(null)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,n,r){r||(r=this._resolution),t||(t=this.width),n||(n=this.height);const s=Math.round(t*r),i=Math.round(n*r);return this.width=s/r,this.height=i/r,this._resolution=r,this.pixelWidth===s&&this.pixelHeight===i?!1:(this._refreshPOT(),this.pixelWidth=s,this.pixelHeight=i,this.emit("resize",this),this._resourceId=it("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=fa(this.pixelWidth)&&fa(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Qh.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",viewDimension:"2d",arrayLayerCount:1,mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Wt=Qh;class Po extends Wt{constructor(t){const n=t.resource||new Float32Array(t.width*t.height*4);let r=t.format;r||(n instanceof Float32Array?r="rgba32float":n instanceof Int32Array||n instanceof Uint32Array?r="rgba32uint":n instanceof Int16Array||n instanceof Uint16Array?r="rgba16uint":(n instanceof Int8Array,r="bgra8unorm")),super({...t,resource:n,format:r}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}Po.extension=E.TextureSource;const ma=new D;class Kd{constructor(t,n){this.mapCoord=new D,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof n>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=n,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){this.texture!==t&&(this._texture?.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,n){n===void 0&&(n=t);const r=this.mapCoord;for(let s=0;s<t.length;s+=2){const i=t[s],o=t[s+1];n[s]=i*r.a+o*r.c+r.tx,n[s+1]=i*r.b+o*r.d+r.ty}return n}update(){const t=this._texture;this._updateID++;const n=t.uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const r=t.orig,s=t.trim;s&&(ma.set(r.width/s.width,0,0,r.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(ma));const i=t.source,o=this.uClampFrame,a=this.clampMargin/i._resolution,c=this.clampOffset/i._resolution;return o[0]=(t.frame.x+a+c)/i.width,o[1]=(t.frame.y+a+c)/i.height,o[2]=(t.frame.x+t.frame.width-a+c)/i.width,o[3]=(t.frame.y+t.frame.height-a+c)/i.height,this.uClampOffset[0]=this.clampOffset/i.pixelWidth,this.uClampOffset[1]=this.clampOffset/i.pixelHeight,this.isSimple=t.frame.width===i.width&&t.frame.height===i.height&&t.rotate===0,!0}}class U extends qt{constructor({source:t,label:n,frame:r,orig:s,trim:i,defaultAnchor:o,defaultBorders:a,rotate:c,dynamic:h}={}){if(super(),this.uid=it("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new at,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=n,this.source=t?.source??new Wt,this.noFrame=!r,r)this.frame.copyFrom(r);else{const{width:l,height:u}=this._source;this.frame.width=l,this.frame.height=u}this.orig=s||this.frame,this.trim=i,this.rotate=c??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=h||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new Kd(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:n}=this,{width:r,height:s}=this._source,i=n.x/r,o=n.y/s,a=n.width/r,c=n.height/s;let h=this.rotate;if(h){const l=a/2,u=c/2,f=i+l,d=o+u;h=V.add(h,V.NW),t.x0=f+l*V.uX(h),t.y0=d+u*V.uY(h),h=V.add(h,2),t.x1=f+l*V.uX(h),t.y1=d+u*V.uY(h),h=V.add(h,2),t.x2=f+l*V.uX(h),t.y2=d+u*V.uY(h),h=V.add(h,2),t.x3=f+l*V.uX(h),t.y3=d+u*V.uY(h)}else t.x0=i,t.y0=o,t.x1=i+a,t.y1=o,t.x2=i+a,t.y2=o+c,t.x3=i,t.y3=o+c}destroy(t=!1){this._source&&(this._source.off("resize",this.update,this),t&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return G(st,"Texture.baseTexture is now Texture.source"),this._source}}U.EMPTY=new U({label:"EMPTY",source:new Wt({label:"EMPTY"})});U.EMPTY.destroy=Xh;U.WHITE=new U({source:new Po({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});U.WHITE.destroy=Xh;function el(e,t,n){const{width:r,height:s}=n.orig,i=n.trim;if(i){const o=i.width,a=i.height;e.minX=i.x-t._x*r,e.maxX=e.minX+o,e.minY=i.y-t._y*s,e.maxY=e.minY+a}else e.minX=-t._x*r,e.maxX=e.minX+r,e.minY=-t._y*s,e.maxY=e.minY+s}const ga=new D;class Dt{constructor(t=1/0,n=1/0,r=-1/0,s=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ga,this.minX=t,this.minY=n,this.maxX=r,this.maxY=s}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new at);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ga,this}set(t,n,r,s){this.minX=t,this.minY=n,this.maxX=r,this.maxY=s}addFrame(t,n,r,s,i){i||(i=this.matrix);const o=i.a,a=i.b,c=i.c,h=i.d,l=i.tx,u=i.ty;let f=this.minX,d=this.minY,p=this.maxX,m=this.maxY,g=o*t+c*n+l,y=a*t+h*n+u;g<f&&(f=g),y<d&&(d=y),g>p&&(p=g),y>m&&(m=y),g=o*r+c*n+l,y=a*r+h*n+u,g<f&&(f=g),y<d&&(d=y),g>p&&(p=g),y>m&&(m=y),g=o*t+c*s+l,y=a*t+h*s+u,g<f&&(f=g),y<d&&(d=y),g>p&&(p=g),y>m&&(m=y),g=o*r+c*s+l,y=a*r+h*s+u,g<f&&(f=g),y<d&&(d=y),g>p&&(p=g),y>m&&(m=y),this.minX=f,this.minY=d,this.maxX=p,this.maxY=m}addRect(t,n){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,n)}addBounds(t,n){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,n)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const n=this.minX,r=this.minY,s=this.maxX,i=this.maxY,{a:o,b:a,c,d:h,tx:l,ty:u}=t;let f=o*n+c*r+l,d=a*n+h*r+u;this.minX=f,this.minY=d,this.maxX=f,this.maxY=d,f=o*s+c*r+l,d=a*s+h*r+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=o*n+c*i+l,d=a*n+h*i+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=o*s+c*i+l,d=a*s+h*i+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,n,r,s){return this.minX<t&&(this.minX=t),this.maxX>n&&(this.maxX=n),this.minY<r&&(this.minY=r),this.maxY>s&&(this.maxY=s),this}pad(t,n=t){return this.minX-=t,this.maxX+=t,this.minY-=n,this.maxY+=n,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Dt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,n=t){return this.minX*=t,this.minY*=n,this.maxX*=t,this.maxY*=n,this}get x(){return this.minX}set x(t){const n=this.maxX-this.minX;this.minX=t,this.maxX=t+n}get y(){return this.minY}set y(t){const n=this.maxY-this.minY;this.minY=t,this.maxY=t+n}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,n,r,s){let i=this.minX,o=this.minY,a=this.maxX,c=this.maxY;s||(s=this.matrix);const h=s.a,l=s.b,u=s.c,f=s.d,d=s.tx,p=s.ty;for(let m=n;m<r;m+=2){const g=t[m],y=t[m+1],x=h*g+u*y+d,b=l*g+f*y+p;i=x<i?x:i,o=b<o?b:o,a=x>a?x:a,c=b>c?b:c}this.minX=i,this.minY=o,this.maxX=a,this.maxY=c}containsPoint(t,n){return this.minX<=t&&this.minY<=n&&this.maxX>=t&&this.maxY>=n}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var Jd={grad:.9,turn:360,rad:360/(2*Math.PI)},Kt=function(e){return typeof e=="string"?e.length>0:typeof e=="number"},mt=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=Math.pow(10,t)),Math.round(n*e)/n+0},Bt=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=1),e>n?n:e>t?e:t},nl=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},ya=function(e){return{r:Bt(e.r,0,255),g:Bt(e.g,0,255),b:Bt(e.b,0,255),a:Bt(e.a)}},Ds=function(e){return{r:mt(e.r),g:mt(e.g),b:mt(e.b),a:mt(e.a,3)}},Qd=/^#([0-9a-f]{3,8})$/i,Pr=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},rl=function(e){var t=e.r,n=e.g,r=e.b,s=e.a,i=Math.max(t,n,r),o=i-Math.min(t,n,r),a=o?i===t?(n-r)/o:i===n?2+(r-t)/o:4+(t-n)/o:0;return{h:60*(a<0?a+6:a),s:i?o/i*100:0,v:i/255*100,a:s}},sl=function(e){var t=e.h,n=e.s,r=e.v,s=e.a;t=t/360*6,n/=100,r/=100;var i=Math.floor(t),o=r*(1-n),a=r*(1-(t-i)*n),c=r*(1-(1-t+i)*n),h=i%6;return{r:255*[r,a,o,o,c,r][h],g:255*[c,r,r,a,o,o][h],b:255*[o,o,c,r,r,a][h],a:s}},_a=function(e){return{h:nl(e.h),s:Bt(e.s,0,100),l:Bt(e.l,0,100),a:Bt(e.a)}},ba=function(e){return{h:mt(e.h),s:mt(e.s),l:mt(e.l),a:mt(e.a,3)}},xa=function(e){return sl((n=(t=e).s,{h:t.h,s:(n*=((r=t.l)<50?r:100-r)/100)>0?2*n/(r+n)*100:0,v:r+n,a:t.a}));var t,n,r},Zn=function(e){return{h:(t=rl(e)).h,s:(s=(200-(n=t.s))*(r=t.v)/100)>0&&s<200?n*r/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,n,r,s},tf=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ef=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,nf=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rf=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ti={string:[[function(e){var t=Qd.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:e.length===4?mt(parseInt(e[3]+e[3],16)/255,2):1}:e.length===6||e.length===8?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:e.length===8?mt(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=nf.exec(e)||rf.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:ya({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=tf.exec(e)||ef.exec(e);if(!t)return null;var n,r,s=_a({h:(n=t[1],r=t[2],r===void 0&&(r="deg"),Number(n)*(Jd[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return xa(s)},"hsl"]],object:[[function(e){var t=e.r,n=e.g,r=e.b,s=e.a,i=s===void 0?1:s;return Kt(t)&&Kt(n)&&Kt(r)?ya({r:Number(t),g:Number(n),b:Number(r),a:Number(i)}):null},"rgb"],[function(e){var t=e.h,n=e.s,r=e.l,s=e.a,i=s===void 0?1:s;if(!Kt(t)||!Kt(n)||!Kt(r))return null;var o=_a({h:Number(t),s:Number(n),l:Number(r),a:Number(i)});return xa(o)},"hsl"],[function(e){var t=e.h,n=e.s,r=e.v,s=e.a,i=s===void 0?1:s;if(!Kt(t)||!Kt(n)||!Kt(r))return null;var o=(function(a){return{h:nl(a.h),s:Bt(a.s,0,100),v:Bt(a.v,0,100),a:Bt(a.a)}})({h:Number(t),s:Number(n),v:Number(r),a:Number(i)});return sl(o)},"hsv"]]},va=function(e,t){for(var n=0;n<t.length;n++){var r=t[n][0](e);if(r)return[r,t[n][1]]}return[null,void 0]},sf=function(e){return typeof e=="string"?va(e.trim(),Ti.string):typeof e=="object"&&e!==null?va(e,Ti.object):[null,void 0]},Ls=function(e,t){var n=Zn(e);return{h:n.h,s:Bt(n.s+100*t,0,100),l:n.l,a:n.a}},Gs=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},wa=function(e,t){var n=Zn(e);return{h:n.h,s:n.s,l:Bt(n.l+100*t,0,100),a:n.a}},Ci=(function(){function e(t){this.parsed=sf(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return this.parsed!==null},e.prototype.brightness=function(){return mt(Gs(this.rgba),2)},e.prototype.isDark=function(){return Gs(this.rgba)<.5},e.prototype.isLight=function(){return Gs(this.rgba)>=.5},e.prototype.toHex=function(){return t=Ds(this.rgba),n=t.r,r=t.g,s=t.b,o=(i=t.a)<1?Pr(mt(255*i)):"","#"+Pr(n)+Pr(r)+Pr(s)+o;var t,n,r,s,i,o},e.prototype.toRgb=function(){return Ds(this.rgba)},e.prototype.toRgbString=function(){return t=Ds(this.rgba),n=t.r,r=t.g,s=t.b,(i=t.a)<1?"rgba("+n+", "+r+", "+s+", "+i+")":"rgb("+n+", "+r+", "+s+")";var t,n,r,s,i},e.prototype.toHsl=function(){return ba(Zn(this.rgba))},e.prototype.toHslString=function(){return t=ba(Zn(this.rgba)),n=t.h,r=t.s,s=t.l,(i=t.a)<1?"hsla("+n+", "+r+"%, "+s+"%, "+i+")":"hsl("+n+", "+r+"%, "+s+"%)";var t,n,r,s,i},e.prototype.toHsv=function(){return t=rl(this.rgba),{h:mt(t.h),s:mt(t.s),v:mt(t.v),a:mt(t.a,3)};var t},e.prototype.invert=function(){return Ht({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},e.prototype.saturate=function(t){return t===void 0&&(t=.1),Ht(Ls(this.rgba,t))},e.prototype.desaturate=function(t){return t===void 0&&(t=.1),Ht(Ls(this.rgba,-t))},e.prototype.grayscale=function(){return Ht(Ls(this.rgba,-1))},e.prototype.lighten=function(t){return t===void 0&&(t=.1),Ht(wa(this.rgba,t))},e.prototype.darken=function(t){return t===void 0&&(t=.1),Ht(wa(this.rgba,-t))},e.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},e.prototype.alpha=function(t){return typeof t=="number"?Ht({r:(n=this.rgba).r,g:n.g,b:n.b,a:t}):mt(this.rgba.a,3);var n},e.prototype.hue=function(t){var n=Zn(this.rgba);return typeof t=="number"?Ht({h:t,s:n.s,l:n.l,a:n.a}):mt(n.h)},e.prototype.isEqual=function(t){return this.toHex()===Ht(t).toHex()},e})(),Ht=function(e){return e instanceof Ci?e:new Ci(e)},Sa=[],of=function(e){e.forEach(function(t){Sa.indexOf(t)<0&&(t(Ci,Ti),Sa.push(t))})};function af(e,t){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var s in n)r[n[s]]=s;var i={};e.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,c,h=r[this.toHex()];if(h)return h;if(o?.closest){var l=this.toRgb(),u=1/0,f="black";if(!i.length)for(var d in n)i[d]=new e(n[d]).toRgb();for(var p in n){var m=(a=l,c=i[p],Math.pow(a.r-c.r,2)+Math.pow(a.g-c.g,2)+Math.pow(a.b-c.b,2));m<u&&(u=m,f=p)}return f}},t.string.push([function(o){var a=o.toLowerCase(),c=a==="transparent"?"#0000":n[a];return c?new e(c).toRgb():null},"name"])}of([af]);const cn=class Rn{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Rn)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,n){const r=typeof t;if(r!==typeof n)return!1;if(r==="number"||r==="string"||t instanceof Number)return t===n;if(Array.isArray(t)&&Array.isArray(n)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(n))return t.length!==n.length?!1:t.every((i,o)=>i===n[o]);if(t!==null&&n!==null){const i=Object.keys(t),o=Object.keys(n);return i.length!==o.length?!1:i.every(a=>t[a]===n[a])}return t===n}toRgba(){const[t,n,r,s]=this._components;return{r:t,g:n,b:r,a:s}}toRgb(){const[t,n,r]=this._components;return{r:t,g:n,b:r}}toRgbaString(){const[t,n,r]=this.toUint8RgbArray();return`rgba(${t},${n},${r},${this.alpha})`}toUint8RgbArray(t){const[n,r,s]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(n*255),t[1]=Math.round(r*255),t[2]=Math.round(s*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[n,r,s,i]=this._components;return t[0]=n,t[1]=r,t[2]=s,t[3]=i,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[n,r,s]=this._components;return t[0]=n,t[1]=r,t[2]=s,t}toNumber(){return this._int}toBgrNumber(){const[t,n,r]=this.toUint8RgbArray();return(r<<16)+(n<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[n,r,s,i]=Rn._temp.setValue(t)._components;return this._components[0]*=n,this._components[1]*=r,this._components[2]*=s,this._components[3]*=i,this._refreshInt(),this._value=null,this}premultiply(t,n=!0){return n&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,n=!0){if(t===1)return(255<<24)+this._int;if(t===0)return n?0:this._int;let r=this._int>>16&255,s=this._int>>8&255,i=this._int&255;return n&&(r=r*t+.5|0,s=s*t+.5|0,i=i*t+.5|0),(t*255<<24)+(r<<16)+(s<<8)+i}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const n=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-n.length)+n}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let n,r,s,i;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;n=(o>>16&255)/255,r=(o>>8&255)/255,s=(o&255)/255,i=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[n,r,s,i=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[n,r,s,i=255]=t,n/=255,r/=255,s/=255,i/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=Rn.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=Ht(t);o.isValid()&&({r:n,g:r,b:s,a:i}=o.rgba,n/=255,r/=255,s/=255)}if(n!==void 0)this._components[0]=n,this._components[1]=r,this._components[2]=s,this._components[3]=i,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,n,r]=this._components;this._int=(t*255<<16)+(n*255<<8)+(r*255|0)}_clamp(t,n=0,r=1){return typeof t=="number"?Math.min(Math.max(t,n),r):(t.forEach((s,i)=>{t[i]=Math.min(Math.max(s,n),r)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof Rn||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};cn.shared=new cn;cn._temp=new cn;cn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ut=cn;const cf={cullArea:null,cullable:!1,cullableChildren:!0};let js=0;const Aa=500;function Q(...e){js!==Aa&&(js++,js===Aa?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...e))}const mr={_registeredResources:new Set,register(e){this._registeredResources.add(e)},unregister(e){this._registeredResources.delete(e)},release(){this._registeredResources.forEach(e=>e.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(e){return this._registeredResources.has(e)},reset(){this._registeredResources.clear()}};class hf{constructor(t,n){this._pool=[],this._count=0,this._index=0,this._classType=t,n&&this.prepopulate(n)}prepopulate(t){for(let n=0;n<t;n++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){let n;return this._index>0?n=this._pool[--this._index]:(n=new this._classType,this._count++),n.init?.(t),n}return(t){t.reset?.(),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let t=0;t<this._index;t++)this._pool[t].destroy();this._pool.length=0,this._count=0,this._index=0}}class lf{constructor(){this._poolsByClass=new Map}prepopulate(t,n){this.getPool(t).prepopulate(n)}get(t,n){return this.getPool(t).get(n)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new hf(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(n=>{const r=t[n._classType.name]?n._classType.name+n._classType.ID:n._classType.name;t[r]={free:n.totalFree,used:n.totalUsed,size:n.totalSize}}),t}clear(){this._poolsByClass.forEach(t=>t.clear()),this._poolsByClass.clear()}}const Mt=new lf;mr.register(Mt);const uf={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(e){typeof e=="boolean"&&e===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(e===!0?{}:e))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(e){G("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(e)}};function df(e,t,n){const r=e.length;let s;if(t>=r||n===0)return;n=t+n>r?r-t:n;const i=r-n;for(s=t;s<i;++s)e[s]=e[s+n];e.length=i}const ff={allowChildren:!0,removeChildren(e=0,t){const n=t??this.children.length,r=n-e,s=[];if(r>0&&r<=n){for(let o=n-1;o>=e;o--){const a=this.children[o];a&&(s.push(a),a.parent=null)}df(this.children,e,n);const i=this.renderGroup||this.parentRenderGroup;i&&i.removeChildren(s);for(let o=0;o<s.length;++o){const a=s[o];a.parentRenderLayer?.detach(a),this.emit("childRemoved",a,this,o),s[o].emit("removed",this)}return s.length>0&&this._didViewChangeTick++,s}else if(r===0&&this.children.length===0)return s;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(e){const t=this.getChildAt(e);return this.removeChild(t)},getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]},setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(e),this.addChildAt(e,t)},getChildIndex(e){const t=this.children.indexOf(e);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(e,t){this.allowChildren||G(st,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:n}=this;if(t<0||t>n.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${n.length}`);if(e.parent){const s=e.parent.children.indexOf(e);if(e.parent===this&&s===t)return e;s!==-1&&e.parent.children.splice(s,1)}t===n.length?n.push(e):n.splice(t,0,e),e.parent=this,e.didChange=!0,e._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(e),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",e,this,t),e.emit("added",this),e},swapChildren(e,t){if(e===t)return;const n=this.getChildIndex(e),r=this.getChildIndex(t);this.children[n]=t,this.children[r]=e;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...e){return e.length===1?this.reparentChildAt(e[0],this.children.length):(e.forEach(t=>this.reparentChildAt(t,this.children.length)),e[0])},reparentChildAt(e,t){if(e.parent===this)return this.setChildIndex(e,t),e;const n=e.worldTransform.clone();e.removeFromParent(),this.addChildAt(e,t);const r=this.worldTransform.clone();return r.invert(),n.prepend(r),e.setFromMatrix(n),e},replaceChild(e,t){e.updateLocalTransform(),this.addChildAt(t,this.getChildIndex(e)),t.setFromMatrix(e.localTransform),t.updateLocalTransform(),this.removeChild(e)}},pf={collectRenderables(e,t,n){this.parentRenderLayer&&this.parentRenderLayer!==n||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(e,t,n):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,e):this.collectRenderablesWithEffects(e,t,n))},collectRenderablesSimple(e,t,n){const r=this.children,s=r.length;for(let i=0;i<s;i++)r[i].collectRenderables(e,t,n)},collectRenderablesWithEffects(e,t,n){const{renderPipes:r}=t;for(let s=0;s<this.effects.length;s++){const i=this.effects[s];r[i.pipe].push(i,this,e)}this.collectRenderablesSimple(e,t,n);for(let s=this.effects.length-1;s>=0;s--){const i=this.effects[s];r[i.pipe].pop(i,this,e)}}};class Ta{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class mf{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let n=0;n<this._tests.length;n++){const r=this._tests[n];if(r.test(t))return Mt.get(r.maskClass,t)}return t}returnMaskEffect(t){Mt.return(t)}}const Pi=new mf;Y.handleByList(E.MaskEffect,Pi._effectClasses);const gf={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const e=this.renderGroup||this.parentRenderGroup;e&&(e.structureDidChange=!0)},addEffect(e){this.effects.indexOf(e)===-1&&(this.effects.push(e),this.effects.sort((n,r)=>n.priority-r.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(e){const t=this.effects.indexOf(e);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(e){const t=this._maskEffect;t?.mask!==e&&(t&&(this.removeEffect(t),Pi.returnMaskEffect(t),this._maskEffect=null),e!=null&&(this._maskEffect=Pi.getMaskEffect(e),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(e){this._maskOptions={...this._maskOptions,...e},e.mask&&(this.mask=e.mask),this._markStructureAsChanged()},set filters(e){!Array.isArray(e)&&e&&(e=[e]);const t=this._filterEffect||(this._filterEffect=new Ta);e=e;const n=e?.length>0,r=t.filters?.length>0,s=n!==r;e=Array.isArray(e)?e.slice(0):e,t.filters=Object.freeze(e),s&&(n?this.addEffect(t):(this.removeEffect(t),t.filters=e??null))},get filters(){return this._filterEffect?.filters},set filterArea(e){this._filterEffect||(this._filterEffect=new Ta),this._filterEffect.filterArea=e},get filterArea(){return this._filterEffect?.filterArea}},yf={label:null,get name(){return G(st,"Container.name property has been removed, use Container.label instead"),this.label},set name(e){G(st,"Container.name property has been removed, use Container.label instead"),this.label=e},getChildByName(e,t=!1){return this.getChildByLabel(e,t)},getChildByLabel(e,t=!1){const n=this.children;for(let r=0;r<n.length;r++){const s=n[r];if(s.label===e||e instanceof RegExp&&e.test(s.label))return s}if(t)for(let r=0;r<n.length;r++){const i=n[r].getChildByLabel(e,!0);if(i)return i}return null},getChildrenByLabel(e,t=!1,n=[]){const r=this.children;for(let s=0;s<r.length;s++){const i=r[s];(i.label===e||e instanceof RegExp&&e.test(i.label))&&n.push(i)}if(t)for(let s=0;s<r.length;s++)r[s].getChildrenByLabel(e,!0,n);return n}},Pt=Mt.getPool(D),re=Mt.getPool(Dt),_f=new D,bf={getFastGlobalBounds(e,t){t||(t=new Dt),t.clear(),this._getGlobalBoundsRecursive(!!e,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const n=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(n.worldTransform),t},_getGlobalBoundsRecursive(e,t,n){let r=t;if(e&&this.parentRenderLayer&&this.parentRenderLayer!==n||this.localDisplayStatus!==7||!this.measurable)return;const s=!!this.effects.length;if((this.renderGroup||s)&&(r=re.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;r.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const i=this.children;for(let o=0;o<i.length;o++)i[o]._getGlobalBoundsRecursive(e,r,n)}if(s){let i=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(i||(i=!0,r.applyMatrix(o.worldTransform)),this.effects[a].addBounds(r,!0));i&&r.applyMatrix(o.worldTransform.copyTo(_f).invert()),t.addBounds(r),re.return(r)}else this.renderGroup&&(t.addBounds(r,this.relativeGroupTransform),re.return(r))}};function il(e,t,n){n.clear();let r,s;return e.parent?t?r=e.parent.worldTransform:(s=Pt.get().identity(),r=ko(e,s)):r=D.IDENTITY,ol(e,n,r,t),s&&Pt.return(s),n.isValid||n.set(0,0,0,0),n}function ol(e,t,n,r){if(!e.visible||!e.measurable)return;let s;r?s=e.worldTransform:(e.updateLocalTransform(),s=Pt.get(),s.appendFrom(e.localTransform,n));const i=t,o=!!e.effects.length;if(o&&(t=re.get().clear()),e.boundsArea)t.addRect(e.boundsArea,s);else{const a=e.bounds;a&&!a.isEmpty()&&(t.matrix=s,t.addBounds(a));for(let c=0;c<e.children.length;c++)ol(e.children[c],t,s,r)}if(o){for(let a=0;a<e.effects.length;a++)e.effects[a].addBounds?.(t);i.addBounds(t,D.IDENTITY),re.return(t)}r||Pt.return(s)}function ko(e,t){const n=e.parent;return n&&(ko(n,t),n.updateLocalTransform(),t.append(n.localTransform)),t}function al(e,t){if(e===16777215||!t)return t;if(t===16777215||!e)return e;const n=e>>16&255,r=e>>8&255,s=e&255,i=t>>16&255,o=t>>8&255,a=t&255,c=n*i/255|0,h=r*o/255|0,l=s*a/255|0;return(c<<16)+(h<<8)+l}const Ca=16777215;function Pa(e,t){return e===Ca?t:t===Ca?e:al(e,t)}function Yr(e){return((e&255)<<16)+(e&65280)+(e>>16&255)}const xf={getGlobalAlpha(e){if(e)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,n=this.parent;for(;n;)t*=n.alpha,n=n.parent;return t},getGlobalTransform(e=new D,t){if(t)return e.copyFrom(this.worldTransform);this.updateLocalTransform();const n=ko(this,Pt.get().identity());return e.appendFrom(this.localTransform,n),Pt.return(n),e},getGlobalTint(e){if(e)return this.renderGroup?Yr(this.renderGroup.worldColor):this.parentRenderGroup?Yr(Pa(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,n=this.parent;for(;n;)t=Pa(t,n.localColor),n=n.parent;return Yr(t)}};function cl(e,t,n){return t.clear(),n||(n=D.IDENTITY),hl(e,t,n,e,!0),t.isValid||t.set(0,0,0,0),t}function hl(e,t,n,r,s){let i;if(s)i=Pt.get(),i=n.copyTo(i);else{if(!e.visible||!e.measurable)return;e.updateLocalTransform();const c=e.localTransform;i=Pt.get(),i.appendFrom(c,n)}const o=t,a=!!e.effects.length;if(a&&(t=re.get().clear()),e.boundsArea)t.addRect(e.boundsArea,i);else{e.renderPipeId&&(t.matrix=i,t.addBounds(e.bounds));const c=e.children;for(let h=0;h<c.length;h++)hl(c[h],t,i,r,!1)}if(a){for(let c=0;c<e.effects.length;c++)e.effects[c].addLocalBounds?.(t,r);o.addBounds(t,D.IDENTITY),re.return(t)}Pt.return(i)}function ll(e,t){const n=e.children;for(let r=0;r<n.length;r++){const s=n[r],i=s.uid,o=(s._didViewChangeTick&65535)<<16|s._didContainerChangeTick&65535,a=t.index;(t.data[a]!==i||t.data[a+1]!==o)&&(t.data[t.index]=i,t.data[t.index+1]=o,t.didChange=!0),t.index=a+2,s.children.length&&ll(s,t)}return t.didChange}const vf=new D,wf={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(e,t){const n=Math.sign(this.scale.x)||1;t!==0?this.scale.x=e/t*n:this.scale.x=n},_setHeight(e,t){const n=Math.sign(this.scale.y)||1;t!==0?this.scale.y=e/t*n:this.scale.y=n},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Dt});const e=this._localBoundsCacheData;return e.index=1,e.didChange=!1,e.data[0]!==this._didViewChangeTick&&(e.didChange=!0,e.data[0]=this._didViewChangeTick),ll(this,e),e.didChange&&cl(this,e.localBounds,vf),e.localBounds},getBounds(e,t){return il(this,e,t||new Dt)}},Sf={_onRender:null,set onRender(e){const t=this.renderGroup||this.parentRenderGroup;if(!e){this._onRender&&t?.removeOnRender(this),this._onRender=null;return}this._onRender||t?.addOnRender(this),this._onRender=e},get onRender(){return this._onRender}},Af={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Tf))}};function Tf(e,t){return e._zIndex-t._zIndex}const Cf={getGlobalPosition(e=new At,t=!1){return this.parent?this.parent.toGlobal(this._position,e,t):(e.x=this._position.x,e.y=this._position.y),e},toGlobal(e,t,n=!1){const r=this.getGlobalTransform(Pt.get(),n);return t=r.apply(e,t),Pt.return(r),t},toLocal(e,t,n,r){t&&(e=t.toGlobal(e,n,r));const s=this.getGlobalTransform(Pt.get(),r);return n=s.applyInverse(e,n),Pt.return(s),n}};class Mo{constructor(){this.uid=it("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Pf=0;class kf{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new an(this.textureOptions)}createTexture(t,n,r){const s=new Wt({...this.textureOptions,width:t,height:n,resolution:1,antialias:r,autoGarbageCollect:!1});return new U({source:s,label:`texturePool_${Pf++}`})}getOptimalTexture(t,n,r=1,s){let i=Math.ceil(t*r-1e-6),o=Math.ceil(n*r-1e-6);i=on(i),o=on(o);const a=(i<<17)+(o<<1)+(s?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let c=this._texturePool[a].pop();return c||(c=this.createTexture(i,o,s)),c.source._resolution=r,c.source.width=i/r,c.source.height=o/r,c.source.pixelWidth=i,c.source.pixelHeight=o,c.frame.x=0,c.frame.y=0,c.frame.width=t,c.frame.height=n,c.updateUvs(),this._poolKeyHash[c.uid]=a,c}getSameSizeTexture(t,n=!1){const r=t.source;return this.getOptimalTexture(t.width,t.height,r._resolution,n)}returnTexture(t,n=!1){const r=this._poolKeyHash[t.uid];n&&(t.source.style=this.textureStyle),this._texturePool[r].push(t)}clear(t){if(t=t!==!1,t)for(const n in this._texturePool){const r=this._texturePool[n];if(r)for(let s=0;s<r.length;s++)r[s].destroy(!0)}this._texturePool={}}}const ps=new kf;mr.register(ps);class Mf{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new D,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Mo,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const n=t.children;for(let r=0;r<n.length;r++){const s=n[r];s._updateFlags=15,this.addChild(s)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(ps.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const t=this._parentCacheAsTextureRenderGroup;t&&!t.textureNeedsUpdate&&t.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const n=this.childrenToUpdate[t];n.list.fill(null),n.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const n=this.renderGroupChildren.indexOf(t);n>-1&&this.renderGroupChildren.splice(n,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const n=t.children;for(let r=0;r<n.length;r++)this.addChild(n[r])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const n=t.children;for(let r=0;r<n.length;r++)this.removeChild(n[r])}removeChildren(t){for(let n=0;n<t.length;n++)this.removeChild(t[n])}onChildUpdate(t){let n=this.childrenToUpdate[t.relativeRenderGroupDepth];n||(n=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),n.list[n.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let n=0;n<this._onRenderContainers.length;n++)this._onRenderContainers[n]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const n=this.root.children;for(let r=0;r<n.length;r++)this._getChildren(n[r],t);return t}_getChildren(t,n=[]){if(n.push(t),t.renderGroup)return n;const r=t.children;for(let s=0;s<r.length;s++)this._getChildren(r[s],n);return n}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new D),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new D),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new D),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Ef(e,t,n={}){for(const r in t)!n[r]&&t[r]!==void 0&&(e[r]=t[r])}const Ns=new yt(null),kr=new yt(null),Us=new yt(null,1,1),Mr=new yt(null),ka=1,If=2,Ws=4;class Ft extends qt{constructor(t={}){super(),this.uid=it("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new D,this.relativeGroupTransform=new D,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new yt(this,0,0),this._scale=Us,this._pivot=kr,this._origin=Mr,this._skew=Ns,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Ef(this,t,{children:!0,parent:!0,effects:!0}),t.children?.forEach(n=>this.addChild(n)),t.parent?.addChild(this)}static mixin(t){G("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Y.mixin(Ft,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||G(st,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let s=0;s<t.length;s++)this.addChild(t[s]);return t[0]}const n=t[0],r=this.renderGroup||this.parentRenderGroup;return n.parent===this?(this.children.splice(this.children.indexOf(n),1),this.children.push(n),r&&(r.structureDidChange=!0),n):(n.parent&&n.parent.removeChild(n),this.children.push(n),this.sortableChildren&&(this.sortDirty=!0),n.parent=this,n.didChange=!0,n._updateFlags=15,r&&r.addChild(n),this.emit("childAdded",n,this,this.children.length-1),n.emit("added",this),this._didViewChangeTick++,n._zIndex!==0&&n.depthOfChildModified(),n)}removeChild(...t){if(t.length>1){for(let s=0;s<t.length;s++)this.removeChild(t[s]);return t[0]}const n=t[0],r=this.children.indexOf(n);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(n):this.parentRenderGroup&&this.parentRenderGroup.removeChild(n),n.parentRenderLayer&&n.parentRenderLayer.detach(n),n.parent=null,this.emit("childRemoved",n,this,r),n.emit("removed",this)),n}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),this.renderGroup=Mt.get(Mf,this),this.groupTransform=D.IDENTITY,t?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),Mt.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new D),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*Wd}set angle(t){this.rotation=t*Vd}get pivot(){return this._pivot===kr&&(this._pivot=new yt(this,0,0)),this._pivot}set pivot(t){this._pivot===kr&&(this._pivot=new yt(this,0,0),this._origin!==Mr&&Q("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===Ns&&(this._skew=new yt(this,0,0)),this._skew}set skew(t){this._skew===Ns&&(this._skew=new yt(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===Us&&(this._scale=new yt(this,1,1)),this._scale}set scale(t){this._scale===Us&&(this._scale=new yt(this,0,0)),typeof t=="string"&&(t=parseFloat(t)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get origin(){return this._origin===Mr&&(this._origin=new yt(this,0,0)),this._origin}set origin(t){this._origin===Mr&&(this._origin=new yt(this,0,0),this._pivot!==kr&&Q("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._origin.set(t):this._origin.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const n=this.getLocalBounds().width;this._setWidth(t,n)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const n=this.getLocalBounds().height;this._setHeight(t,n)}getSize(t){t||(t={});const n=this.getLocalBounds();return t.width=Math.abs(this.scale.x*n.width),t.height=Math.abs(this.scale.y*n.height),t}setSize(t,n){const r=this.getLocalBounds();typeof t=="object"?(n=t.height??t.width,t=t.width):n??(n=t),t!==void 0&&this._setWidth(t,r.width),n!==void 0&&this._setHeight(n,r.height)}_updateSkew(){const t=this._rotation,n=this._skew;this._cx=Math.cos(t+n._y),this._sx=Math.sin(t+n._y),this._cy=-Math.sin(t-n._x),this._sy=Math.cos(t-n._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this.origin.set(typeof t.originX=="number"?t.originX:this.origin.x,typeof t.originY=="number"?t.originY:this.origin.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const n=this.localTransform,r=this._scale,s=this._pivot,i=this._origin,o=this._position,a=r._x,c=r._y,h=s._x,l=s._y,u=-i._x,f=-i._y;n.a=this._cx*a,n.b=this._sx*a,n.c=this._cy*c,n.d=this._sy*c,n.tx=o._x-(h*n.a+l*n.c)+(u*n.a+f*n.c)-u,n.ty=o._y-(h*n.b+l*n.d)+(u*n.b+f*n.d)-f}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=ka,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const r=ut.shared.setValue(t??16777215).toBgrNumber();r!==this.localColor&&(this.localColor=r,this._updateFlags|=ka,this._onUpdate())}get tint(){return Yr(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=If,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const n=t?2:0;(this.localDisplayStatus&2)!==n&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Ws,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const n=t?0:4;(this.localDisplayStatus&4)!==n&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Ws,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const n=t?1:0;(this.localDisplayStatus&1)!==n&&(this._updateFlags|=Ws,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){if(this.destroyed)return;this.destroyed=!0;let n;if(this.children.length&&(n=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t?.children)&&n)for(let s=0;s<n.length;++s)n[s].destroy(t);this.renderGroup?.destroy(),this.renderGroup=null}}Y.mixin(Ft,ff,bf,Cf,Sf,wf,gf,yf,Af,cf,uf,xf,pf);class Eo extends Ft{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this._bounds=new Dt(0,1,0,0),this._boundsDirty=!0,this.autoGarbageCollect=t.autoGarbageCollect??!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const n=this.bounds,{x:r,y:s}=t;return r>=n.minX&&r<=n.maxX&&s>=n.minY&&s<=n.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}unload(){this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null),this.onViewUpdate()}destroy(t){this.unload(),super.destroy(t),this._bounds=null}collectRenderablesSimple(t,n,r){const{renderPipes:s}=n;s.blendMode.pushBlendMode(this,this.groupBlendMode,t);const o=s[this.renderPipeId];o?.addRenderable&&o.addRenderable(this,t),this.didViewUpdate=!1;const a=this.children,c=a.length;for(let h=0;h<c;h++)a[h].collectRenderables(t,n,r);s.blendMode.popBlendMode(t)}}class hn extends Eo{constructor(t=U.EMPTY){t instanceof U&&(t={texture:t});const{texture:n=U.EMPTY,anchor:r,roundPixels:s,width:i,height:o,...a}=t;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new yt({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:n.defaultAnchor&&(this.anchor=n.defaultAnchor),this.texture=n,this.allowChildren=!1,this.roundPixels=s??!1,i!==void 0&&(this.width=i),o!==void 0&&(this.height=o)}static from(t,n=!1){return t instanceof U?new hn(t):new hn(U.from(t,n))}set texture(t){t||(t=U.EMPTY);const n=this._texture;n!==t&&(n&&n.dynamic&&n.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return el(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return G("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,n=this._texture,r=this._bounds,{width:s,height:i}=n.orig;r.minX=-t._x*s,r.maxX=r.minX+s,r.minY=-t._y*i,r.maxY=r.minY+i}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t?.texture){const r=typeof t=="boolean"?t:t?.textureSource;this._texture.destroy(r)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,n){typeof t=="object"?(n=t.height??t.width,t=t.width):n??(n=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),n!==void 0&&this._setHeight(n,this._texture.orig.height)}}const zf=new Dt;function ul(e,t,n){const r=zf;e.measurable=!0,il(e,n,r),t.addBoundsMask(r),e.measurable=!1}function dl(e,t,n){const r=re.get();e.measurable=!0;const s=Pt.get().identity(),i=fl(e,n,s);cl(e,r,i),e.measurable=!1,t.addBoundsMask(r),Pt.return(s),re.return(r)}function fl(e,t,n){return e?(e!==t&&(fl(e.parent,t,n),e.updateLocalTransform(),n.append(e.localTransform)),n):(Q("Mask bounds, renderable is not inside the root container"),n)}class pl{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof hn),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(t,n){this.inverse||ul(this.mask,t,n)}addLocalBounds(t,n){dl(this.mask,t,n)}containsPoint(t,n){const r=this.mask;return n(r,t)}destroy(){this.reset()}static test(t){return t instanceof hn}}pl.extension=E.MaskEffect;class ml{constructor(t){this.priority=0,this.pipe="colorMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}ml.extension=E.MaskEffect;class gl{constructor(t){this.priority=0,this.pipe="stencilMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(t,n){ul(this.mask,t,n)}addLocalBounds(t,n){dl(this.mask,t,n)}containsPoint(t,n){const r=this.mask;return n(r,t)}destroy(){this.reset()}static test(t){return t instanceof Ft}}gl.extension=E.MaskEffect;const $f={createCanvas:(e,t)=>{const n=document.createElement("canvas");return n.width=e,n.height=t,n},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")};let Ma=$f;const X={get(){return Ma},set(e){Ma=e}};class yl extends Wt{constructor(t){t.resource||(t.resource=X.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,n=this.height,r=this._resolution){const s=super.resize(t,n,r);return s&&this.resizeCanvas(),s}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}yl.extension=E.TextureSource;class ln extends Wt{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}ln.extension=E.TextureSource;var Qr=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(Qr||{});class Vs{constructor(t,n=null,r=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=n,this.priority=r,this._once=s}match(t,n=null){return this._fn===t&&this._context===n}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const n=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),n}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const n=this.next;return this.next=t?null:n,this.previous=null,n}}const _l=class Et{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Vs(null,null,1/0),this.deltaMS=1/Et.targetFPMS,this.elapsedMS=1/Et.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,n,r=Qr.NORMAL){return this._addListener(new Vs(t,n,r))}addOnce(t,n,r=Qr.NORMAL){return this._addListener(new Vs(t,n,r,!0))}_addListener(t){let n=this._head.next,r=this._head;if(!n)t.connect(r);else{for(;n;){if(t.priority>n.priority){t.connect(r);break}r=n,n=n.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,n){let r=this._head.next;for(;r;)r.match(t,n)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,n=this._head;for(;n=n.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let n;if(t>this.lastTime){if(n=this.elapsedMS=t-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),n*=this.speed,this._minElapsedMS){const i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=n,this.deltaTime=this.deltaMS*Et.targetFPMS;const r=this._head;let s=r.next;for(;s;)s=s.emit(this);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const n=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,n)/1e3,Et.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const n=Math.max(this.minFPS,t);this._minElapsedMS=1/(n/1e3)}}static get shared(){if(!Et._shared){const t=Et._shared=new Et;t.autoStart=!0,t._protected=!0}return Et._shared}static get system(){if(!Et._system){const t=Et._system=new Et;t.autoStart=!0,t._protected=!0}return Et._system}};_l.targetFPMS=.06;let Xe=_l,Zs;async function bl(){return Zs??(Zs=(async()=>{const t=X.get().createCanvas(1,1).getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const n=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!n)return"premultiply-alpha-on-upload";const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n);const i=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,i),t.deleteFramebuffer(s),t.deleteTexture(r),t.getExtension("WEBGL_lose_context")?.loseContext(),i[0]<=i[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Zs}const ms=class xl extends Wt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...xl.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Xe.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,n=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(n.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await bl(),this._load=new Promise((r,s)=>{this.isValid?r(this):(this._resolve=r,this._reject=s,n.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${n.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Xe.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Xe.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Xe.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};ms.extension=E.TextureSource;ms.defaultOptions={...Wt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};ms.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Hn=ms;const Nt=(e,t,n=!1)=>(Array.isArray(e)||(e=[e]),t?e.map(r=>typeof r=="string"||n?t(r):r):e);class Rf{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const n=this._cache.get(t);return n||Q(`[Assets] Asset id ${t} was not found in the Cache`),n}set(t,n){const r=Nt(t);let s;for(let c=0;c<this.parsers.length;c++){const h=this.parsers[c];if(h.test(n)){s=h.getCacheableAssets(r,n);break}}const i=new Map(Object.entries(s||{}));s||r.forEach(c=>{i.set(c,n)});const o=[...i.keys()],a={cacheKeys:o,keys:r};r.forEach(c=>{this._cacheMap.set(c,a)}),o.forEach(c=>{const h=s?s[c]:n;this._cache.has(c)&&this._cache.get(c)!==h&&Q("[Cache] already has key:",c),this._cache.set(c,i.get(c))})}remove(t){if(!this._cacheMap.has(t)){Q(`[Assets] Asset id ${t} was not found in the Cache`);return}const n=this._cacheMap.get(t);n.cacheKeys.forEach(s=>{this._cache.delete(s)}),n.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const gt=new Rf,ki=[];Y.handleByList(E.TextureSource,ki);function vl(e={}){const t=e&&e.resource,n=t?e.resource:e,r=t?e:{resource:e};for(let s=0;s<ki.length;s++){const i=ki[s];if(i.test(n))return new i(r)}throw new Error(`Could not find a source type for resource: ${r.resource}`)}function Of(e={},t=!1){const n=e&&e.resource,r=n?e.resource:e,s=n?e:{resource:e};if(!t&&gt.has(r))return gt.get(r);const i=new U({source:vl(s)});return i.on("destroy",()=>{gt.has(r)&&gt.remove(r)}),t||gt.set(r,i),i}function Bf(e,t=!1){return typeof e=="string"?gt.get(e):e instanceof Wt?new U({source:e}):Of(e,t)}U.from=Bf;Wt.from=vl;Y.add(pl,ml,gl,Hn,ln,yl,Po);var _e=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(_e||{});function Gt(e){if(typeof e!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function Cn(e){return e.split("?")[0].split("#")[0]}function Ff(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Df(e,t,n){return e.replace(new RegExp(Ff(t),"g"),n)}function Lf(e,t){let n="",r=0,s=-1,i=0,o=-1;for(let a=0;a<=e.length;++a){if(a<e.length)o=e.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(s===a-1||i===1))if(s!==a-1&&i===2){if(n.length<2||r!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){const c=n.lastIndexOf("/");if(c!==n.length-1){c===-1?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=a,i=0;continue}}else if(n.length===2||n.length===1){n="",r=0,s=a,i=0;continue}}}else n.length>0?n+=`/${e.slice(s+1,a)}`:n=e.slice(s+1,a),r=a-s-1;s=a,i=0}else o===46&&i!==-1?++i:i=-1}return n}const It={toPosix(e){return Df(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},isBlobUrl(e){return e.startsWith("blob:")},hasProtocol(e){return/^[^/:]+:/.test(this.toPosix(e))},getProtocol(e){Gt(e),e=this.toPosix(e);const t=/^file:\/\/\//.exec(e);if(t)return t[0];const n=/^[^/:]+:\/{0,2}/.exec(e);return n?n[0]:""},toAbsolute(e,t,n){if(Gt(e),this.isDataUrl(e)||this.isBlobUrl(e))return e;const r=Cn(this.toPosix(t??X.get().getBaseUrl())),s=Cn(this.toPosix(n??this.rootname(r)));return e=this.toPosix(e),e.startsWith("/")?It.join(s,e.slice(1)):this.isAbsolute(e)?e:this.join(r,e)},normalize(e){if(Gt(e),e.length===0)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;e=this.toPosix(e);let t="";const n=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const r=e.endsWith("/");return e=Lf(e),e.length>0&&r&&(e+="/"),n?`/${e}`:t+e},isAbsolute(e){return Gt(e),e=this.toPosix(e),this.hasProtocol(e)?!0:e.startsWith("/")},join(...e){if(e.length===0)return".";let t;for(let n=0;n<e.length;++n){const r=e[n];if(Gt(r),r.length>0)if(t===void 0)t=r;else{const s=e[n-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(e){if(Gt(e),e.length===0)return".";e=this.toPosix(e);let t=e.charCodeAt(0);const n=t===47;let r=-1,s=!0;const i=this.getProtocol(e),o=e;e=e.slice(i.length);for(let a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!s){r=a;break}}else s=!1;return r===-1?n?"/":this.isUrl(o)?i+e:i:n&&r===1?"//":i+e.slice(0,r)},rootname(e){Gt(e),e=this.toPosix(e);let t="";if(e.startsWith("/")?t="/":t=this.getProtocol(e),this.isUrl(e)){const n=e.indexOf("/",t.length);n!==-1?t=e.slice(0,n):t=e,t.endsWith("/")||(t+="/")}return t},basename(e,t){Gt(e),t&&Gt(t),e=Cn(this.toPosix(e));let n=0,r=-1,s=!0,i;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let o=t.length-1,a=-1;for(i=e.length-1;i>=0;--i){const c=e.charCodeAt(i);if(c===47){if(!s){n=i+1;break}}else a===-1&&(s=!1,a=i+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(r=i):(o=-1,r=a))}return n===r?r=a:r===-1&&(r=e.length),e.slice(n,r)}for(i=e.length-1;i>=0;--i)if(e.charCodeAt(i)===47){if(!s){n=i+1;break}}else r===-1&&(s=!1,r=i+1);return r===-1?"":e.slice(n,r)},extname(e){Gt(e),e=Cn(this.toPosix(e));let t=-1,n=0,r=-1,s=!0,i=0;for(let o=e.length-1;o>=0;--o){const a=e.charCodeAt(o);if(a===47){if(!s){n=o+1;break}continue}r===-1&&(s=!1,r=o+1),a===46?t===-1?t=o:i!==1&&(i=1):t!==-1&&(i=-1)}return t===-1||r===-1||i===0||i===1&&t===r-1&&t===n+1?"":e.slice(t,r)},parse(e){Gt(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;e=Cn(this.toPosix(e));let n=e.charCodeAt(0);const r=this.isAbsolute(e);let s;t.root=this.rootname(e),r||this.hasProtocol(e)?s=1:s=0;let i=-1,o=0,a=-1,c=!0,h=e.length-1,l=0;for(;h>=s;--h){if(n=e.charCodeAt(h),n===47){if(!c){o=h+1;break}continue}a===-1&&(c=!1,a=h+1),n===46?i===-1?i=h:l!==1&&(l=1):i!==-1&&(l=-1)}return i===-1||a===-1||l===0||l===1&&i===a-1&&i===o+1?a!==-1&&(o===0&&r?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(o,a)):(o===0&&r?(t.name=e.slice(1,i),t.base=e.slice(1,a)):(t.name=e.slice(o,i),t.base=e.slice(o,a)),t.ext=e.slice(i,a)),t.dir=this.dirname(e),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function wl(e,t,n,r,s){const i=t[n];for(let o=0;o<i.length;o++){const a=i[o];n<t.length-1?wl(e.replace(r[n],a),t,n+1,r,s):s.push(e.replace(r[n],a))}}function Gf(e){const t=/\{(.*?)\}/g,n=e.match(t),r=[];if(n){const s=[];n.forEach(i=>{const o=i.substring(1,i.length-1).split(",");s.push(o)}),wl(e,s,0,n,r)}else r.push(e);return r}const ts=e=>!Array.isArray(e);class gn{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,n)=>`${t}${this._bundleIdConnector}${n}`,extractAssetIdFromBundle:(t,n)=>n.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(n=>{this._preferredOrder.push(n),n.priority||(n.priority=Object.keys(n.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const n=t;this._defaultSearchParams=Object.keys(n).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(n[r])}`).join("&")}}getAlias(t){const{alias:n,src:r}=t;return Nt(n||r,i=>typeof i=="string"?i:Array.isArray(i)?i.map(o=>o?.src??o):i?.src?i.src:i,!0)}addManifest(t){this._manifest&&Q("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(n=>{this.addBundle(n.name,n.assets)})}addBundle(t,n){const r=[];let s=n;Array.isArray(n)||(s=Object.entries(n).map(([i,o])=>typeof o=="string"||Array.isArray(o)?{alias:i,src:o}:{alias:i,...o})),s.forEach(i=>{const o=i.src,a=i.alias;let c;if(typeof a=="string"){const h=this._createBundleAssetId(t,a);r.push(h),c=[a,h]}else{const h=a.map(l=>this._createBundleAssetId(t,l));r.push(...h),c=[...a,...h]}this.add({...i,alias:c,src:o})}),this._bundles[t]=r}add(t){const n=[];Array.isArray(t)?n.push(...t):n.push(t);let r;r=i=>{this.hasKey(i)&&Q(`[Resolver] already has key: ${i} overwriting`)},Nt(n).forEach(i=>{const{src:o}=i;let{data:a,format:c,loadParser:h,parser:l}=i;const u=Nt(o).map(m=>typeof m=="string"?Gf(m):Array.isArray(m)?m:[m]),f=this.getAlias(i);Array.isArray(f)?f.forEach(r):r(f);const d=[],p=m=>{const g=this._parsers.find(y=>y.test(m));return{src:m,...g?.parse(m)}};u.forEach(m=>{m.forEach(g=>{let y={};if(typeof g!="object"?y=p(g):(a=g.data??a,c=g.format??c,(g.loadParser||g.parser)&&(h=g.loadParser??h,l=g.parser??l),y={...p(g.src),...g}),!f)throw new Error(`[Resolver] alias is undefined for this asset: ${y.src}`);y=this._buildResolvedAsset(y,{aliases:f,data:a,format:c,loadParser:h,parser:l,progressSize:i.progressSize}),d.push(y)})}),f.forEach(m=>{this._assetMap[m]=d})})}resolveBundle(t){const n=ts(t);t=Nt(t);const r={};return t.forEach(s=>{const i=this._bundles[s];if(i){const o=this.resolve(i),a={};for(const c in o){const h=o[c];a[this._extractAssetIdFromBundle(s,c)]=h}r[s]=a}}),n?r[t[0]]:r}resolveUrl(t){const n=this.resolve(t);if(typeof t!="string"){const r={};for(const s in n)r[s]=n[s].src;return r}return n.src}resolve(t){const n=ts(t);t=Nt(t);const r={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let i=this._assetMap[s];const o=this._getPreferredOrder(i);o?.priority.forEach(a=>{o.params[a].forEach(c=>{const h=i.filter(l=>l[a]?l[a]===c:!1);h.length&&(i=h)})}),this._resolverHash[s]=i[0]}else this._resolverHash[s]=this._buildResolvedAsset({alias:[s],src:s},{});r[s]=this._resolverHash[s]}),n?r[t[0]]:r}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let n=0;n<t.length;n++){const r=t[n],s=this._preferredOrder.find(i=>i.params.format.includes(r.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const n=/\?/.test(t)?"&":"?";return`${t}${n}${this._defaultSearchParams}`}_buildResolvedAsset(t,n){const{aliases:r,data:s,loadParser:i,parser:o,format:a,progressSize:c}=n;return(this._basePath||this._rootPath)&&(t.src=It.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=r??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...s||{},...t.data},t.loadParser=i??t.loadParser,t.parser=o??t.parser,t.format=a??t.format??jf(t.src),c!==void 0&&(t.progressSize=c),t}}gn.RETINA_PREFIX=/@([0-9\.]+)x/;function jf(e){return e.split(".").pop().split("?").shift().split("#").shift()}const Mi=(e,t)=>{const n=t.split("?")[1];return n&&(e+=`?${n}`),e},Sl=class On{constructor(t,n){this.linkedSheets=[];let r=t;t?.source instanceof Wt&&(r={texture:t,data:n});const{texture:s,data:i,cachePrefix:o=""}=r;this.cachePrefix=o,this._texture=s instanceof U?s:null,this.textureSource=s.source,this.textures={},this.animations={},this.data=i;const a=parseFloat(i.meta.scale);a?(this.resolution=a,s.source.resolution=this.resolution):this.resolution=s.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=On.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}parseSync(){return this._processFrames(0,!0),this._processAnimations(),this.textures}_processFrames(t,n=!1){let r=t;const s=n?1/0:On.BATCH_SIZE;for(;r-t<s&&r<this._frameKeys.length;){const i=this._frameKeys[r],o=this._frames[i],a=o.frame;if(a){let c=null,h=null;const l=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,u=new at(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);o.rotated?c=new at(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):c=new at(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(h=new at(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[i]=new U({source:this.textureSource,frame:c,orig:u,trim:h,rotate:o.rotated?2:0,defaultAnchor:o.anchor,defaultBorders:o.borders,label:i.toString()})}r++}}_processAnimations(){const t=this.data.animations||{};for(const n in t){this.animations[n]=[];for(let r=0;r<t[n].length;r++){const s=t[n][r];this.animations[n].push(this.textures[s])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*On.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*On.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Sl.BATCH_SIZE=1e3;let Ea=Sl;const Nf=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Al(e,t,n){const r={};if(e.forEach(s=>{r[s]=t}),Object.keys(t.textures).forEach(s=>{r[`${t.cachePrefix}${s}`]=t.textures[s]}),!n){const s=It.dirname(e[0]);t.linkedSheets.forEach((i,o)=>{const a=Al([`${s}/${t.data.meta.related_multi_packs[o]}`],i,!0);Object.assign(r,a)})}return r}const Uf={extension:E.Asset,cache:{test:e=>e instanceof Ea,getCacheableAssets:(e,t)=>Al(e,t,!1)},resolver:{extension:{type:E.ResolveParser,name:"resolveSpritesheet"},test:e=>{const n=e.split("?")[0].split("."),r=n.pop(),s=n.pop();return r==="json"&&Nf.includes(s)},parse:e=>{const t=e.split(".");return{resolution:parseFloat(gn.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:E.LoadParser,priority:_e.Normal,name:"spritesheetLoader"},async testParse(e,t){return It.extname(t.src).toLowerCase()===".json"&&!!e.frames},async parse(e,t,n){const{texture:r,imageFilename:s,textureOptions:i,cachePrefix:o}=t?.data??{};let a=It.dirname(t.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let c;if(r instanceof U)c=r;else{const u=Mi(a+(s??e.meta.image),t.src);c=(await n.load([{src:u,data:i}]))[u]}const h=new Ea({texture:c.source,data:e,cachePrefix:o});await h.parse();const l=e?.meta?.related_multi_packs;if(Array.isArray(l)){const u=[];for(const d of l){if(typeof d!="string")continue;let p=a+d;t.data?.ignoreMultiPack||(p=Mi(p,t.src),u.push(n.load({src:p,data:{textureOptions:i,ignoreMultiPack:!0}})))}const f=await Promise.all(u);h.linkedSheets=f,f.forEach(d=>{d.linkedSheets=[h].concat(h.linkedSheets.filter(p=>p!==d))})}return h},async unload(e,t,n){await n.unload(e.textureSource._sourceOrigin),e.destroy(!1)}}};Y.add(Uf);const Hs=Object.create(null),Ia=Object.create(null);function Io(e,t){let n=Ia[e];return n===void 0&&(Hs[t]===void 0&&(Hs[t]=1),Ia[e]=n=Hs[t]++),n}let Er;function Tl(){return(!Er||Er?.isContextLost())&&(Er=X.get().createCanvas().getContext("webgl",{})),Er}let Ir;function Wf(){if(!Ir){Ir="mediump";const e=Tl();e&&e.getShaderPrecisionFormat&&(Ir=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision?"highp":"mediump")}return Ir}function Vf(e,t,n){return t?e:n?(e=e.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${e}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${e}
        `}function Zf(e,t,n){const r=n?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(e.substring(0,9)!=="precision"){let s=n?t.requestedFragmentPrecision:t.requestedVertexPrecision;return s==="highp"&&r!=="highp"&&(s="mediump"),`precision ${s} float;
${e}`}else if(r!=="highp"&&e.substring(0,15)==="precision highp")return e.replace("precision highp","precision mediump");return e}function Hf(e,t){return t?`#version 300 es
${e}`:e}const Yf={},Xf={};function qf(e,{name:t="pixi-program"},n=!0){t=t.replace(/\s+/g,"-"),t+=n?"-fragment":"-vertex";const r=n?Yf:Xf;return r[t]?(r[t]++,t+=`-${r[t]}`):r[t]=1,e.indexOf("#define SHADER_NAME")!==-1?e:`${`#define SHADER_NAME ${t}`}
${e}`}function Kf(e,t){return t?e.replace("#version 300 es",""):e}const Ys={stripVersion:Kf,ensurePrecision:Zf,addProgramDefines:Vf,setProgramName:qf,insertVersion:Hf},Pn=Object.create(null),Cl=class Ei{constructor(t){t={...Ei.defaultOptions,...t};const n=t.fragment.indexOf("#version 300 es")!==-1,r={stripVersion:n,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:Wf()},setProgramName:{name:t.name},addProgramDefines:n,insertVersion:n};let s=t.fragment,i=t.vertex;Object.keys(Ys).forEach(o=>{const a=r[o];s=Ys[o](s,a,!0),i=Ys[o](i,a,!1)}),this.fragment=s,this.vertex=i,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=Io(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,Pn[this._cacheKey]=null}static from(t){const n=`${t.vertex}:${t.fragment}`;return Pn[n]||(Pn[n]=new Ei(t),Pn[n]._cacheKey=n),Pn[n]}};Cl.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Pl=Cl;const za={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function Jf(e){return za[e]??za.float32}const Qf={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",vec2i:"sint32x2",vec3i:"sint32x3",vec4i:"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",vec2u:"uint32x2",vec3u:"uint32x3",vec4u:"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"},$a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|\)|$)/g;function Ra(e,t){let n;for(;(n=$a.exec(e))!==null;){const r=Qf[n[3]]??"float32";t[n[2]]={location:parseInt(n[1],10),format:r,stride:Jf(r).stride,offset:0,instance:!1,start:0}}$a.lastIndex=0}function tp(e){return e.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"")}function ep({source:e,entryPoint:t}){const n={},r=tp(e),s=r.indexOf(`fn ${t}(`);if(s===-1)return n;const i=r.indexOf("->",s);if(i===-1)return n;const o=r.substring(s,i);if(Ra(o,n),Object.keys(n).length===0){const a=o.match(/\(\s*\w+\s*:\s*(\w+)/);if(a){const c=a[1],h=new RegExp(`struct\\s+${c}\\s*\\{([^}]+)\\}`,"s"),l=r.match(h);l&&Ra(l[1],n)}}return n}function Xs(e){const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,n=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,s=/var(<[^>]+>)? (\w+)/,i=/:\s*([\w<>]+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,c=/struct\s+(\w+)/,h=e.match(t)?.map(u=>({group:parseInt(u.match(n)[1],10),binding:parseInt(u.match(r)[1],10),name:u.match(s)[2],isUniform:u.match(s)[1]==="<uniform>",type:u.match(i)[1]}));if(!h)return{groups:[],structs:[]};const l=e.match(o)?.map(u=>{const f=u.match(c)[1],d=u.match(a).reduce((p,m)=>{const[g,y]=m.split(":");return p[g.trim()]=y.trim(),p},{});return d?{name:f,members:d}:null}).filter(({name:u})=>h.some(f=>f.type===u||f.type.includes(`<${u}>`)))??[];return{groups:h,structs:l}}var Ie=(e=>(e[e.VERTEX=1]="VERTEX",e[e.FRAGMENT=2]="FRAGMENT",e[e.COMPUTE=4]="COMPUTE",e))(Ie||{});function np({groups:e}){const t=[];for(let n=0;n<e.length;n++){const r=e[n];t[r.group]||(t[r.group]=[]),r.isUniform?t[r.group].push({binding:r.binding,visibility:Ie.VERTEX|Ie.FRAGMENT,buffer:{type:"uniform"}}):r.type==="sampler"?t[r.group].push({binding:r.binding,visibility:Ie.FRAGMENT,sampler:{type:"filtering"}}):r.type==="texture_2d"||r.type.startsWith("texture_2d<")?t[r.group].push({binding:r.binding,visibility:Ie.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}}):r.type==="texture_2d_array"||r.type.startsWith("texture_2d_array<")?t[r.group].push({binding:r.binding,visibility:Ie.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d-array",multisampled:!1}}):(r.type==="texture_cube"||r.type.startsWith("texture_cube<"))&&t[r.group].push({binding:r.binding,visibility:Ie.FRAGMENT,texture:{sampleType:"float",viewDimension:"cube",multisampled:!1}})}for(let n=0;n<t.length;n++)t[n]||(t[n]=[]);return t}function rp({groups:e}){const t=[];for(let n=0;n<e.length;n++){const r=e[n];t[r.group]||(t[r.group]={}),t[r.group][r.name]=r.binding}return t}function sp(e,t){const n=new Set,r=new Set,s=[...e.structs,...t.structs].filter(o=>n.has(o.name)?!1:(n.add(o.name),!0)),i=[...e.groups,...t.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return r.has(a)?!1:(r.add(a),!0)});return{structs:s,groups:i}}const kn=Object.create(null);class gs{constructor(t){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:n,vertex:r,layout:s,gpuLayout:i,name:o}=t;if(this.name=o,this.fragment=n,this.vertex=r,n.source===r.source){const a=Xs(n.source);this.structsAndGroups=a}else{const a=Xs(r.source),c=Xs(n.source);this.structsAndGroups=sp(a,c)}this.layout=s??rp(this.structsAndGroups),this.gpuLayout=i??np(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:n}=this,r=t.source+n.source+t.entryPoint+n.entryPoint;this._layoutKey=Io(r,"program")}get attributeData(){return this._attributeData??(this._attributeData=ep(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,kn[this._cacheKey]=null}static from(t){const n=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return kn[n]||(kn[n]=new gs(t),kn[n]._cacheKey=n),kn[n]}}const kl=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],ip=kl.reduce((e,t)=>(e[t]=!0,e),{});function op(e,t){switch(e){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Ml=class El{constructor(t,n){this._touched=0,this.uid=it("uniform"),this._resourceType="uniformGroup",this._resourceId=it("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,n={...El.defaultOptions,...n},this.uniformStructures=t;const r={};for(const s in t){const i=t[s];if(i.name=s,i.size=i.size??1,!ip[i.type]){const o=i.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(o){const[,a,c]=o;throw new Error(`Uniform type ${i.type} is not supported. Use type: '${a}', size: ${c} instead.`)}throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${kl.join(", ")}`)}i.value??(i.value=op(i.type,i.size)),r[s]=i.value}this.uniforms=r,this._dirtyId=1,this.ubo=n.ubo,this.isStatic=n.isStatic,this._signature=Io(Object.keys(r).map(s=>`${s}-${t[s].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Ml.defaultOptions={ubo:!1,isStatic:!1};let Il=Ml;class Xr{constructor(t){this.resources=Object.create(null),this._dirty=!0;let n=0;for(const r in t){const s=t[r];this.setResource(s,n++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let n=0;for(const r in this.resources)t[n++]=this.resources[r]._resourceId;this._key=t.join("|")}setResource(t,n){const r=this.resources[n];t!==r&&(r&&t.off?.("change",this.onResourceChange,this),t.on?.("change",this.onResourceChange,this),this.resources[n]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t,n){const r=this.resources;for(const s in r)r[s]._gcLastUsed=t,r[s]._touched=n}destroy(){const t=this.resources;for(const n in t)t[n]?.off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const n=this.resources;for(const r in n)n[r]===t&&(n[r]=null)}else this._updateKey()}}var Ii=(e=>(e[e.WEBGL=1]="WEBGL",e[e.WEBGPU=2]="WEBGPU",e[e.CANVAS=4]="CANVAS",e[e.BOTH=3]="BOTH",e))(Ii||{});class zo extends qt{constructor(t){super(),this.uid=it("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:n,glProgram:r,groups:s,resources:i,compatibleRenderers:o,groupMap:a}=t;this.gpuProgram=n,this.glProgram=r,o===void 0&&(o=0,n&&(o|=Ii.WEBGPU),r&&(o|=Ii.WEBGL)),this.compatibleRenderers=o;const c={};if(!i&&!s&&(i={}),i&&s)throw new Error("[Shader] Cannot have both resources and groups");if(!n&&s&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!n&&s&&a)for(const h in a)for(const l in a[h]){const u=a[h][l];c[u]={group:h,binding:l,name:u}}else if(n&&s&&!a){const h=n.structsAndGroups.groups;a={},h.forEach(l=>{a[l.group]=a[l.group]||{},a[l.group][l.binding]=l.name,c[l.name]=l})}else if(i){s={},a={},n&&n.structsAndGroups.groups.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,c[u.name]=u});let h=0;for(const l in i)c[l]||(s[99]||(s[99]=new Xr,this._ownedBindGroups.push(s[99])),c[l]={group:99,binding:h,name:l},a[99]=a[99]||{},a[99][h]=l,h++);for(const l in i){const u=l;let f=i[l];!f.source&&!f._resourceType&&(f=new Il(f));const d=c[u];d&&(s[d.group]||(s[d.group]=new Xr,this._ownedBindGroups.push(s[d.group])),s[d.group].setResource(f,d.binding))}}this.groups=s,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(s,c)}addResource(t,n,r){var s,i;(s=this._uniformBindMap)[n]||(s[n]={}),(i=this._uniformBindMap[n])[r]||(i[r]=t),this.groups[n]||(this.groups[n]=new Xr,this._ownedBindGroups.push(this.groups[n]))}_buildResourceAccessor(t,n){const r={};for(const s in n){const i=n[s];Object.defineProperty(r,i.name,{get(){return t[i.group].getResource(i.binding)},set(o){t[i.group].setResource(o,i.binding)}})}return r}destroy(t=!1){this._destroyed||(this._destroyed=!0,this.emit("destroy",this),t&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(n=>{n.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(t){const{gpu:n,gl:r,...s}=t;let i,o;return n&&(i=gs.from(n)),r&&(o=Pl.from(r)),new zo({gpuProgram:i,glProgram:o,...s})}}const ap={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},qs=0,Ks=1,Js=2,Qs=3,ti=4,ei=5,zi=class zl{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<qs)}set blend(t){!!(this.data&1<<qs)!==t&&(this.data^=1<<qs)}get offsets(){return!!(this.data&1<<Ks)}set offsets(t){!!(this.data&1<<Ks)!==t&&(this.data^=1<<Ks)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<Js)}set culling(t){!!(this.data&1<<Js)!==t&&(this.data^=1<<Js)}get depthTest(){return!!(this.data&1<<Qs)}set depthTest(t){!!(this.data&1<<Qs)!==t&&(this.data^=1<<Qs)}get depthMask(){return!!(this.data&1<<ei)}set depthMask(t){!!(this.data&1<<ei)!==t&&(this.data^=1<<ei)}get clockwiseFrontFace(){return!!(this.data&1<<ti)}set clockwiseFrontFace(t){!!(this.data&1<<ti)!==t&&(this.data^=1<<ti)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=ap[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new zl;return t.depthTest=!1,t.blend=!0,t}};zi.default2d=zi.for2d();let $l=zi;const $i=[];Y.handleByNamedList(E.Environment,$i);async function cp(e){if(!e)for(let t=0;t<$i.length;t++){const n=$i[t];if(n.value.test()){await n.value.load();return}}}let Mn;function hp(){if(typeof Mn=="boolean")return Mn;try{Mn=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Mn=!1}return Mn}function Oa(e,t,n=2){const r=t&&t.length,s=r?t[0]*n:e.length;let i=Rl(e,0,s,n,!0);const o=[];if(!i||i.next===i.prev)return o;let a,c,h;if(r&&(i=pp(e,t,i,n)),e.length>80*n){a=e[0],c=e[1];let l=a,u=c;for(let f=n;f<s;f+=n){const d=e[f],p=e[f+1];d<a&&(a=d),p<c&&(c=p),d>l&&(l=d),p>u&&(u=p)}h=Math.max(l-a,u-c),h=h!==0?32767/h:0}return Jn(i,o,n,a,c,h,0),o}function Rl(e,t,n,r,s){let i;if(s===Tp(e,t,n,r)>0)for(let o=t;o<n;o+=r)i=Ba(o/r|0,e[o],e[o+1],i);else for(let o=n-r;o>=t;o-=r)i=Ba(o/r|0,e[o],e[o+1],i);return i&&un(i,i.next)&&(tr(i),i=i.next),i}function Be(e,t){if(!e)return e;t||(t=e);let n=e,r;do if(r=!1,!n.steiner&&(un(n,n.next)||et(n.prev,n,n.next)===0)){if(tr(n),n=t=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function Jn(e,t,n,r,s,i,o){if(!e)return;!o&&i&&bp(e,r,s,i);let a=e;for(;e.prev!==e.next;){const c=e.prev,h=e.next;if(i?up(e,r,s,i):lp(e)){t.push(c.i,e.i,h.i),tr(e),e=h.next,a=h.next;continue}if(e=h,e===a){o?o===1?(e=dp(Be(e),t),Jn(e,t,n,r,s,i,2)):o===2&&fp(e,t,n,r,s,i):Jn(Be(e),t,n,r,s,i,1);break}}}function lp(e){const t=e.prev,n=e,r=e.next;if(et(t,n,r)>=0)return!1;const s=t.x,i=n.x,o=r.x,a=t.y,c=n.y,h=r.y,l=Math.min(s,i,o),u=Math.min(a,c,h),f=Math.max(s,i,o),d=Math.max(a,c,h);let p=r.next;for(;p!==t;){if(p.x>=l&&p.x<=f&&p.y>=u&&p.y<=d&&Bn(s,a,i,c,o,h,p.x,p.y)&&et(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function up(e,t,n,r){const s=e.prev,i=e,o=e.next;if(et(s,i,o)>=0)return!1;const a=s.x,c=i.x,h=o.x,l=s.y,u=i.y,f=o.y,d=Math.min(a,c,h),p=Math.min(l,u,f),m=Math.max(a,c,h),g=Math.max(l,u,f),y=Ri(d,p,t,n,r),x=Ri(m,g,t,n,r);let b=e.prevZ,_=e.nextZ;for(;b&&b.z>=y&&_&&_.z<=x;){if(b.x>=d&&b.x<=m&&b.y>=p&&b.y<=g&&b!==s&&b!==o&&Bn(a,l,c,u,h,f,b.x,b.y)&&et(b.prev,b,b.next)>=0||(b=b.prevZ,_.x>=d&&_.x<=m&&_.y>=p&&_.y<=g&&_!==s&&_!==o&&Bn(a,l,c,u,h,f,_.x,_.y)&&et(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;b&&b.z>=y;){if(b.x>=d&&b.x<=m&&b.y>=p&&b.y<=g&&b!==s&&b!==o&&Bn(a,l,c,u,h,f,b.x,b.y)&&et(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;_&&_.z<=x;){if(_.x>=d&&_.x<=m&&_.y>=p&&_.y<=g&&_!==s&&_!==o&&Bn(a,l,c,u,h,f,_.x,_.y)&&et(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function dp(e,t){let n=e;do{const r=n.prev,s=n.next.next;!un(r,s)&&Bl(r,n,n.next,s)&&Qn(r,s)&&Qn(s,r)&&(t.push(r.i,n.i,s.i),tr(n),tr(n.next),n=e=s),n=n.next}while(n!==e);return Be(n)}function fp(e,t,n,r,s,i){let o=e;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&wp(o,a)){let c=Fl(o,a);o=Be(o,o.next),c=Be(c,c.next),Jn(o,t,n,r,s,i,0),Jn(c,t,n,r,s,i,0);return}a=a.next}o=o.next}while(o!==e)}function pp(e,t,n,r){const s=[];for(let i=0,o=t.length;i<o;i++){const a=t[i]*r,c=i<o-1?t[i+1]*r:e.length,h=Rl(e,a,c,r,!1);h===h.next&&(h.steiner=!0),s.push(vp(h))}s.sort(mp);for(let i=0;i<s.length;i++)n=gp(s[i],n);return n}function mp(e,t){let n=e.x-t.x;if(n===0&&(n=e.y-t.y,n===0)){const r=(e.next.y-e.y)/(e.next.x-e.x),s=(t.next.y-t.y)/(t.next.x-t.x);n=r-s}return n}function gp(e,t){const n=yp(e,t);if(!n)return t;const r=Fl(n,e);return Be(r,r.next),Be(n,n.next)}function yp(e,t){let n=t;const r=e.x,s=e.y;let i=-1/0,o;if(un(e,n))return n;do{if(un(e,n.next))return n.next;if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){const u=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=r&&u>i&&(i=u,o=n.x<n.next.x?n:n.next,u===r))return o}n=n.next}while(n!==t);if(!o)return null;const a=o,c=o.x,h=o.y;let l=1/0;n=o;do{if(r>=n.x&&n.x>=c&&r!==n.x&&Ol(s<h?r:i,s,c,h,s<h?i:r,s,n.x,n.y)){const u=Math.abs(s-n.y)/(r-n.x);Qn(n,e)&&(u<l||u===l&&(n.x>o.x||n.x===o.x&&_p(o,n)))&&(o=n,l=u)}n=n.next}while(n!==a);return o}function _p(e,t){return et(e.prev,e,t.prev)<0&&et(t.next,e,e.next)<0}function bp(e,t,n,r){let s=e;do s.z===0&&(s.z=Ri(s.x,s.y,t,n,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,xp(s)}function xp(e){let t,n=1;do{let r=e,s;e=null;let i=null;for(t=0;r;){t++;let o=r,a=0;for(let h=0;h<n&&(a++,o=o.nextZ,!!o);h++);let c=n;for(;a>0||c>0&&o;)a!==0&&(c===0||!o||r.z<=o.z)?(s=r,r=r.nextZ,a--):(s=o,o=o.nextZ,c--),i?i.nextZ=s:e=s,s.prevZ=i,i=s;r=o}i.nextZ=null,n*=2}while(t>1);return e}function Ri(e,t,n,r,s){return e=(e-n)*s|0,t=(t-r)*s|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function vp(e){let t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function Ol(e,t,n,r,s,i,o,a){return(s-o)*(t-a)>=(e-o)*(i-a)&&(e-o)*(r-a)>=(n-o)*(t-a)&&(n-o)*(i-a)>=(s-o)*(r-a)}function Bn(e,t,n,r,s,i,o,a){return!(e===o&&t===a)&&Ol(e,t,n,r,s,i,o,a)}function wp(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Sp(e,t)&&(Qn(e,t)&&Qn(t,e)&&Ap(e,t)&&(et(e.prev,e,t.prev)||et(e,t.prev,t))||un(e,t)&&et(e.prev,e,e.next)>0&&et(t.prev,t,t.next)>0)}function et(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function un(e,t){return e.x===t.x&&e.y===t.y}function Bl(e,t,n,r){const s=$r(et(e,t,n)),i=$r(et(e,t,r)),o=$r(et(n,r,e)),a=$r(et(n,r,t));return!!(s!==i&&o!==a||s===0&&zr(e,n,t)||i===0&&zr(e,r,t)||o===0&&zr(n,e,r)||a===0&&zr(n,t,r))}function zr(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function $r(e){return e>0?1:e<0?-1:0}function Sp(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Bl(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function Qn(e,t){return et(e.prev,e,e.next)<0?et(e,t,e.next)>=0&&et(e,e.prev,t)>=0:et(e,t,e.prev)<0||et(e,e.next,t)<0}function Ap(e,t){let n=e,r=!1;const s=(e.x+t.x)/2,i=(e.y+t.y)/2;do n.y>i!=n.next.y>i&&n.next.y!==n.y&&s<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function Fl(e,t){const n=Oi(e.i,e.x,e.y),r=Oi(t.i,t.x,t.y),s=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=s,s.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function Ba(e,t,n,r){const s=Oi(e,t,n);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function tr(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Oi(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Tp(e,t,n,r){let s=0;for(let i=t,o=n-r;i<n;i+=r)s+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return s}const Cp=Oa.default||Oa;var Dl=(e=>(e[e.NONE=0]="NONE",e[e.COLOR=16384]="COLOR",e[e.STENCIL=1024]="STENCIL",e[e.DEPTH=256]="DEPTH",e[e.COLOR_DEPTH=16640]="COLOR_DEPTH",e[e.COLOR_STENCIL=17408]="COLOR_STENCIL",e[e.DEPTH_STENCIL=1280]="DEPTH_STENCIL",e[e.ALL=17664]="ALL",e))(Dl||{});class Pp{constructor(t){this.items=[],this._name=t}emit(t,n,r,s,i,o,a,c){const{name:h,items:l}=this;for(let u=0,f=l.length;u<f;u++)l[u][h](t,n,r,s,i,o,a,c);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const n=this.items.indexOf(t);return n!==-1&&this.items.splice(n,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const kp=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Ll=class Gl extends qt{constructor(t){super(),this.tick=0,this.uid=it("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const n=[...kp,...this.config.runners??[]];this._addRunners(...n),this._unsafeEvalCheck()}async init(t={}){const n=t.skipExtensionImports===!0?!0:t.manageImports===!1;await cp(n),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const r in this._systemsHash)t={...this._systemsHash[r].constructor.defaultOptions,...t};t={...Gl.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let r=0;r<this.runners.init.items.length;r++)await this.runners.init.items[r].init(t);this._initOptions=t}render(t,n){this.tick++;let r=t;if(r instanceof Ft&&(r={container:r},n&&(G(st,"passing a second argument is deprecated, please use render options instead"),r.target=n.renderTexture)),r.target||(r.target=this.view.renderTarget),r.target===this.view.renderTarget&&(this._lastObjectRendered=r.container,r.clearColor??(r.clearColor=this.background.colorRgba),r.clear??(r.clear=this.background.clearBeforeRender)),r.clearColor){const s=Array.isArray(r.clearColor)&&r.clearColor.length===4;r.clearColor=s?r.clearColor:ut.shared.setValue(r.clearColor).toArray()}r.transform||(r.container.updateLocalTransform(),r.transform=r.container.localTransform),r.container.visible&&(r.container.enableRenderGroup(),this.runners.prerender.emit(r),this.runners.renderStart.emit(r),this.runners.render.emit(r),this.runners.renderEnd.emit(r),this.runners.postrender.emit(r))}resize(t,n,r){const s=this.view.resolution;this.view.resize(t,n,r),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),r!==void 0&&r!==s&&this.runners.resolutionChange.emit(r)}clear(t={}){const n=this;t.target||(t.target=n.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=Dl.ALL);const{clear:r,clearColor:s,target:i,mipLevel:o,layer:a}=t;ut.shared.setValue(s??this.background.colorRgba),n.renderTarget.clear(i,r,ut.shared.toArray(),o??0,a??0)}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(n=>{this.runners[n]=new Pp(n)})}_addSystems(t){let n;for(n in t){const r=t[n];this._addSystem(r.value,r.name)}}_addSystem(t,n){const r=new t(this);if(this[n])throw new Error(`Whoops! The name "${n}" is already in use`);this[n]=r,this._systemsHash[n]=r;for(const s in this.runners)this.runners[s].add(r);return this}_addPipes(t,n){const r=n.reduce((s,i)=>(s[i.name]=i.value,s),{});t.forEach(s=>{const i=s.value,o=s.name,a=r[o];this.renderPipes[o]=new i(this,a?new a:null),this.runners.destroy.add(this.renderPipes[o])})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),(t===!0||typeof t=="object"&&t.releaseGlobalResources)&&mr.release(),Object.values(this.runners).forEach(n=>{n.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!hp())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Ll.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let jl=Ll,Rr;function Mp(e){return Rr!==void 0||(Rr=(()=>{const t={stencil:!0,failIfMajorPerformanceCaveat:e??jl.defaultOptions.failIfMajorPerformanceCaveat};try{if(!X.get().getWebGLRenderingContext())return!1;let r=X.get().createCanvas().getContext("webgl",t);const s=!!r?.getContextAttributes()?.stencil;if(r){const i=r.getExtension("WEBGL_lose_context");i&&i.loseContext()}return r=null,s}catch{return!1}})()),Rr}let Or;async function Ep(e={}){return Or!==void 0||(Or=await(async()=>{const t=X.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(e)).requestDevice(),!0}catch{return!1}})()),Or}const Fa=["webgl","webgpu","canvas"];async function Ip(e){let t=[];e.preference?(t.push(e.preference),Fa.forEach(i=>{i!==e.preference&&t.push(i)})):t=Fa.slice();let n,r={};for(let i=0;i<t.length;i++){const o=t[i];if(o==="webgpu"&&await Ep()){const{WebGPURenderer:a}=await Qe(async()=>{const{WebGPURenderer:c}=await import("./WebGPURenderer-DKtx2ycj.js");return{WebGPURenderer:c}},__vite__mapDeps([4,5,6,2,3]),import.meta.url);n=a,r={...e,...e.webgpu};break}else if(o==="webgl"&&Mp(e.failIfMajorPerformanceCaveat??jl.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Qe(async()=>{const{WebGLRenderer:c}=await import("./WebGLRenderer-DHQmtMNf.js");return{WebGLRenderer:c}},__vite__mapDeps([7,5,6,2,3]),import.meta.url);n=a,r={...e,...e.webgl};break}else if(o==="canvas"){const{CanvasRenderer:a}=await Qe(async()=>{const{CanvasRenderer:c}=await import("./CanvasRenderer-CI5ejc0P.js");return{CanvasRenderer:c}},__vite__mapDeps([8,6,2,3]),import.meta.url);n=a,r={...e,...e.canvasOptions};break}}if(delete r.webgpu,delete r.webgl,delete r.canvasOptions,!n)throw new Error("No available renderer for the current environment");const s=new n;return await s.init(r),s}const Nl="8.16.0";class Ul{static init(){globalThis.__PIXI_APP_INIT__?.(this,Nl)}static destroy(){}}Ul.extension=E.Application;class zp{constructor(t){this._renderer=t}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,Nl)}destroy(){this._renderer=null}}zp.extension={type:[E.WebGLSystem,E.WebGPUSystem],name:"initHook",priority:-10};class Wl{static init(t){Object.defineProperty(this,"resizeTo",{configurable:!0,set(n){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=n,n&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let n,r;if(this._resizeTo===globalThis.window)n=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:i}=this._resizeTo;n=s,r=i}this.renderer.resize(n,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Wl.extension=E.Application;class Vl{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{configurable:!0,set(n){this._ticker&&this._ticker.remove(this.render,this),this._ticker=n,n&&n.add(this.render,this,Qr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Xe.shared:new Xe,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Vl.extension=E.Application;Y.add(Wl);Y.add(Vl);const Zl=class Bi{constructor(...t){this.stage=new Ft,t[0]!==void 0&&G(st,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.stage||(this.stage=new Ft),this.renderer=await Ip(t),Bi._plugins.forEach(n=>{n.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return G(st,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,n=!1){const r=Bi._plugins.slice(0);r.reverse(),r.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Zl._plugins=[];let yn=Zl;Y.handleByList(E.Application,yn._plugins);Y.add(Ul);const ni={test(e){return typeof e=="string"&&e.startsWith("info face=")},parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const u in t){const f=t[u].match(/^[a-z]+/gm)[0],d=t[u].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const m in d){const g=d[m].split("="),y=g[0],x=g[1].replace(/"/gm,""),b=parseFloat(x),_=isNaN(b)?x:b;p[y]=_}n[f].push(p)}const r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[s]=n.info,[i]=n.common,[o]=n.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(s.size,10),r.fontFamily=s.face,r.lineHeight=parseInt(i.lineHeight,10);const a=n.page;for(let u=0;u<a.length;u++)r.pages.push({id:parseInt(a[u].id,10)||0,file:a[u].file});const c={};r.baseLineOffset=r.lineHeight-parseInt(i.base,10);const h=n.char;for(let u=0;u<h.length;u++){const f=h[u],d=parseInt(f.id,10);let p=f.letter??f.char??String.fromCharCode(d);p==="space"&&(p=" "),c[d]=p,r.chars[p]={id:d,page:parseInt(f.page,10)||0,x:parseInt(f.x,10),y:parseInt(f.y,10),width:parseInt(f.width,10),height:parseInt(f.height,10),xOffset:parseInt(f.xoffset,10),yOffset:parseInt(f.yoffset,10),xAdvance:parseInt(f.xadvance,10),kerning:{}}}const l=n.kerning||[];for(let u=0;u<l.length;u++){const f=parseInt(l[u].first,10),d=parseInt(l[u].second,10),p=parseInt(l[u].amount,10);r.chars[c[d]].kerning[c[f]]=p}return r}},Da={test(e){const t=e;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(e){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},n=e.getElementsByTagName("info")[0],r=e.getElementsByTagName("common")[0],s=e.getElementsByTagName("distanceField")[0];s&&(t.distanceField={type:s.getAttribute("fieldType"),range:parseInt(s.getAttribute("distanceRange"),10)});const i=e.getElementsByTagName("page"),o=e.getElementsByTagName("char"),a=e.getElementsByTagName("kerning");t.fontSize=parseInt(n.getAttribute("size"),10),t.fontFamily=n.getAttribute("face"),t.lineHeight=parseInt(r.getAttribute("lineHeight"),10);for(let h=0;h<i.length;h++)t.pages.push({id:parseInt(i[h].getAttribute("id"),10)||0,file:i[h].getAttribute("file")});const c={};t.baseLineOffset=t.lineHeight-parseInt(r.getAttribute("base"),10);for(let h=0;h<o.length;h++){const l=o[h],u=parseInt(l.getAttribute("id"),10);let f=l.getAttribute("letter")??l.getAttribute("char")??String.fromCharCode(u);f==="space"&&(f=" "),c[u]=f,t.chars[f]={id:u,page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xOffset:parseInt(l.getAttribute("xoffset"),10),yOffset:parseInt(l.getAttribute("yoffset"),10),xAdvance:parseInt(l.getAttribute("xadvance"),10),kerning:{}}}for(let h=0;h<a.length;h++){const l=parseInt(a[h].getAttribute("first"),10),u=parseInt(a[h].getAttribute("second"),10),f=parseInt(a[h].getAttribute("amount"),10);t.chars[c[u]].kerning[c[l]]=f}return t}},La={test(e){return typeof e=="string"&&e.match(/<font(\s|>)/)?Da.test(X.get().parseXML(e)):!1},parse(e){return Da.parse(X.get().parseXML(e))}},$p=[".xml",".fnt"],Rp={extension:{type:E.CacheParser,name:"cacheBitmapFont"},test:e=>!!e?.pages&&!!e?.chars&&typeof e?.fontFamily=="string",getCacheableAssets(e,t){const n={};return e.forEach(r=>{n[r]=t,n[`${r}-bitmap`]=t}),n[`${t.fontFamily}-bitmap`]=t,n}},Op={extension:{type:E.LoadParser,priority:_e.Normal},name:"loadBitmapFont",id:"bitmap-font",test(e){return $p.includes(It.extname(e).toLowerCase())},async testParse(e){return ni.test(e)||La.test(e)},async parse(e,t,n){const r=ni.test(e)?ni.parse(e):La.parse(e),{src:s}=t,{pages:i}=r,o=[],a=r.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let f=0;f<i.length;++f){const d=i[f].file;let p=It.join(It.dirname(s),d);p=Mi(p,s),o.push({src:p,data:a})}const[c,{BitmapFont:h}]=await Promise.all([n.load(o),Qe(()=>import("./BitmapFont-BcPVUjuR.js"),__vite__mapDeps([9,3]),import.meta.url)]),l=o.map(f=>c[f.src]);return new h({data:r,textures:l},s)},async load(e,t){return await(await X.get().fetch(e)).text()},async unload(e,t,n){await Promise.all(e.pages.map(r=>n.unload(r.texture.source._sourceOrigin))),e.destroy()}};class Bp{constructor(t,n=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=n}add(t){t.forEach(n=>{this._assetList.push(n)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],n=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<n;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Fp={extension:{type:E.CacheParser,name:"cacheTextureArray"},test:e=>Array.isArray(e)&&e.every(t=>t instanceof U),getCacheableAssets:(e,t)=>{const n={};return e.forEach(r=>{t.forEach((s,i)=>{n[r+(i===0?"":i+1)]=s})}),n}};async function Hl(e){if("Image"in globalThis)return new Promise(t=>{const n=new Image;n.onload=()=>{t(!0)},n.onerror=()=>{t(!1)},n.src=e});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(e)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const Dp={extension:{type:E.DetectionParser,priority:1},test:async()=>Hl("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async e=>[...e,"avif"],remove:async e=>e.filter(t=>t!=="avif")},Ga=["png","jpg","jpeg"],Lp={extension:{type:E.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...Ga],remove:async e=>e.filter(t=>!Ga.includes(t))},Gp="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function ys(e){return Gp?!1:document.createElement("video").canPlayType(e)!==""}const jp={extension:{type:E.DetectionParser,priority:0},test:async()=>ys("video/mp4"),add:async e=>[...e,"mp4","m4v"],remove:async e=>e.filter(t=>t!=="mp4"&&t!=="m4v")},Np={extension:{type:E.DetectionParser,priority:0},test:async()=>ys("video/ogg"),add:async e=>[...e,"ogv"],remove:async e=>e.filter(t=>t!=="ogv")},Up={extension:{type:E.DetectionParser,priority:0},test:async()=>ys("video/webm"),add:async e=>[...e,"webm"],remove:async e=>e.filter(t=>t!=="webm")},Wp={extension:{type:E.DetectionParser,priority:0},test:async()=>Hl("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async e=>[...e,"webp"],remove:async e=>e.filter(t=>t!=="webp")},Yl=class qr{constructor(){this.loadOptions={...qr.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,n,r)=>(this._parsersValidated=!1,t[n]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,n){const r={promise:null,parser:null};return r.promise=(async()=>{let s=null,i=null;if((n.parser||n.loadParser)&&(i=this._parserHash[n.parser||n.loadParser],n.loadParser&&Q(`[Assets] "loadParser" is deprecated, use "parser" instead for ${t}`),i||Q(`[Assets] specified load parser "${n.parser||n.loadParser}" not found while loading ${t}`)),!i){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(t,n,this)){i=a;break}}if(!i)return Q(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await i.load(t,n,this),r.parser=i;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(s,n,this)&&(s=await a.parse(s,n,this)||s,r.parser=a)}return s})(),r}async load(t,n){this._parsersValidated||this._validateParsers();const r=typeof n=="function"?{...qr.defaultOptions,...this.loadOptions,onProgress:n}:{...qr.defaultOptions,...this.loadOptions,...n||{}},{onProgress:s,onError:i,strategy:o,retryCount:a,retryDelay:c}=r;let h=0;const l={},u=ts(t),f=Nt(t,m=>({alias:[m],src:m,data:{}})),d=f.reduce((m,g)=>m+(g.progressSize||1),0),p=f.map(async m=>{const g=It.toAbsolute(m.src);l[m.src]||(await this._loadAssetWithRetry(g,m,{onProgress:s,onError:i,strategy:o,retryCount:a,retryDelay:c},l),h+=m.progressSize||1,s&&s(h/d))});return await Promise.all(p),u?l[f[0].src]:l}async unload(t){const r=Nt(t,s=>({alias:[s],src:s})).map(async s=>{const i=It.toAbsolute(s.src),o=this.promiseCache[i];if(o){const a=await o.promise;delete this.promiseCache[i],await o.parser?.unload?.(a,s,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name||t.id).reduce((t,n)=>(!n.name&&!n.id?Q("[Assets] parser should have an id"):(t[n.name]||t[n.id])&&Q(`[Assets] parser id conflict "${n.id}"`),t[n.name]=n,n.id&&(t[n.id]=n),t),{})}async _loadAssetWithRetry(t,n,r,s){let i=0;const{onError:o,strategy:a,retryCount:c,retryDelay:h}=r,l=u=>new Promise(f=>setTimeout(f,u));for(;;)try{this.promiseCache[t]||(this.promiseCache[t]=this._getLoadPromiseAndParser(t,n)),s[n.src]=await this.promiseCache[t].promise;return}catch(u){delete this.promiseCache[t],delete s[n.src],i++;const f=a!=="retry"||i>c;if(a==="retry"&&!f){o&&o(u,n),await l(h);continue}if(a==="skip"){o&&o(u,n);return}o&&o(u,n);const d=new Error(`[Loader.load] Failed to load ${t}.
${u}`);throw u instanceof Error&&u.stack&&(d.stack=u.stack),d}}};Yl.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let Vp=Yl;function _n(e,t){if(Array.isArray(t)){for(const n of t)if(e.startsWith(`data:${n}`))return!0;return!1}return e.startsWith(`data:${t}`)}function bn(e,t){const n=e.split("?")[0],r=It.extname(n).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const Zp=".json",Hp="application/json",Yp={extension:{type:E.LoadParser,priority:_e.Low},name:"loadJson",id:"json",test(e){return _n(e,Hp)||bn(e,Zp)},async load(e){return await(await X.get().fetch(e)).json()}},Xp=".txt",qp="text/plain",Kp={name:"loadTxt",id:"text",extension:{type:E.LoadParser,priority:_e.Low,name:"loadTxt"},test(e){return _n(e,qp)||bn(e,Xp)},async load(e){return await(await X.get().fetch(e)).text()}},Jp=["normal","bold","100","200","300","400","500","600","700","800","900"],Qp=[".ttf",".otf",".woff",".woff2"],tm=["font/ttf","font/otf","font/woff","font/woff2"],em=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function nm(e){const t=It.extname(e),s=It.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let i=s.length>0;for(const a of s)if(!a.match(em)){i=!1;break}let o=s.join(" ");return i||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const rm=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function sm(e){return rm.test(e)?e:encodeURI(e)}const im={extension:{type:E.LoadParser,priority:_e.Low},name:"loadWebFont",id:"web-font",test(e){return _n(e,tm)||bn(e,Qp)},async load(e,t){const n=X.get().getFontFaceSet();if(n){const r=[],s=t.data?.family??nm(e),i=t.data?.weights?.filter(a=>Jp.includes(a))??["normal"],o=t.data??{};for(let a=0;a<i.length;a++){const c=i[a],h=new FontFace(s,`url(${sm(e)})`,{...o,weight:c});await h.load(),n.add(h),r.push(h)}return gt.has(`${s}-and-url`)?gt.get(`${s}-and-url`).entries.push({url:e,faces:r}):gt.set(`${s}-and-url`,{entries:[{url:e,faces:r}]}),r.length===1?r[0]:r}return Q("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){const t=Array.isArray(e)?e:[e],n=t[0].family,r=gt.get(`${n}-and-url`),s=r.entries.find(i=>i.faces.some(o=>t.indexOf(o)!==-1));s.faces=s.faces.filter(i=>t.indexOf(i)===-1),s.faces.length===0&&(r.entries=r.entries.filter(i=>i!==s)),t.forEach(i=>{X.get().getFontFaceSet().delete(i)}),r.entries.length===0&&gt.remove(`${n}-and-url`)}};var ri,ja;function om(){if(ja)return ri;ja=1,ri=n;var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function n(i){var o=[];return i.replace(t,function(a,c,h){var l=c.toLowerCase();for(h=s(h),l=="m"&&h.length>2&&(o.push([c].concat(h.splice(0,2))),l="l",c=c=="m"?"l":"L");;){if(h.length==e[l])return h.unshift(c),o.push(h);if(h.length<e[l])throw new Error("malformed path data");o.push([c].concat(h.splice(0,e[l])))}}),o}var r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function s(i){var o=i.match(r);return o?o.map(Number):[]}return ri}var am=om();const cm=Hh(am);function hm(e,t){const n=cm(e),r=[];let s=null,i=0,o=0;for(let a=0;a<n.length;a++){const c=n[a],h=c[0],l=c;switch(h){case"M":i=l[1],o=l[2],t.moveTo(i,o);break;case"m":i+=l[1],o+=l[2],t.moveTo(i,o);break;case"H":i=l[1],t.lineTo(i,o);break;case"h":i+=l[1],t.lineTo(i,o);break;case"V":o=l[1],t.lineTo(i,o);break;case"v":o+=l[1],t.lineTo(i,o);break;case"L":i=l[1],o=l[2],t.lineTo(i,o);break;case"l":i+=l[1],o+=l[2],t.lineTo(i,o);break;case"C":i=l[5],o=l[6],t.bezierCurveTo(l[1],l[2],l[3],l[4],i,o);break;case"c":t.bezierCurveTo(i+l[1],o+l[2],i+l[3],o+l[4],i+l[5],o+l[6]),i+=l[5],o+=l[6];break;case"S":i=l[3],o=l[4],t.bezierCurveToShort(l[1],l[2],i,o);break;case"s":t.bezierCurveToShort(i+l[1],o+l[2],i+l[3],o+l[4]),i+=l[3],o+=l[4];break;case"Q":i=l[3],o=l[4],t.quadraticCurveTo(l[1],l[2],i,o);break;case"q":t.quadraticCurveTo(i+l[1],o+l[2],i+l[3],o+l[4]),i+=l[3],o+=l[4];break;case"T":i=l[1],o=l[2],t.quadraticCurveToShort(i,o);break;case"t":i+=l[1],o+=l[2],t.quadraticCurveToShort(i,o);break;case"A":i=l[6],o=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],i,o);break;case"a":i+=l[6],o+=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],i,o);break;case"Z":case"z":t.closePath(),r.length>0&&(s=r.pop(),s?(i=s.startX,o=s.startY):(i=0,o=0)),s=null;break;default:Q(`Unknown SVG path command: ${h}`)}h!=="Z"&&h!=="z"&&s===null&&(s={startX:i,startY:o},r.push(s))}return t}class $o{constructor(t=0,n=0,r=0){this.type="circle",this.x=t,this.y=n,this.radius=r}clone(){return new $o(this.x,this.y,this.radius)}contains(t,n){if(this.radius<=0)return!1;const r=this.radius*this.radius;let s=this.x-t,i=this.y-n;return s*=s,i*=i,s+i<=r}strokeContains(t,n,r,s=.5){if(this.radius===0)return!1;const i=this.x-t,o=this.y-n,a=this.radius,c=(1-s)*r,h=Math.sqrt(i*i+o*o);return h<=a+c&&h>a-(r-c)}getBounds(t){return t||(t=new at),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ro{constructor(t=0,n=0,r=0,s=0){this.type="ellipse",this.x=t,this.y=n,this.halfWidth=r,this.halfHeight=s}clone(){return new Ro(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,n){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let r=(t-this.x)/this.halfWidth,s=(n-this.y)/this.halfHeight;return r*=r,s*=s,r+s<=1}strokeContains(t,n,r,s=.5){const{halfWidth:i,halfHeight:o}=this;if(i<=0||o<=0)return!1;const a=r*(1-s),c=r-a,h=i-c,l=o-c,u=i+a,f=o+a,d=t-this.x,p=n-this.y,m=d*d/(h*h)+p*p/(l*l),g=d*d/(u*u)+p*p/(f*f);return m>1&&g<=1}getBounds(t){return t||(t=new at),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function lm(e,t,n,r,s,i){const o=e-n,a=t-r,c=s-n,h=i-r,l=o*c+a*h,u=c*c+h*h;let f=-1;u!==0&&(f=l/u);let d,p;f<0?(d=n,p=r):f>1?(d=s,p=i):(d=n+f*c,p=r+f*h);const m=e-d,g=t-p;return m*m+g*g}let um,dm;class Yn{constructor(...t){this.type="polygon";let n=Array.isArray(t[0])?t[0]:t;if(typeof n[0]!="number"){const r=[];for(let s=0,i=n.length;s<i;s++)r.push(n[s].x,n[s].y);n=r}this.points=n,this.closePath=!0}isClockwise(){let t=0;const n=this.points,r=n.length;for(let s=0;s<r;s+=2){const i=n[s],o=n[s+1],a=n[(s+2)%r],c=n[(s+3)%r];t+=(a-i)*(c+o)}return t<0}containsPolygon(t){const n=this.getBounds(um),r=t.getBounds(dm);if(!n.containsRect(r))return!1;const s=t.points;for(let i=0;i<s.length;i+=2){const o=s[i],a=s[i+1];if(!this.contains(o,a))return!1}return!0}clone(){const t=this.points.slice(),n=new Yn(t);return n.closePath=this.closePath,n}contains(t,n){let r=!1;const s=this.points.length/2;for(let i=0,o=s-1;i<s;o=i++){const a=this.points[i*2],c=this.points[i*2+1],h=this.points[o*2],l=this.points[o*2+1];c>n!=l>n&&t<(h-a)*((n-c)/(l-c))+a&&(r=!r)}return r}strokeContains(t,n,r,s=.5){const i=r*r,o=i*(1-s),a=i-o,{points:c}=this,h=c.length-(this.closePath?0:2);for(let l=0;l<h;l+=2){const u=c[l],f=c[l+1],d=c[(l+2)%c.length],p=c[(l+3)%c.length],m=lm(t,n,u,f,d,p),g=Math.sign((d-u)*(n-f)-(p-f)*(t-u));if(m<=(g<0?a:o))return!0}return!1}getBounds(t){t||(t=new at);const n=this.points;let r=1/0,s=-1/0,i=1/0,o=-1/0;for(let a=0,c=n.length;a<c;a+=2){const h=n[a],l=n[a+1];r=h<r?h:r,s=h>s?h:s,i=l<i?l:i,o=l>o?l:o}return t.x=r,t.width=s-r,t.y=i,t.height=o-i,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,n)=>`${t}, ${n}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return G("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return G("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const Br=(e,t,n,r,s,i,o)=>{const a=e-n,c=t-r,h=Math.sqrt(a*a+c*c);return h>=s-i&&h<=s+o};class Oo{constructor(t=0,n=0,r=0,s=0,i=20){this.type="roundedRectangle",this.x=t,this.y=n,this.width=r,this.height=s,this.radius=i}getBounds(t){return t||(t=new at),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Oo(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,n){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&n>=this.y&&n<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(n>=this.y+r&&n<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let s=t-(this.x+r),i=n-(this.y+r);const o=r*r;if(s*s+i*i<=o||(s=t-(this.x+this.width-r),s*s+i*i<=o)||(i=n-(this.y+this.height-r),s*s+i*i<=o)||(s=t-(this.x+r),s*s+i*i<=o))return!0}return!1}strokeContains(t,n,r,s=.5){const{x:i,y:o,width:a,height:c,radius:h}=this,l=r*(1-s),u=r-l,f=i+h,d=o+h,p=a-h*2,m=c-h*2,g=i+a,y=o+c;return(t>=i-l&&t<=i+u||t>=g-u&&t<=g+l)&&n>=d&&n<=d+m||(n>=o-l&&n<=o+u||n>=y-u&&n<=y+l)&&t>=f&&t<=f+p?!0:t<f&&n<d&&Br(t,n,f,d,h,u,l)||t>g-h&&n<d&&Br(t,n,g-h,d,h,u,l)||t>g-h&&n>y-h&&Br(t,n,g-h,y-h,h,u,l)||t<f&&n>y-h&&Br(t,n,f,y-h,h,u,l)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Xl={};function fm(e,t,n){let r=2166136261;for(let s=0;s<t;s++)r^=e[s].uid,r=Math.imul(r,16777619),r>>>=0;return Xl[r]||pm(e,t,r,n)}function pm(e,t,n,r){const s={};let i=0;for(let a=0;a<r;a++){const c=a<t?e[a]:U.EMPTY.source;s[i++]=c.source,s[i++]=c.style}const o=new Xr(s);return Xl[n]=o,o}class Na{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function Ua(e,t,n,r){if(n??(n=0),r??(r=Math.min(e.byteLength-n,t.byteLength)),!(n&7)&&!(r&7)){const s=r/8;new Float64Array(t,0,s).set(new Float64Array(e,n,s))}else if(!(n&3)&&!(r&3)){const s=r/4;new Float32Array(t,0,s).set(new Float32Array(e,n,s))}else new Uint8Array(t).set(new Uint8Array(e,n,r))}const mm={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var gm=(e=>(e[e.DISABLED=0]="DISABLED",e[e.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",e[e.MASK_ACTIVE=2]="MASK_ACTIVE",e[e.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",e[e.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",e[e.NONE=5]="NONE",e))(gm||{});function Wa(e,t){return t.alphaMode==="no-premultiply-alpha"&&mm[e]||e}const ym=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function _m(e){let t="";for(let n=0;n<e;++n)n>0&&(t+=`
else `),n<e-1&&(t+=`if(test == ${n}.0){}`);return t}function bm(e,t){if(e===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const n=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const r=ym.replace(/%forloop%/gi,_m(e));if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))e=e/2|0;else break}}finally{t.deleteShader(n)}return e}let Ue=null;function xm(){if(Ue)return Ue;const e=Tl();return Ue=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Ue=bm(Ue,e),e.getExtension("WEBGL_lose_context")?.loseContext(),Ue}class vm{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const n=this.textures[t];this.textures[t]=null,this.ids[n.uid]=null}this.count=0}}class wm{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new vm,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null,this.elements=null}}const Xn=[];let es=0;mr.register({clear:()=>{if(Xn.length>0)for(const e of Xn)e&&e.destroy();Xn.length=0,es=0}});function Va(){return es>0?Xn[--es]:new wm}function Za(e){e.elements=null,Xn[es++]=e}let En=0;const ql=class Kl{constructor(t){this.uid=it("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...Kl.defaultOptions,...t},t.maxTextures||(G("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=xm());const{maxTextures:n,attributesInitialSize:r,indicesInitialSize:s}=t;this.attributeBuffer=new Na(r*4),this.indexBuffer=new Uint16Array(s),this.maxTextures=n}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Za(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,n){const r=t._batch.textures.ids[n._source.uid];return!r&&r!==0?!1:(t._textureId=r,t.texture=n,!0)}updateElement(t){this.dirty=!0;const n=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,n.float32View,n.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,n.float32View,n.uint32View,t._attributeStart,t._textureId)}break(t){const n=this._elements;if(!n[this.elementStart])return;let r=Va(),s=r.textures;s.clear();const i=n[this.elementStart];let o=Wa(i.blendMode,i.texture._source),a=i.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const c=this.attributeBuffer.float32View,h=this.attributeBuffer.uint32View,l=this.indexBuffer;let u=this._batchIndexSize,f=this._batchIndexStart,d="startBatch",p=[];const m=this.maxTextures;for(let g=this.elementStart;g<this.elementSize;++g){const y=n[g];n[g]=null;const b=y.texture._source,_=Wa(y.blendMode,b),v=o!==_||a!==y.topology;if(b._batchTick===En&&!v){y._textureId=b._textureBindLocation,u+=y.indexSize,y.packAsQuad?(this.packQuadAttributes(y,c,h,y._attributeStart,y._textureId),this.packQuadIndex(l,y._indexStart,y._attributeStart/this.vertexSize)):(this.packAttributes(y,c,h,y._attributeStart,y._textureId),this.packIndex(y,l,y._indexStart,y._attributeStart/this.vertexSize)),y._batch=r,p.push(y);continue}b._batchTick=En,(s.count>=m||v)&&(this._finishBatch(r,f,u-f,s,o,a,t,d,p),d="renderBatch",f=u,o=_,a=y.topology,r=Va(),s=r.textures,s.clear(),p=[],++En),y._textureId=b._textureBindLocation=s.count,s.ids[b.uid]=s.count,s.textures[s.count++]=b,y._batch=r,p.push(y),u+=y.indexSize,y.packAsQuad?(this.packQuadAttributes(y,c,h,y._attributeStart,y._textureId),this.packQuadIndex(l,y._indexStart,y._attributeStart/this.vertexSize)):(this.packAttributes(y,c,h,y._attributeStart,y._textureId),this.packIndex(y,l,y._indexStart,y._attributeStart/this.vertexSize))}s.count>0&&(this._finishBatch(r,f,u-f,s,o,a,t,d,p),f=u,++En),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=u}_finishBatch(t,n,r,s,i,o,a,c,h){t.gpuBindGroup=null,t.bindGroup=null,t.action=c,t.batcher=this,t.textures=s,t.blendMode=i,t.topology=o,t.start=n,t.size=r,t.elements=h,++En,this.batches[this.batchIndex++]=t,a.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const n=Math.max(t,this.attributeBuffer.size*2),r=new Na(n);Ua(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}_resizeIndexBuffer(t){const n=this.indexBuffer;let r=Math.max(t,n.length*1.5);r+=r%2;const s=r>65535?new Uint32Array(r):new Uint16Array(r);if(s.BYTES_PER_ELEMENT!==n.BYTES_PER_ELEMENT)for(let i=0;i<n.length;i++)s[i]=n[i];else Ua(n.buffer,s.buffer);this.indexBuffer=s}packQuadIndex(t,n,r){t[n]=r+0,t[n+1]=r+1,t[n+2]=r+2,t[n+3]=r+0,t[n+4]=r+2,t[n+5]=r+3}packIndex(t,n,r,s){const i=t.indices,o=t.indexSize,a=t.indexOffset,c=t.attributeOffset;for(let h=0;h<o;h++)n[r++]=s+i[h+a]-c}destroy(t={}){if(this.batches!==null){for(let n=0;n<this.batchIndex;n++)Za(this.batches[n]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,t.shader&&(this.shader?.destroy(),this.shader=null);for(let n=0;n<this._elements.length;n++)this._elements[n]&&(this._elements[n]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};ql.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let Sm=ql;var kt=(e=>(e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE",e[e.STATIC=1024]="STATIC",e))(kt||{});let er=class extends qt{constructor(t){let{data:n,size:r}=t;const{usage:s,label:i,shrinkToFit:o}=t;super(),this._gpuData=Object.create(null),this._gcLastUsed=-1,this.autoGarbageCollect=!0,this.uid=it("buffer"),this._resourceType="buffer",this._resourceId=it("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,n instanceof Array&&(n=new Float32Array(n)),this._data=n,r??(r=n?.byteLength);const a=!!n;this.descriptor={size:r,usage:s,mappedAtCreation:a,label:i},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&kt.STATIC)}set static(t){t?this.descriptor.usage|=kt.STATIC:this.descriptor.usage&=~kt.STATIC}setDataWithSize(t,n,r){if(this._updateID++,this._updateSize=n*t.BYTES_PER_ELEMENT,this._data===t){r&&this.emit("update",this);return}const s=this._data;if(this._data=t,this._dataInt32=null,!s||s.length!==t.length){!this.shrinkToFit&&s&&t.byteLength<s.byteLength?r&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=it("resource"),this.emit("change",this));return}r&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}unload(){this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null)}destroy(){this.destroyed=!0,this.unload(),this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};function Jl(e,t){if(!(e instanceof er)){let n=t?kt.INDEX:kt.VERTEX;e instanceof Array&&(t?(e=new Uint32Array(e),n=kt.INDEX|kt.COPY_DST):(e=new Float32Array(e),n=kt.VERTEX|kt.COPY_DST)),e=new er({data:e,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:n})}return e}function Am(e,t,n){const r=e.getAttribute(t);if(!r)return n.minX=0,n.minY=0,n.maxX=0,n.maxY=0,n;const s=r.buffer.data;let i=1/0,o=1/0,a=-1/0,c=-1/0;const h=s.BYTES_PER_ELEMENT,l=(r.offset||0)/h,u=(r.stride||8)/h;for(let f=l;f<s.length;f+=u){const d=s[f],p=s[f+1];d>a&&(a=d),p>c&&(c=p),d<i&&(i=d),p<o&&(o=p)}return n.minX=i,n.minY=o,n.maxX=a,n.maxY=c,n}function Tm(e){return(e instanceof er||Array.isArray(e)||e.BYTES_PER_ELEMENT)&&(e={buffer:e}),e.buffer=Jl(e.buffer,!1),e}class Cm extends qt{constructor(t={}){super(),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=it("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Dt,this._boundsDirty=!0;const{attributes:n,indexBuffer:r,topology:s}=t;if(this.buffers=[],this.attributes={},n)for(const i in n)this.addAttribute(i,n[i]);this.instanceCount=t.instanceCount??1,r&&this.addIndex(r),this.topology=s||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const n=this.attributes[t];return n.buffer.data.length/(n.stride/4||n.size)}return 0}addAttribute(t,n){const r=Tm(n);this.buffers.indexOf(r.buffer)===-1&&(this.buffers.push(r.buffer),r.buffer.on("update",this.onBufferUpdate,this),r.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=r}addIndex(t){this.indexBuffer=Jl(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Am(this,"aPosition",this._bounds)):this._bounds}unload(){this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null)}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(n=>n.destroy()),this.unload(),this.indexBuffer?.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const Pm=new Float32Array(1),km=new Uint32Array(1);class Mm extends Cm{constructor(){const n=new er({data:Pm,label:"attribute-batch-buffer",usage:kt.VERTEX|kt.COPY_DST,shrinkToFit:!1}),r=new er({data:km,label:"index-batch-buffer",usage:kt.INDEX|kt.COPY_DST,shrinkToFit:!1}),s=24;super({attributes:{aPosition:{buffer:n,format:"float32x2",stride:s,offset:0},aUV:{buffer:n,format:"float32x2",stride:s,offset:8},aColor:{buffer:n,format:"unorm8x4",stride:s,offset:16},aTextureIdAndRound:{buffer:n,format:"uint16x2",stride:s,offset:20}},indexBuffer:r})}}function Ha(e,t,n){if(e)for(const r in e){const s=r.toLocaleLowerCase(),i=t[s];if(i){let o=e[r];r==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),n&&i.push(`//----${n}----//`),i.push(o)}else Q(`${r} placement hook does not exist in shader`)}}const Em=/\{\{(.*?)\}\}/g;function Ya(e){const t={};return(e.match(Em)?.map(r=>r.replace(/[{()}]/g,""))??[]).forEach(r=>{t[r]=[]}),t}function Xa(e,t){let n;const r=/@in\s+([^;]+);/g;for(;(n=r.exec(e))!==null;)t.push(n[1])}function qa(e,t,n=!1){const r=[];Xa(t,r),e.forEach(a=>{a.header&&Xa(a.header,r)});const s=r;n&&s.sort();const i=s.map((a,c)=>`       @location(${c}) ${a},`).join(`
`);let o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${i}
`),o}function Ka(e,t){let n;const r=/@out\s+([^;]+);/g;for(;(n=r.exec(e))!==null;)t.push(n[1])}function Im(e){const n=/\b(\w+)\s*:/g.exec(e);return n?n[1]:""}function zm(e){const t=/@.*?\s+/g;return e.replace(t,"")}function $m(e,t){const n=[];Ka(t,n),e.forEach(c=>{c.header&&Ka(c.header,n)});let r=0;const s=n.sort().map(c=>c.indexOf("builtin")>-1?c:`@location(${r++}) ${c}`).join(`,
`),i=n.sort().map(c=>`       var ${zm(c)};`).join(`
`),o=`return VSOutput(
            ${n.sort().map(c=>` ${Im(c)}`).join(`,
`)});`;let a=t.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${s}
`),a=a.replace("{{start}}",`
${i}
`),a=a.replace("{{return}}",`
${o}
`),a}function Ja(e,t){let n=e;for(const r in t){const s=t[r];s.join(`
`).length?n=n.replace(`{{${r}}}`,`//-----${r} START-----//
${s.join(`
`)}
//----${r} FINISH----//`):n=n.replace(`{{${r}}}`,"")}return n}const me=Object.create(null),si=new Map;let Rm=0;function Om({template:e,bits:t}){const n=Ql(e,t);if(me[n])return me[n];const{vertex:r,fragment:s}=Fm(e,t);return me[n]=tu(r,s,t),me[n]}function Bm({template:e,bits:t}){const n=Ql(e,t);return me[n]||(me[n]=tu(e.vertex,e.fragment,t)),me[n]}function Fm(e,t){const n=t.map(o=>o.vertex).filter(o=>!!o),r=t.map(o=>o.fragment).filter(o=>!!o);let s=qa(n,e.vertex,!0);s=$m(n,s);const i=qa(r,e.fragment,!0);return{vertex:s,fragment:i}}function Ql(e,t){return t.map(n=>(si.has(n)||si.set(n,Rm++),si.get(n))).sort((n,r)=>n-r).join("-")+e.vertex+e.fragment}function tu(e,t,n){const r=Ya(e),s=Ya(t);return n.forEach(i=>{Ha(i.vertex,r,i.name),Ha(i.fragment,s,i.name)}),{vertex:Ja(e,r),fragment:Ja(t,s)}}const Dm=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,Lm=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,Gm=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,jm=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,Nm={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},Um={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function Wm({bits:e,name:t}){const n=Om({template:{fragment:Lm,vertex:Dm},bits:[Nm,...e]});return gs.from({name:t,vertex:{source:n.vertex,entryPoint:"main"},fragment:{source:n.fragment,entryPoint:"main"}})}function Vm({bits:e,name:t}){return new Pl({name:t,...Bm({template:{vertex:Gm,fragment:jm},bits:[Um,...e]})})}const Zm={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},Hm={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},ii={};function Ym(e){const t=[];if(e===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let n=0;for(let r=0;r<e;r++)t.push(`@group(1) @binding(${n++}) var textureSource${r+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${n++}) var textureSampler${r+1}: sampler;`)}return t.join(`
`)}function Xm(e){const t=[];if(e===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let n=0;n<e;n++)n===e-1?t.push("  default:{"):t.push(`  case ${n}:{`),t.push(`      outColor = textureSampleGrad(textureSource${n+1}, textureSampler${n+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function qm(e){return ii[e]||(ii[e]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${Ym(e)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${Xm(e)}
            `}}),ii[e]}const oi={};function Km(e){const t=[];for(let n=0;n<e;n++)n>0&&t.push("else"),n<e-1&&t.push(`if(vTextureId < ${n}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${n}], vUV);`),t.push("}");return t.join(`
`)}function Jm(e){return oi[e]||(oi[e]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${e}];

            `,main:`

                ${Km(e)}
            `}}),oi[e]}const Qm={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},tg={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Qa={};function eg(e){let t=Qa[e];if(t)return t;const n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=r;return t=Qa[e]=new Il({uTextures:{value:n,type:"i32",size:e}},{isStatic:!0}),t}class tc extends zo{constructor(t){const n=Vm({name:"batch",bits:[Hm,Jm(t),tg]}),r=Wm({name:"batch",bits:[Zm,qm(t),Qm]});super({glProgram:n,gpuProgram:r,resources:{batchSamplers:eg(t)}}),this.maxTextures=t}}let In=null;const eu=class nu extends Sm{constructor(t){super(t),this.geometry=new Mm,this.name=nu.extension.name,this.vertexSize=6,In??(In=new tc(t.maxTextures)),this.shader=In}packAttributes(t,n,r,s,i){const o=i<<16|t.roundPixels&65535,a=t.transform,c=a.a,h=a.b,l=a.c,u=a.d,f=a.tx,d=a.ty,{positions:p,uvs:m}=t,g=t.color,y=t.attributeOffset,x=y+t.attributeSize;for(let b=y;b<x;b++){const _=b*2,v=p[_],w=p[_+1];n[s++]=c*v+l*w+f,n[s++]=u*w+h*v+d,n[s++]=m[_],n[s++]=m[_+1],r[s++]=g,r[s++]=o}}packQuadAttributes(t,n,r,s,i){const o=t.texture,a=t.transform,c=a.a,h=a.b,l=a.c,u=a.d,f=a.tx,d=a.ty,p=t.bounds,m=p.maxX,g=p.minX,y=p.maxY,x=p.minY,b=o.uvs,_=t.color,v=i<<16|t.roundPixels&65535;n[s+0]=c*g+l*x+f,n[s+1]=u*x+h*g+d,n[s+2]=b.x0,n[s+3]=b.y0,r[s+4]=_,r[s+5]=v,n[s+6]=c*m+l*x+f,n[s+7]=u*x+h*m+d,n[s+8]=b.x1,n[s+9]=b.y1,r[s+10]=_,r[s+11]=v,n[s+12]=c*m+l*y+f,n[s+13]=u*y+h*m+d,n[s+14]=b.x2,n[s+15]=b.y2,r[s+16]=_,r[s+17]=v,n[s+18]=c*g+l*y+f,n[s+19]=u*y+h*g+d,n[s+20]=b.x3,n[s+21]=b.y3,r[s+22]=_,r[s+23]=v}_updateMaxTextures(t){this.shader.maxTextures!==t&&(In=new tc(t),this.shader=In)}destroy(){this.shader=null,super.destroy()}};eu.extension={type:[E.Batcher],name:"default"};let ng=eu;class gr{constructor(t){this.items=Object.create(null);const{renderer:n,type:r,onUnload:s,priority:i,name:o}=t;this._renderer=n,n.gc.addResourceHash(this,"items",r,i??0),this._onUnload=s,this.name=o}add(t){return this.items[t.uid]?!1:(this.items[t.uid]=t,t.once("unload",this.remove,this),t._gcLastUsed=this._renderer.gc.now,!0)}remove(t,...n){if(!this.items[t.uid])return;const r=t._gpuData[this._renderer.uid];r&&(this._onUnload?.(t,...n),r.destroy(),t._gpuData[this._renderer.uid]=null,this.items[t.uid]=null)}removeAll(...t){Object.values(this.items).forEach(n=>n&&this.remove(n,...t))}destroy(...t){this.removeAll(...t),this.items=Object.create(null),this._renderer=null,this._onUnload=null}}function rg(e,t,n,r,s,i,o,a=null){let c=0;n*=t,s*=i;const h=a.a,l=a.b,u=a.c,f=a.d,d=a.tx,p=a.ty;for(;c<o;){const m=e[n],g=e[n+1];r[s]=h*m+u*g+d,r[s+1]=l*m+f*g+p,s+=i,n+=t,c++}}function sg(e,t,n,r){let s=0;for(t*=n;s<r;)e[t]=0,e[t+1]=0,t+=n,s++}function ru(e,t,n,r,s){const i=t.a,o=t.b,a=t.c,c=t.d,h=t.tx,l=t.ty;n||(n=0),r||(r=2),s||(s=e.length/r-n);let u=n*r;for(let f=0;f<s;f++){const d=e[u],p=e[u+1];e[u]=i*d+a*p+h,e[u+1]=o*d+c*p+l,u+=r}}const ig=new D;class Bo{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,n=t>>16|t&65280|(t&255)<<16,r=this.renderable;return r?al(n,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):n+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||ig}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const nr={extension:{type:E.ShapeBuilder,name:"circle"},build(e,t){let n,r,s,i,o,a;if(e.type==="circle"){const _=e;if(o=a=_.radius,o<=0)return!1;n=_.x,r=_.y,s=i=0}else if(e.type==="ellipse"){const _=e;if(o=_.halfWidth,a=_.halfHeight,o<=0||a<=0)return!1;n=_.x,r=_.y,s=i=0}else{const _=e,v=_.width/2,w=_.height/2;n=_.x+v,r=_.y+w,o=a=Math.max(0,Math.min(_.radius,Math.min(v,w))),s=v-o,i=w-a}if(s<0||i<0)return!1;const c=Math.ceil(2.3*Math.sqrt(o+a)),h=c*8+(s?4:0)+(i?4:0);if(h===0)return!1;if(c===0)return t[0]=t[6]=n+s,t[1]=t[3]=r+i,t[2]=t[4]=n-s,t[5]=t[7]=r-i,!0;let l=0,u=c*4+(s?2:0)+2,f=u,d=h,p=s+o,m=i,g=n+p,y=n-p,x=r+m;if(t[l++]=g,t[l++]=x,t[--u]=x,t[--u]=y,i){const _=r-m;t[f++]=y,t[f++]=_,t[--d]=_,t[--d]=g}for(let _=1;_<c;_++){const v=Math.PI/2*(_/c),w=s+Math.cos(v)*o,A=i+Math.sin(v)*a,k=n+w,$=n-w,C=r+A,T=r-A;t[l++]=k,t[l++]=C,t[--u]=C,t[--u]=$,t[f++]=$,t[f++]=T,t[--d]=T,t[--d]=k}p=s,m=i+a,g=n+p,y=n-p,x=r+m;const b=r-m;return t[l++]=g,t[l++]=x,t[--d]=b,t[--d]=g,s&&(t[l++]=y,t[l++]=x,t[--d]=b,t[--d]=y),!0},triangulate(e,t,n,r,s,i){if(e.length===0)return;let o=0,a=0;for(let l=0;l<e.length;l+=2)o+=e[l],a+=e[l+1];o/=e.length/2,a/=e.length/2;let c=r;t[c*n]=o,t[c*n+1]=a;const h=c++;for(let l=0;l<e.length;l+=2)t[c*n]=e[l],t[c*n+1]=e[l+1],l>0&&(s[i++]=c,s[i++]=h,s[i++]=c-1),c++;s[i++]=h+1,s[i++]=h,s[i++]=c-1}},og={...nr,extension:{...nr.extension,name:"ellipse"}},ag={...nr,extension:{...nr.extension,name:"roundedRectangle"}},su=1e-4,ec=1e-4;function cg(e){const t=e.length;if(t<6)return 1;let n=0;for(let r=0,s=e[t-2],i=e[t-1];r<t;r+=2){const o=e[r],a=e[r+1];n+=(o-s)*(a+i),s=o,i=a}return n<0?-1:1}function nc(e,t,n,r,s,i,o,a){const c=e-n*s,h=t-r*s,l=e+n*i,u=t+r*i;let f,d;o?(f=r,d=-n):(f=-r,d=n);const p=c+f,m=h+d,g=l+f,y=u+d;return a.push(p,m),a.push(g,y),2}function Te(e,t,n,r,s,i,o,a){const c=n-e,h=r-t;let l=Math.atan2(c,h),u=Math.atan2(s-e,i-t);a&&l<u?l+=Math.PI*2:!a&&l>u&&(u+=Math.PI*2);let f=l;const d=u-l,p=Math.abs(d),m=Math.sqrt(c*c+h*h),g=(15*p*Math.sqrt(m)/Math.PI>>0)+1,y=d/g;if(f+=y,a){o.push(e,t),o.push(n,r);for(let x=1,b=f;x<g;x++,b+=y)o.push(e,t),o.push(e+Math.sin(b)*m,t+Math.cos(b)*m);o.push(e,t),o.push(s,i)}else{o.push(n,r),o.push(e,t);for(let x=1,b=f;x<g;x++,b+=y)o.push(e+Math.sin(b)*m,t+Math.cos(b)*m),o.push(e,t);o.push(s,i),o.push(e,t)}return g*2}function hg(e,t,n,r,s,i){const o=su;if(e.length===0)return;const a=t;let c=a.alignment;if(t.alignment!==.5){let I=cg(e);c=(c-.5)*I+.5}const h=new At(e[0],e[1]),l=new At(e[e.length-2],e[e.length-1]),u=r,f=Math.abs(h.x-l.x)<o&&Math.abs(h.y-l.y)<o;if(u){e=e.slice(),f&&(e.pop(),e.pop(),l.set(e[e.length-2],e[e.length-1]));const I=(h.x+l.x)*.5,H=(l.y+h.y)*.5;e.unshift(I,H),e.push(I,H)}const d=s,p=e.length/2;let m=e.length;const g=d.length/2,y=a.width/2,x=y*y,b=a.miterLimit*a.miterLimit;let _=e[0],v=e[1],w=e[2],A=e[3],k=0,$=0,C=-(v-A),T=_-w,O=0,F=0,B=Math.sqrt(C*C+T*T);C/=B,T/=B,C*=y,T*=y;const W=c,P=(1-W)*2,M=W*2;u||(a.cap==="round"?m+=Te(_-C*(P-M)*.5,v-T*(P-M)*.5,_-C*P,v-T*P,_+C*M,v+T*M,d,!0)+2:a.cap==="square"&&(m+=nc(_,v,C,T,P,M,!0,d))),d.push(_-C*P,v-T*P),d.push(_+C*M,v+T*M);for(let I=1;I<p-1;++I){_=e[(I-1)*2],v=e[(I-1)*2+1],w=e[I*2],A=e[I*2+1],k=e[(I+1)*2],$=e[(I+1)*2+1],C=-(v-A),T=_-w,B=Math.sqrt(C*C+T*T),C/=B,T/=B,C*=y,T*=y,O=-(A-$),F=w-k,B=Math.sqrt(O*O+F*F),O/=B,F/=B,O*=y,F*=y;const H=w-_,ct=v-A,ft=w-k,vt=$-A,Zt=H*ft+ct*vt,Ne=ct*ft-vt*H,Tn=Ne<0;if(Math.abs(Ne)<.001*Math.abs(Zt)){d.push(w-C*P,A-T*P),d.push(w+C*M,A+T*M),Zt>=0&&(a.join==="round"?m+=Te(w,A,w-C*P,A-T*P,w-O*P,A-F*P,d,!1)+4:m+=2,d.push(w-O*M,A-F*M),d.push(w+O*P,A+F*P));continue}const ca=(-C+_)*(-T+A)-(-C+w)*(-T+v),ha=(-O+k)*(-F+A)-(-O+w)*(-F+$),wr=(H*ha-ft*ca)/Ne,Sr=(vt*ca-ct*ha)/Ne,Rs=(wr-w)*(wr-w)+(Sr-A)*(Sr-A),ve=w+(wr-w)*P,we=A+(Sr-A)*P,Se=w-(wr-w)*M,Ae=A-(Sr-A)*M,Fd=Math.min(H*H+ct*ct,ft*ft+vt*vt),la=Tn?P:M,Dd=Fd+la*la*x;Rs<=Dd?a.join==="bevel"||Rs/x>b?(Tn?(d.push(ve,we),d.push(w+C*M,A+T*M),d.push(ve,we),d.push(w+O*M,A+F*M)):(d.push(w-C*P,A-T*P),d.push(Se,Ae),d.push(w-O*P,A-F*P),d.push(Se,Ae)),m+=2):a.join==="round"?Tn?(d.push(ve,we),d.push(w+C*M,A+T*M),m+=Te(w,A,w+C*M,A+T*M,w+O*M,A+F*M,d,!0)+4,d.push(ve,we),d.push(w+O*M,A+F*M)):(d.push(w-C*P,A-T*P),d.push(Se,Ae),m+=Te(w,A,w-C*P,A-T*P,w-O*P,A-F*P,d,!1)+4,d.push(w-O*P,A-F*P),d.push(Se,Ae)):(d.push(ve,we),d.push(Se,Ae)):(d.push(w-C*P,A-T*P),d.push(w+C*M,A+T*M),a.join==="round"?Tn?m+=Te(w,A,w+C*M,A+T*M,w+O*M,A+F*M,d,!0)+2:m+=Te(w,A,w-C*P,A-T*P,w-O*P,A-F*P,d,!1)+2:a.join==="miter"&&Rs/x<=b&&(Tn?(d.push(Se,Ae),d.push(Se,Ae)):(d.push(ve,we),d.push(ve,we)),m+=2),d.push(w-O*P,A-F*P),d.push(w+O*M,A+F*M),m+=2)}_=e[(p-2)*2],v=e[(p-2)*2+1],w=e[(p-1)*2],A=e[(p-1)*2+1],C=-(v-A),T=_-w,B=Math.sqrt(C*C+T*T),C/=B,T/=B,C*=y,T*=y,d.push(w-C*P,A-T*P),d.push(w+C*M,A+T*M),u||(a.cap==="round"?m+=Te(w-C*(P-M)*.5,A-T*(P-M)*.5,w-C*P,A-T*P,w+C*M,A+T*M,d,!1)+2:a.cap==="square"&&(m+=nc(w,A,C,T,P,M,!1,d)));const j=ec*ec;for(let I=g;I<m+g-2;++I)_=d[I*2],v=d[I*2+1],w=d[(I+1)*2],A=d[(I+1)*2+1],k=d[(I+2)*2],$=d[(I+2)*2+1],!(Math.abs(_*(A-$)+w*($-v)+k*(v-A))<j)&&i.push(I,I+1,I+2)}function lg(e,t,n,r){const s=su;if(e.length===0)return;const i=e[0],o=e[1],a=e[e.length-2],c=e[e.length-1],h=t||Math.abs(i-a)<s&&Math.abs(o-c)<s,l=n,u=e.length/2,f=l.length/2;for(let d=0;d<u;d++)l.push(e[d*2]),l.push(e[d*2+1]);for(let d=0;d<u-1;d++)r.push(f+d,f+d+1);h&&r.push(f+u-1,f)}function iu(e,t,n,r,s,i,o){const a=Cp(e,t,2);if(!a)return;for(let h=0;h<a.length;h+=3)i[o++]=a[h]+s,i[o++]=a[h+1]+s,i[o++]=a[h+2]+s;let c=s*r;for(let h=0;h<e.length;h+=2)n[c]=e[h],n[c+1]=e[h+1],c+=r}const ug=[],dg={extension:{type:E.ShapeBuilder,name:"polygon"},build(e,t){for(let n=0;n<e.points.length;n++)t[n]=e.points[n];return!0},triangulate(e,t,n,r,s,i){iu(e,ug,t,n,r,s,i)}},fg={extension:{type:E.ShapeBuilder,name:"rectangle"},build(e,t){const n=e,r=n.x,s=n.y,i=n.width,o=n.height;return i>0&&o>0?(t[0]=r,t[1]=s,t[2]=r+i,t[3]=s,t[4]=r+i,t[5]=s+o,t[6]=r,t[7]=s+o,!0):!1},triangulate(e,t,n,r,s,i){let o=0;r*=n,t[r+o]=e[0],t[r+o+1]=e[1],o+=n,t[r+o]=e[2],t[r+o+1]=e[3],o+=n,t[r+o]=e[6],t[r+o+1]=e[7],o+=n,t[r+o]=e[4],t[r+o+1]=e[5],o+=n;const a=r/n;s[i++]=a,s[i++]=a+1,s[i++]=a+2,s[i++]=a+1,s[i++]=a+3,s[i++]=a+2}},pg={extension:{type:E.ShapeBuilder,name:"triangle"},build(e,t){return t[0]=e.x,t[1]=e.y,t[2]=e.x2,t[3]=e.y2,t[4]=e.x3,t[5]=e.y3,!0},triangulate(e,t,n,r,s,i){let o=0;r*=n,t[r+o]=e[0],t[r+o+1]=e[1],o+=n,t[r+o]=e[2],t[r+o+1]=e[3],o+=n,t[r+o]=e[4],t[r+o+1]=e[5];const a=r/n;s[i++]=a,s[i++]=a+1,s[i++]=a+2}},rc=[{offset:0,color:"white"},{offset:1,color:"black"}],Fo=class Fi{constructor(...t){this.uid=it("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let n=mg(t);n={...n.type==="radial"?Fi.defaultRadialOptions:Fi.defaultLinearOptions,...qh(n)},this._textureSize=n.textureSize,this._wrapMode=n.wrapMode,n.type==="radial"?(this.center=n.center,this.outerCenter=n.outerCenter??this.center,this.innerRadius=n.innerRadius,this.outerRadius=n.outerRadius,this.scale=n.scale,this.rotation=n.rotation):(this.start=n.start,this.end=n.end),this.textureSpace=n.textureSpace,this.type=n.type,n.colorStops.forEach(s=>{this.addColorStop(s.offset,s.color)})}addColorStop(t,n){return this.colorStops.push({offset:t,color:ut.shared.setValue(n).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:n}=this.start,{x:r,y:s}=this.end,i=r-t,o=s-n;const a=i<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(i<0){const g=t;t=r,r=g,i*=-1}if(o<0){const g=n;n=s,s=g,o*=-1}}const c=this.colorStops.length?this.colorStops:rc,h=this._textureSize,{canvas:l,context:u}=ic(h,1),f=a?u.createLinearGradient(this._textureSize,0,0,0):u.createLinearGradient(0,0,this._textureSize,0);sc(f,c),u.fillStyle=f,u.fillRect(0,0,h,1),this.texture=new U({source:new ln({resource:l,addressMode:this._wrapMode})});const d=Math.sqrt(i*i+o*o),p=Math.atan2(o,i),m=new D;m.scale(d/h,1),m.rotate(p),m.translate(t,n),this.textureSpace==="local"&&m.scale(h,h),this.transform=m}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:rc,n=this._textureSize,{canvas:r,context:s}=ic(n,n),{x:i,y:o}=this.center,{x:a,y:c}=this.outerCenter,h=this.innerRadius,l=this.outerRadius,u=a-l,f=c-l,d=n/(l*2),p=(i-u)*d,m=(o-f)*d,g=s.createRadialGradient(p,m,h*d,(a-u)*d,(c-f)*d,l*d);sc(g,t),s.fillStyle=t[t.length-1].color,s.fillRect(0,0,n,n),s.fillStyle=g,s.translate(p,m),s.rotate(this.rotation),s.scale(1,this.scale),s.translate(-p,-m),s.fillRect(0,0,n,n),this.texture=new U({source:new ln({resource:r,addressMode:this._wrapMode})});const y=new D;y.scale(1/d,1/d),y.translate(u,f),this.textureSpace==="local"&&y.scale(n,n),this.transform=y}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};Fo.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};Fo.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let ie=Fo;function sc(e,t){for(let n=0;n<t.length;n++){const r=t[n];e.addColorStop(r.offset,r.color)}}function ic(e,t){const n=X.get().createCanvas(e,t),r=n.getContext("2d");return{canvas:n,context:r}}function mg(e){let t=e[0]??{};return(typeof t=="number"||e[1])&&(G("8.5.2","use options object instead"),t={type:"linear",start:{x:e[0],y:e[1]},end:{x:e[2],y:e[3]},textureSpace:e[4],textureSize:e[5]??ie.defaultLinearOptions.textureSize}),t}const gg=new D,yg=new at;function _g(e,t,n,r){const s=t.matrix?e.copyFrom(t.matrix).invert():e.identity();if(t.textureSpace==="local"){const o=n.getBounds(yg);t.width&&o.pad(t.width);const{x:a,y:c}=o,h=1/o.width,l=1/o.height,u=-a*h,f=-c*l,d=s.a,p=s.b,m=s.c,g=s.d;s.a*=h,s.b*=h,s.c*=l,s.d*=l,s.tx=u*d+f*m+s.tx,s.ty=u*p+f*g+s.ty}else s.translate(t.texture.frame.x,t.texture.frame.y),s.scale(1/t.texture.source.width,1/t.texture.source.height);const i=t.texture.source.style;return!(t.fill instanceof ie)&&i.addressMode==="clamp-to-edge"&&(i.addressMode="repeat",i.update()),r&&s.append(gg.copyFrom(r).invert()),s}const _s={};Y.handleByMap(E.ShapeBuilder,_s);Y.add(fg,dg,pg,nr,og,ag);const bg=new at,xg=new D;function vg(e,t){const{geometryData:n,batches:r}=t;r.length=0,n.indices.length=0,n.vertices.length=0,n.uvs.length=0;for(let s=0;s<e.instructions.length;s++){const i=e.instructions[s];if(i.action==="texture")wg(i.data,r,n);else if(i.action==="fill"||i.action==="stroke"){const o=i.action==="stroke",a=i.data.path.shapePath,c=i.data.style,h=i.data.hole;o&&h&&oc(h.shapePath,c,!0,r,n),h&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=h.shapePath.shapePrimitives),oc(a,c,o,r,n)}}}function wg(e,t,n){const r=[],s=_s.rectangle,i=bg;i.x=e.dx,i.y=e.dy,i.width=e.dw,i.height=e.dh;const o=e.transform;if(!s.build(i,r))return;const{vertices:a,uvs:c,indices:h}=n,l=h.length,u=a.length/2;o&&ru(r,o),s.triangulate(r,a,2,u,h,l);const f=e.image,d=f.uvs;c.push(d.x0,d.y0,d.x1,d.y1,d.x3,d.y3,d.x2,d.y2);const p=Mt.get(Bo);p.indexOffset=l,p.indexSize=h.length-l,p.attributeOffset=u,p.attributeSize=a.length/2-u,p.baseColor=e.style,p.alpha=e.alpha,p.texture=f,p.geometryData=n,t.push(p)}function oc(e,t,n,r,s){const{vertices:i,uvs:o,indices:a}=s;e.shapePrimitives.forEach(({shape:c,transform:h,holes:l})=>{const u=[],f=_s[c.type];if(!f.build(c,u))return;const d=a.length,p=i.length/2;let m="triangle-list";if(h&&ru(u,h),n){const b=c.closePath??!0,_=t;_.pixelLine?(lg(u,b,i,a),m="line-list"):hg(u,_,!1,b,i,a)}else if(l){const b=[],_=u.slice();Sg(l).forEach(w=>{b.push(_.length/2),_.push(...w)}),iu(_,b,i,2,p,a,d)}else f.triangulate(u,i,2,p,a,d);const g=o.length/2,y=t.texture;if(y!==U.WHITE){const b=_g(xg,t,c,h);rg(i,2,p,o,g,2,i.length/2-p,b)}else sg(o,g,2,i.length/2-p);const x=Mt.get(Bo);x.indexOffset=d,x.indexSize=a.length-d,x.attributeOffset=p,x.attributeSize=i.length/2-p,x.baseColor=t.color,x.alpha=t.alpha,x.texture=y,x.geometryData=s,x.topology=m,r.push(x)})}function Sg(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n].shape,s=[];_s[r.type].build(r,s)&&t.push(s)}return t}class Ag{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}reset(){this.batches&&this.batches.forEach(t=>{Mt.return(t)}),this.graphicsData&&Mt.return(this.graphicsData),this.isBatchable=!1,this.context=null,this.batches.length=0,this.geometryData.indices.length=0,this.geometryData.vertices.length=0,this.geometryData.uvs.length=0,this.graphicsData=null}destroy(){this.reset(),this.batches=null,this.geometryData=null}}class Tg{constructor(){this.instructions=new Mo}init(t){const n=t.maxTextures;this.batcher?this.batcher._updateMaxTextures(n):this.batcher=new ng({maxTextures:n}),this.instructions.reset()}get geometry(){return G(Xd,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const Do=class Di{constructor(t){this._renderer=t,this._managedContexts=new gr({renderer:t,type:"resource",name:"graphicsContext"})}init(t){Di.defaultOptions.bezierSmoothness=t?.bezierSmoothness??Di.defaultOptions.bezierSmoothness}getContextRenderData(t){return t._gpuData[this._renderer.uid].graphicsData||this._initContextRenderData(t)}updateGpuContext(t){const n=!!t._gpuData[this._renderer.uid],r=t._gpuData[this._renderer.uid]||this._initContext(t);if(t.dirty||!n){n&&r.reset(),vg(t,r);const s=t.batchMode;t.customShader||s==="no-batch"?r.isBatchable=!1:s==="auto"?r.isBatchable=r.geometryData.vertices.length<400:r.isBatchable=!0,t.dirty=!1}return r}getGpuContext(t){return t._gpuData[this._renderer.uid]||this._initContext(t)}_initContextRenderData(t){const n=Mt.get(Tg,{maxTextures:this._renderer.limits.maxBatchableTextures}),r=t._gpuData[this._renderer.uid],{batches:s,geometryData:i}=r;r.graphicsData=n;const o=i.vertices.length,a=i.indices.length;for(let u=0;u<s.length;u++)s[u].applyTransform=!1;const c=n.batcher;c.ensureAttributeBuffer(o),c.ensureIndexBuffer(a),c.begin();for(let u=0;u<s.length;u++){const f=s[u];c.add(f)}c.finish(n.instructions);const h=c.geometry;h.indexBuffer.setDataWithSize(c.indexBuffer,c.indexSize,!0),h.buffers[0].setDataWithSize(c.attributeBuffer.float32View,c.attributeSize,!0);const l=c.batches;for(let u=0;u<l.length;u++){const f=l[u];f.bindGroup=fm(f.textures.textures,f.textures.count,this._renderer.limits.maxBatchableTextures)}return n}_initContext(t){const n=new Ag;return n.context=t,t._gpuData[this._renderer.uid]=n,this._managedContexts.add(t),n}destroy(){this._managedContexts.destroy(),this._renderer=null}};Do.extension={type:[E.WebGLSystem,E.WebGPUSystem],name:"graphicsContext"};Do.defaultOptions={bezierSmoothness:.5};let Lo=Do;const Cg=8,Fr=11920929e-14,Pg=1;function ou(e,t,n,r,s,i,o,a,c,h){const u=Math.min(.99,Math.max(0,h??Lo.defaultOptions.bezierSmoothness));let f=(Pg-u)/1;return f*=f,kg(t,n,r,s,i,o,a,c,e,f),e}function kg(e,t,n,r,s,i,o,a,c,h){Li(e,t,n,r,s,i,o,a,c,h,0),c.push(o,a)}function Li(e,t,n,r,s,i,o,a,c,h,l){if(l>Cg)return;const u=(e+n)/2,f=(t+r)/2,d=(n+s)/2,p=(r+i)/2,m=(s+o)/2,g=(i+a)/2,y=(u+d)/2,x=(f+p)/2,b=(d+m)/2,_=(p+g)/2,v=(y+b)/2,w=(x+_)/2;if(l>0){let A=o-e,k=a-t;const $=Math.abs((n-o)*k-(r-a)*A),C=Math.abs((s-o)*k-(i-a)*A);if($>Fr&&C>Fr){if(($+C)*($+C)<=h*(A*A+k*k)){c.push(v,w);return}}else if($>Fr){if($*$<=h*(A*A+k*k)){c.push(v,w);return}}else if(C>Fr){if(C*C<=h*(A*A+k*k)){c.push(v,w);return}}else if(A=v-(e+o)/2,k=w-(t+a)/2,A*A+k*k<=h){c.push(v,w);return}}Li(e,t,u,f,y,x,v,w,c,h,l+1),Li(v,w,b,_,m,g,o,a,c,h,l+1)}const Mg=8,Eg=11920929e-14,Ig=1;function zg(e,t,n,r,s,i,o,a){const h=Math.min(.99,Math.max(0,a??Lo.defaultOptions.bezierSmoothness));let l=(Ig-h)/1;return l*=l,$g(t,n,r,s,i,o,e,l),e}function $g(e,t,n,r,s,i,o,a){Gi(o,e,t,n,r,s,i,a,0),o.push(s,i)}function Gi(e,t,n,r,s,i,o,a,c){if(c>Mg)return;const h=(t+r)/2,l=(n+s)/2,u=(r+i)/2,f=(s+o)/2,d=(h+u)/2,p=(l+f)/2;let m=i-t,g=o-n;const y=Math.abs((r-i)*g-(s-o)*m);if(y>Eg){if(y*y<=a*(m*m+g*g)){e.push(d,p);return}}else if(m=d-(t+i)/2,g=p-(n+o)/2,m*m+g*g<=a){e.push(d,p);return}Gi(e,t,n,h,l,d,p,a,c+1),Gi(e,d,p,u,f,i,o,a,c+1)}function au(e,t,n,r,s,i,o,a){let c=Math.abs(s-i);(!o&&s>i||o&&i>s)&&(c=2*Math.PI-c),a||(a=Math.max(6,Math.floor(6*Math.pow(r,1/3)*(c/Math.PI)))),a=Math.max(a,3);let h=c/a,l=s;h*=o?-1:1;for(let u=0;u<a+1;u++){const f=Math.cos(l),d=Math.sin(l),p=t+f*r,m=n+d*r;e.push(p,m),l+=h}}function Rg(e,t,n,r,s,i){const o=e[e.length-2],c=e[e.length-1]-n,h=o-t,l=s-n,u=r-t,f=Math.abs(c*u-h*l);if(f<1e-8||i===0){(e[e.length-2]!==t||e[e.length-1]!==n)&&e.push(t,n);return}const d=c*c+h*h,p=l*l+u*u,m=c*l+h*u,g=i*Math.sqrt(d)/f,y=i*Math.sqrt(p)/f,x=g*m/d,b=y*m/p,_=g*u+y*h,v=g*l+y*c,w=h*(y+x),A=c*(y+x),k=u*(g+b),$=l*(g+b),C=Math.atan2(A-v,w-_),T=Math.atan2($-v,k-_);au(e,_+t,v+n,i,C,T,h*l>u*c)}const qn=Math.PI*2,ai={centerX:0,centerY:0,ang1:0,ang2:0},ci=({x:e,y:t},n,r,s,i,o,a,c)=>{e*=n,t*=r;const h=s*e-i*t,l=i*e+s*t;return c.x=h+o,c.y=l+a,c};function Og(e,t){const n=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=t===1.5707963267948966?.551915024494:n,s=Math.cos(e),i=Math.sin(e),o=Math.cos(e+t),a=Math.sin(e+t);return[{x:s-i*r,y:i+s*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]}const ac=(e,t,n,r)=>{const s=e*r-t*n<0?-1:1;let i=e*n+t*r;return i>1&&(i=1),i<-1&&(i=-1),s*Math.acos(i)},Bg=(e,t,n,r,s,i,o,a,c,h,l,u,f)=>{const d=Math.pow(s,2),p=Math.pow(i,2),m=Math.pow(l,2),g=Math.pow(u,2);let y=d*p-d*g-p*m;y<0&&(y=0),y/=d*g+p*m,y=Math.sqrt(y)*(o===a?-1:1);const x=y*s/i*u,b=y*-i/s*l,_=h*x-c*b+(e+n)/2,v=c*x+h*b+(t+r)/2,w=(l-x)/s,A=(u-b)/i,k=(-l-x)/s,$=(-u-b)/i,C=ac(1,0,w,A);let T=ac(w,A,k,$);a===0&&T>0&&(T-=qn),a===1&&T<0&&(T+=qn),f.centerX=_,f.centerY=v,f.ang1=C,f.ang2=T};function Fg(e,t,n,r,s,i,o,a=0,c=0,h=0){if(i===0||o===0)return;const l=Math.sin(a*qn/360),u=Math.cos(a*qn/360),f=u*(t-r)/2+l*(n-s)/2,d=-l*(t-r)/2+u*(n-s)/2;if(f===0&&d===0)return;i=Math.abs(i),o=Math.abs(o);const p=Math.pow(f,2)/Math.pow(i,2)+Math.pow(d,2)/Math.pow(o,2);p>1&&(i*=Math.sqrt(p),o*=Math.sqrt(p)),Bg(t,n,r,s,i,o,c,h,l,u,f,d,ai);let{ang1:m,ang2:g}=ai;const{centerX:y,centerY:x}=ai;let b=Math.abs(g)/(qn/4);Math.abs(1-b)<1e-7&&(b=1);const _=Math.max(Math.ceil(b),1);g/=_;let v=e[e.length-2],w=e[e.length-1];const A={x:0,y:0};for(let k=0;k<_;k++){const $=Og(m,g),{x:C,y:T}=ci($[0],i,o,u,l,y,x,A),{x:O,y:F}=ci($[1],i,o,u,l,y,x,A),{x:B,y:W}=ci($[2],i,o,u,l,y,x,A);ou(e,v,w,C,T,O,F,B,W),v=B,w=W,m+=g}}function Dg(e,t,n){const r=(o,a)=>{const c=a.x-o.x,h=a.y-o.y,l=Math.sqrt(c*c+h*h),u=c/l,f=h/l;return{len:l,nx:u,ny:f}},s=(o,a)=>{o===0?e.moveTo(a.x,a.y):e.lineTo(a.x,a.y)};let i=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],c=a.radius??n;if(c<=0){s(o,a),i=a;continue}const h=t[(o+1)%t.length],l=r(a,i),u=r(a,h);if(l.len<1e-4||u.len<1e-4){s(o,a),i=a;continue}let f=Math.asin(l.nx*u.ny-l.ny*u.nx),d=1,p=!1;l.nx*u.nx-l.ny*-u.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,d=-1,p=!0):f>0&&(d=-1,p=!0);const m=f/2;let g,y=Math.abs(Math.cos(m)*c/Math.sin(m));y>Math.min(l.len/2,u.len/2)?(y=Math.min(l.len/2,u.len/2),g=Math.abs(y*Math.sin(m)/Math.cos(m))):g=c;const x=a.x+u.nx*y+-u.ny*g*d,b=a.y+u.ny*y+u.nx*g*d,_=Math.atan2(l.ny,l.nx)+Math.PI/2*d,v=Math.atan2(u.ny,u.nx)-Math.PI/2*d;o===0&&e.moveTo(x+Math.cos(_)*g,b+Math.sin(_)*g),e.arc(x,b,g,_,v,p),i=a}}function Lg(e,t,n,r){const s=(a,c)=>Math.sqrt((a.x-c.x)**2+(a.y-c.y)**2),i=(a,c,h)=>({x:a.x+(c.x-a.x)*h,y:a.y+(c.y-a.y)*h}),o=t.length;for(let a=0;a<o;a++){const c=t[(a+1)%o],h=c.radius??n;if(h<=0){a===0?e.moveTo(c.x,c.y):e.lineTo(c.x,c.y);continue}const l=t[a],u=t[(a+2)%o],f=s(l,c);let d;if(f<1e-4)d=c;else{const g=Math.min(f/2,h);d=i(c,l,g/f)}const p=s(u,c);let m;if(p<1e-4)m=c;else{const g=Math.min(p/2,h);m=i(c,u,g/p)}a===0?e.moveTo(d.x,d.y):e.lineTo(d.x,d.y),e.quadraticCurveTo(c.x,c.y,m.x,m.y,r)}}const Gg=new at;class jg{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Dt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,n){return this.startPoly(t,n),this}lineTo(t,n){this._ensurePoly();const r=this._currentPoly.points,s=r[r.length-2],i=r[r.length-1];return(s!==t||i!==n)&&r.push(t,n),this}arc(t,n,r,s,i,o){this._ensurePoly(!1);const a=this._currentPoly.points;return au(a,t,n,r,s,i,o),this}arcTo(t,n,r,s,i){this._ensurePoly();const o=this._currentPoly.points;return Rg(o,t,n,r,s,i),this}arcToSvg(t,n,r,s,i,o,a){const c=this._currentPoly.points;return Fg(c,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,n,r,s,i),this}bezierCurveTo(t,n,r,s,i,o,a){this._ensurePoly();const c=this._currentPoly;return ou(this._currentPoly.points,c.lastX,c.lastY,t,n,r,s,i,o,a),this}quadraticCurveTo(t,n,r,s,i){this._ensurePoly();const o=this._currentPoly;return zg(this._currentPoly.points,o.lastX,o.lastY,t,n,r,s,i),this}closePath(){return this.endPoly(!0),this}addPath(t,n){this.endPoly(),n&&!n.isIdentity()&&(t=t.clone(!0),t.transform(n));const r=this.shapePrimitives,s=r.length;for(let i=0;i<t.instructions.length;i++){const o=t.instructions[i];this[o.action](...o.data)}if(t.checkForHoles&&r.length-s>1){let i=null;for(let o=s;o<r.length;o++){const a=r[o];if(a.shape.type==="polygon"){const c=a.shape,h=i?.shape;h&&h.containsPolygon(c)?(i.holes||(i.holes=[]),i.holes.push(a),r.copyWithin(o,o+1),r.length--,o--):i=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,n,r,s,i){return this.drawShape(new at(t,n,r,s),i),this}circle(t,n,r,s){return this.drawShape(new $o(t,n,r),s),this}poly(t,n,r){const s=new Yn(t);return s.closePath=n,this.drawShape(s,r),this}regularPoly(t,n,r,s,i=0,o){s=Math.max(s|0,3);const a=-1*Math.PI/2+i,c=Math.PI*2/s,h=[];for(let l=0;l<s;l++){const u=a-l*c;h.push(t+r*Math.cos(u),n+r*Math.sin(u))}return this.poly(h,!0,o),this}roundPoly(t,n,r,s,i,o=0,a){if(s=Math.max(s|0,3),i<=0)return this.regularPoly(t,n,r,s,o);const c=r*Math.sin(Math.PI/s)-.001;i=Math.min(i,c);const h=-1*Math.PI/2+o,l=Math.PI*2/s,u=(s-2)*Math.PI/s/2;for(let f=0;f<s;f++){const d=f*l+h,p=t+r*Math.cos(d),m=n+r*Math.sin(d),g=d+Math.PI+u,y=d-Math.PI-u,x=p+i*Math.cos(g),b=m+i*Math.sin(g),_=p+i*Math.cos(y),v=m+i*Math.sin(y);f===0?this.moveTo(x,b):this.lineTo(x,b),this.quadraticCurveTo(p,m,_,v,a)}return this.closePath()}roundShape(t,n,r=!1,s){return t.length<3?this:(r?Lg(this,t,n,s):Dg(this,t,n),this.closePath())}filletRect(t,n,r,s,i){if(i===0)return this.rect(t,n,r,s);const o=Math.min(r,s)/2,a=Math.min(o,Math.max(-o,i)),c=t+r,h=n+s,l=a<0?-a:0,u=Math.abs(a);return this.moveTo(t,n+u).arcTo(t+l,n+l,t+u,n,u).lineTo(c-u,n).arcTo(c-l,n+l,c,n+u,u).lineTo(c,h-u).arcTo(c-l,h-l,t+r-u,h,u).lineTo(t+u,h).arcTo(t+l,h-l,t,h-u,u).closePath()}chamferRect(t,n,r,s,i,o){if(i<=0)return this.rect(t,n,r,s);const a=Math.min(i,Math.min(r,s)/2),c=t+r,h=n+s,l=[t+a,n,c-a,n,c,n+a,c,h-a,c-a,h,t+a,h,t,h-a,t,n+a];for(let u=l.length-1;u>=2;u-=2)l[u]===l[u-2]&&l[u-1]===l[u-3]&&l.splice(u-1,2);return this.poly(l,!0,o)}ellipse(t,n,r,s,i){return this.drawShape(new Ro(t,n,r,s),i),this}roundRect(t,n,r,s,i,o){return this.drawShape(new Oo(t,n,r,s,i),o),this}drawShape(t,n){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:n}),this}startPoly(t,n){let r=this._currentPoly;return r&&this.endPoly(),r=new Yn,r.points.push(t,n),this._currentPoly=r,this}endPoly(t=!1){const n=this._currentPoly;return n&&n.points.length>2&&(n.closePath=t,this.shapePrimitives.push({shape:n})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new Yn,t)){const n=this.shapePrimitives[this.shapePrimitives.length-1];if(n){let r=n.shape.x,s=n.shape.y;if(n.transform&&!n.transform.isIdentity()){const i=n.transform,o=r;r=i.a*r+i.c*s+i.tx,s=i.b*o+i.d*s+i.ty}this._currentPoly.points.push(r,s)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let n=0;n<t.instructions.length;n++){const r=t.instructions[n];this[r.action](...r.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const n=this.shapePrimitives;for(let r=0;r<n.length;r++){const s=n[r],i=s.shape.getBounds(Gg);s.transform?t.addRect(i,s.transform):t.addRect(i)}return t}}class se{constructor(t,n=!1){this.instructions=[],this.uid=it("graphicsPath"),this._dirty=!0,this.checkForHoles=n,typeof t=="string"?hm(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new jg(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,n){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,n]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,n,r,s,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(At.shared);let c=0,h=0;if(!o||o.action!=="bezierCurveTo")c=a.x,h=a.y;else{c=o.data[2],h=o.data[3];const l=a.x,u=a.y;c=l+(l-c),h=u+(u-h)}return this.instructions.push({action:"bezierCurveTo",data:[c,h,t,n,r,s,i]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,n,r){const s=this.instructions[this.instructions.length-1],i=this.getLastPoint(At.shared);let o=0,a=0;if(!s||s.action!=="quadraticCurveTo")o=i.x,a=i.y;else{o=s.data[0],a=s.data[1];const c=i.x,h=i.y;o=c+(c-o),a=h+(h-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,n,r]}),this._dirty=!0,this}rect(t,n,r,s,i){return this.instructions.push({action:"rect",data:[t,n,r,s,i]}),this._dirty=!0,this}circle(t,n,r,s){return this.instructions.push({action:"circle",data:[t,n,r,s]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,n,r,s,i,o,a){i||(i=s/2);const c=-1*Math.PI/2+o,h=r*2,l=Math.PI*2/h,u=[];for(let f=0;f<h;f++){const d=f%2?i:s,p=f*l+c;u.push(t+d*Math.cos(p),n+d*Math.sin(p))}return this.poly(u,!0,a),this}clone(t=!1){const n=new se;if(n.checkForHoles=this.checkForHoles,!t)n.instructions=this.instructions.slice();else for(let r=0;r<this.instructions.length;r++){const s=this.instructions[r];n.instructions.push({action:s.action,data:s.data.slice()})}return n}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const n=t.a,r=t.b,s=t.c,i=t.d,o=t.tx,a=t.ty;let c=0,h=0,l=0,u=0,f=0,d=0,p=0,m=0;for(let g=0;g<this.instructions.length;g++){const y=this.instructions[g],x=y.data;switch(y.action){case"moveTo":case"lineTo":c=x[0],h=x[1],x[0]=n*c+s*h+o,x[1]=r*c+i*h+a;break;case"bezierCurveTo":l=x[0],u=x[1],f=x[2],d=x[3],c=x[4],h=x[5],x[0]=n*l+s*u+o,x[1]=r*l+i*u+a,x[2]=n*f+s*d+o,x[3]=r*f+i*d+a,x[4]=n*c+s*h+o,x[5]=r*c+i*h+a;break;case"quadraticCurveTo":l=x[0],u=x[1],c=x[2],h=x[3],x[0]=n*l+s*u+o,x[1]=r*l+i*u+a,x[2]=n*c+s*h+o,x[3]=r*c+i*h+a;break;case"arcToSvg":c=x[5],h=x[6],p=x[0],m=x[1],x[0]=n*p+s*m,x[1]=r*p+i*m,x[5]=n*c+s*h+o,x[6]=r*c+i*h+a;break;case"circle":x[4]=zn(x[3],t);break;case"rect":x[4]=zn(x[4],t);break;case"ellipse":x[8]=zn(x[8],t);break;case"roundRect":x[5]=zn(x[5],t);break;case"addPath":x[0].transform(t);break;case"poly":x[2]=zn(x[2],t);break;default:Q("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let n=this.instructions.length-1,r=this.instructions[n];if(!r)return t.x=0,t.y=0,t;for(;r.action==="closePath";){if(n--,n<0)return t.x=0,t.y=0,t;r=this.instructions[n]}switch(r.action){case"moveTo":case"lineTo":t.x=r.data[0],t.y=r.data[1];break;case"quadraticCurveTo":t.x=r.data[2],t.y=r.data[3];break;case"bezierCurveTo":t.x=r.data[4],t.y=r.data[5];break;case"arc":case"arcToSvg":t.x=r.data[5],t.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(t);break}return t}}function zn(e,t){return e?e.prepend(t):t.clone()}function rt(e,t,n){const r=e.getAttribute(t);return r?Number(r):n}function Ng(e,t){const n=e.querySelectorAll("defs");for(let r=0;r<n.length;r++){const s=n[r];for(let i=0;i<s.children.length;i++){const o=s.children[i];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=Ug(o);break;case"radialgradient":t.defs[o.id]=Wg();break}}}}function Ug(e){const t=rt(e,"x1",0),n=rt(e,"y1",0),r=rt(e,"x2",1),s=rt(e,"y2",0),i=e.getAttribute("gradientUnits")||"objectBoundingBox",o=new ie(t,n,r,s,i==="objectBoundingBox"?"local":"global");for(let a=0;a<e.children.length;a++){const c=e.children[a],h=rt(c,"offset",0),l=ut.shared.setValue(c.getAttribute("stop-color")).toNumber();o.addColorStop(h,l)}return o}function Wg(e){return Q("[SVG Parser] Radial gradients are not yet supported"),new ie(0,0,1,0)}function cc(e){const t=e.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const hc={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function cu(e,t){const n=e.getAttribute("style"),r={},s={},i={strokeStyle:r,fillStyle:s,useFill:!1,useStroke:!1};for(const o in hc){const a=e.getAttribute(o);a&&lc(t,i,o,a.trim())}if(n){const o=n.split(";");for(let a=0;a<o.length;a++){const c=o[a].trim(),[h,l]=c.split(":");hc[h]&&lc(t,i,h,l.trim())}}return{strokeStyle:i.useStroke?r:null,fillStyle:i.useFill?s:null,useFill:i.useFill,useStroke:i.useStroke}}function lc(e,t,n,r){switch(n){case"stroke":if(r!=="none"){if(r.startsWith("url(")){const s=cc(r);t.strokeStyle.fill=e.defs[s]}else t.strokeStyle.color=ut.shared.setValue(r).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(r);break;case"fill":if(r!=="none"){if(r.startsWith("url(")){const s=cc(r);t.fillStyle.fill=e.defs[s]}else t.fillStyle.color=ut.shared.setValue(r).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(r);break;case"stroke-opacity":t.strokeStyle.alpha=Number(r);break;case"opacity":t.fillStyle.alpha=Number(r),t.strokeStyle.alpha=Number(r);break}}function Vg(e){if(e.length<=2)return!0;const t=e.map(a=>a.area).sort((a,c)=>c-a),[n,r]=t,s=t[t.length-1],i=n/r,o=r/s;return!(i>3&&o<2)}function Zg(e){return e.split(/(?=[Mm])/).filter(r=>r.trim().length>0)}function Hg(e){const t=e.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!t||t.length<4)return 0;const n=t.map(Number),r=[],s=[];for(let l=0;l<n.length;l+=2)l+1<n.length&&(r.push(n[l]),s.push(n[l+1]));if(r.length===0||s.length===0)return 0;const i=Math.min(...r),o=Math.max(...r),a=Math.min(...s),c=Math.max(...s);return(o-i)*(c-a)}function uc(e,t){const n=new se(e,!1);for(const r of n.instructions)t.instructions.push(r)}function Yg(e,t){if(typeof e=="string"){const o=document.createElement("div");o.innerHTML=e.trim(),e=o.querySelector("svg")}const n={context:t,defs:{},path:new se};Ng(e,n);const r=e.children,{fillStyle:s,strokeStyle:i}=cu(e,n);for(let o=0;o<r.length;o++){const a=r[o];a.nodeName.toLowerCase()!=="defs"&&hu(a,n,s,i)}return t}function hu(e,t,n,r){const s=e.children,{fillStyle:i,strokeStyle:o}=cu(e,t);i&&n?n={...n,...i}:i&&(n=i),o&&r?r={...r,...o}:o&&(r=o);const a=!n&&!r;a&&(n={color:0});let c,h,l,u,f,d,p,m,g,y,x,b,_,v,w,A,k;switch(e.nodeName.toLowerCase()){case"path":{v=e.getAttribute("d");const $=e.getAttribute("fill-rule"),C=Zg(v),T=$==="evenodd",O=C.length>1;if(T&&O){const B=C.map(P=>({path:P,area:Hg(P)}));if(B.sort((P,M)=>M.area-P.area),C.length>3||!Vg(B))for(let P=0;P<B.length;P++){const M=B[P],j=P===0;t.context.beginPath();const I=new se(void 0,!0);uc(M.path,I),t.context.path(I),j?(n&&t.context.fill(n),r&&t.context.stroke(r)):t.context.cut()}else for(let P=0;P<B.length;P++){const M=B[P],j=P%2===1;t.context.beginPath();const I=new se(void 0,!0);uc(M.path,I),t.context.path(I),j?t.context.cut():(n&&t.context.fill(n),r&&t.context.stroke(r))}}else{const B=$?$==="evenodd":!0;w=new se(v,B),t.context.path(w),n&&t.context.fill(n),r&&t.context.stroke(r)}break}case"circle":p=rt(e,"cx",0),m=rt(e,"cy",0),g=rt(e,"r",0),t.context.ellipse(p,m,g,g),n&&t.context.fill(n),r&&t.context.stroke(r);break;case"rect":c=rt(e,"x",0),h=rt(e,"y",0),A=rt(e,"width",0),k=rt(e,"height",0),y=rt(e,"rx",0),x=rt(e,"ry",0),y||x?t.context.roundRect(c,h,A,k,y||x):t.context.rect(c,h,A,k),n&&t.context.fill(n),r&&t.context.stroke(r);break;case"ellipse":p=rt(e,"cx",0),m=rt(e,"cy",0),y=rt(e,"rx",0),x=rt(e,"ry",0),t.context.beginPath(),t.context.ellipse(p,m,y,x),n&&t.context.fill(n),r&&t.context.stroke(r);break;case"line":l=rt(e,"x1",0),u=rt(e,"y1",0),f=rt(e,"x2",0),d=rt(e,"y2",0),t.context.beginPath(),t.context.moveTo(l,u),t.context.lineTo(f,d),r&&t.context.stroke(r);break;case"polygon":_=e.getAttribute("points"),b=_.match(/-?\d+/g).map($=>parseInt($,10)),t.context.poly(b,!0),n&&t.context.fill(n),r&&t.context.stroke(r);break;case"polyline":_=e.getAttribute("points"),b=_.match(/-?\d+/g).map($=>parseInt($,10)),t.context.poly(b,!1),r&&t.context.stroke(r);break;case"g":case"svg":break;default:{Q(`[SVG parser] <${e.nodeName}> elements unsupported`);break}}a&&(n=null);for(let $=0;$<s.length;$++)hu(s[$],t,n,r)}const dc={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class bs{constructor(t,n){this.uid=it("fillPattern"),this._tick=0,this.transform=new D,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),n&&(t.source.style.addressModeU=dc[n].addressModeU,t.source.style.addressModeV=dc[n].addressModeV)}setTransform(t){const n=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/n.frame.width,1/n.frame.height),this._tick++}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture=t,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}function Xg(e){return ut.isColorLike(e)}function fc(e){return e instanceof bs}function pc(e){return e instanceof ie}function qg(e){return e instanceof U}function Kg(e,t,n){const r=ut.shared.setValue(t??0);return e.color=r.toNumber(),e.alpha=r.alpha===1?n.alpha:r.alpha,e.texture=U.WHITE,{...n,...e}}function Jg(e,t,n){return e.texture=t,{...n,...e}}function mc(e,t,n){return e.fill=t,e.color=16777215,e.texture=t.texture,e.matrix=t.transform,{...n,...e}}function gc(e,t,n){return t.buildGradient(),e.fill=t,e.color=16777215,e.texture=t.texture,e.matrix=t.transform,e.textureSpace=t.textureSpace,{...n,...e}}function Qg(e,t){const n={...t,...e},r=ut.shared.setValue(n.color);return n.alpha*=r.alpha,n.color=r.toNumber(),n}function $e(e,t){if(e==null)return null;const n={},r=e;return Xg(e)?Kg(n,e,t):qg(e)?Jg(n,e,t):fc(e)?mc(n,e,t):pc(e)?gc(n,e,t):r.fill&&fc(r.fill)?mc(r,r.fill,t):r.fill&&pc(r.fill)?gc(r,r.fill,t):Qg(r,t)}function ns(e,t){const{width:n,alignment:r,miterLimit:s,cap:i,join:o,pixelLine:a,...c}=t,h=$e(e,c);return h?{width:n,alignment:r,miterLimit:s,cap:i,join:o,pixelLine:a,...h}:null}const ty=new At,yc=new D,Go=class Yt extends qt{constructor(){super(...arguments),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=it("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this.destroyed=!1,this._activePath=new se,this._transform=new D,this._fillStyle={...Yt.defaultFillStyle},this._strokeStyle={...Yt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Dt,this._boundsDirty=!0}clone(){const t=new Yt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=$e(t,Yt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=ns(t,Yt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=$e(t,Yt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=$e(t,Yt.defaultStrokeStyle),this}texture(t,n,r,s,i,o){return this.instructions.push({action:"texture",data:{image:t,dx:r||0,dy:s||0,dw:i||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:n||n===0?ut.shared.setValue(n).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new se,this}fill(t,n){let r;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s?.action==="stroke"?r=s.data.path:r=this._activePath.clone(),r?(t!=null&&(n!==void 0&&typeof t=="number"&&(G(st,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:n}),this._fillStyle=$e(t,Yt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:n}=this._activePath.getLastPoint(At.shared);this._activePath.clear(),this._activePath.moveTo(t,n)}stroke(t){let n;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r?.action==="fill"?n=r.data.path:n=this._activePath.clone(),n?(t!=null&&(this._strokeStyle=ns(t,Yt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const n=this.instructions[this.instructions.length-1-t],r=this._activePath.clone();if(n&&(n.action==="stroke"||n.action==="fill"))if(n.data.hole)n.data.hole.addPath(r);else{n.data.hole=r;break}}return this._initNextPathLocation(),this}arc(t,n,r,s,i,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*n+a.tx,a.b*t+a.d*n+a.ty,r,s,i,o),this}arcTo(t,n,r,s,i){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*n+o.tx,o.b*t+o.d*n+o.ty,o.a*r+o.c*s+o.tx,o.b*r+o.d*s+o.ty,i),this}arcToSvg(t,n,r,s,i,o,a){this._tick++;const c=this._transform;return this._activePath.arcToSvg(t,n,r,s,i,c.a*o+c.c*a+c.tx,c.b*o+c.d*a+c.ty),this}bezierCurveTo(t,n,r,s,i,o,a){this._tick++;const c=this._transform;return this._activePath.bezierCurveTo(c.a*t+c.c*n+c.tx,c.b*t+c.d*n+c.ty,c.a*r+c.c*s+c.tx,c.b*r+c.d*s+c.ty,c.a*i+c.c*o+c.tx,c.b*i+c.d*o+c.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,n,r,s){return this._tick++,this._activePath.ellipse(t,n,r,s,this._transform.clone()),this}circle(t,n,r){return this._tick++,this._activePath.circle(t,n,r,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,n){this._tick++;const r=this._transform;return this._activePath.lineTo(r.a*t+r.c*n+r.tx,r.b*t+r.d*n+r.ty),this}moveTo(t,n){this._tick++;const r=this._transform,s=this._activePath.instructions,i=r.a*t+r.c*n+r.tx,o=r.b*t+r.d*n+r.ty;return s.length===1&&s[0].action==="moveTo"?(s[0].data[0]=i,s[0].data[1]=o,this):(this._activePath.moveTo(i,o),this)}quadraticCurveTo(t,n,r,s,i){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*n+o.tx,o.b*t+o.d*n+o.ty,o.a*r+o.c*s+o.tx,o.b*r+o.d*s+o.ty,i),this}rect(t,n,r,s){return this._tick++,this._activePath.rect(t,n,r,s,this._transform.clone()),this}roundRect(t,n,r,s,i){return this._tick++,this._activePath.roundRect(t,n,r,s,i,this._transform.clone()),this}poly(t,n){return this._tick++,this._activePath.poly(t,n,this._transform.clone()),this}regularPoly(t,n,r,s,i=0,o){return this._tick++,this._activePath.regularPoly(t,n,r,s,i,o),this}roundPoly(t,n,r,s,i,o){return this._tick++,this._activePath.roundPoly(t,n,r,s,i,o),this}roundShape(t,n,r,s){return this._tick++,this._activePath.roundShape(t,n,r,s),this}filletRect(t,n,r,s,i){return this._tick++,this._activePath.filletRect(t,n,r,s,i),this}chamferRect(t,n,r,s,i,o){return this._tick++,this._activePath.chamferRect(t,n,r,s,i,o),this}star(t,n,r,s,i=0,o=0){return this._tick++,this._activePath.star(t,n,r,s,i,o,this._transform.clone()),this}svg(t){return this._tick++,Yg(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,n=t){return this._transform.scale(t,n),this}setTransform(t,n,r,s,i,o){return t instanceof D?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,n,r,s,i,o),this)}transform(t,n,r,s,i,o){return t instanceof D?(this._transform.append(t),this):(yc.set(t,n,r,s,i,o),this._transform.append(yc),this)}translate(t,n=t){return this._transform.translate(t,n),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const t=this._bounds;t.clear();for(let n=0;n<this.instructions.length;n++){const r=this.instructions[n],s=r.action;if(s==="fill"){const i=r.data;t.addBounds(i.path.bounds)}else if(s==="texture"){const i=r.data;t.addFrame(i.dx,i.dy,i.dx+i.dw,i.dy+i.dh,i.transform)}if(s==="stroke"){const i=r.data,o=i.style.alignment,a=i.style.width*(1-o),c=i.path.bounds;t.addFrame(c.minX-a,c.minY-a,c.maxX+a,c.maxY+a)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;const n=this.instructions;let r=!1;for(let s=0;s<n.length;s++){const i=n[s],o=i.data,a=o.path;if(!i.action||!a)continue;const c=o.style,h=a.shapePath.shapePrimitives;for(let l=0;l<h.length;l++){const u=h[l].shape;if(!c||!u)continue;const f=h[l].transform,d=f?f.applyInverse(t,ty):t;if(i.action==="fill")r=u.contains(d.x,d.y);else{const m=c;r=u.strokeContains(d.x,d.y,m.width,m.alignment)}const p=o.hole;if(p){const m=p.shapePath?.shapePrimitives;if(m)for(let g=0;g<m.length;g++)m[g].shape.contains(d.x,d.y)&&(r=!1)}if(r)return!0}}return r}unload(){this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null)}destroy(t=!1){if(this.destroyed)return;if(this.destroyed=!0,this._stateStack.length=0,this._transform=null,this.unload(),this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t?.texture){const r=typeof t=="boolean"?t:t?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(r)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(r))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Go.defaultFillStyle={color:16777215,alpha:1,texture:U.WHITE,matrix:null,fill:null,textureSpace:"local"};Go.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:U.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Rt=Go;function jo(e,t=1){const n=gn.RETINA_PREFIX?.exec(e);return n?parseFloat(n[1]):t}function No(e,t,n){e.label=n,e._sourceOrigin=n;const r=new U({source:e,label:n}),s=()=>{delete t.promiseCache[n],gt.has(n)&&gt.remove(n)};return r.source.once("destroy",()=>{t.promiseCache[n]&&(Q("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),s())}),r.once("destroy",()=>{e.destroyed||(Q("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),r}const ey=".svg",ny="image/svg+xml",ry={extension:{type:E.LoadParser,priority:_e.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(e){return _n(e,ny)||bn(e,ey)},async load(e,t,n){return t.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?iy(e):sy(e,t,n,this.config.crossOrigin)},unload(e){e.destroy(!0)}};async function sy(e,t,n,r){const s=await X.get().fetch(e),i=X.get().createImage();i.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await s.text())}`,i.crossOrigin=r,await i.decode();const o=t.data?.width??i.width,a=t.data?.height??i.height,c=t.data?.resolution||jo(e),h=Math.ceil(o*c),l=Math.ceil(a*c),u=X.get().createCanvas(h,l),f=u.getContext("2d");f.imageSmoothingEnabled=!0,f.imageSmoothingQuality="high",f.drawImage(i,0,0,o*c,a*c);const{parseAsGraphicsContext:d,...p}=t.data??{},m=new ln({resource:u,alphaMode:"premultiply-alpha-on-upload",resolution:c,...p});return No(m,n,e)}async function iy(e){const n=await(await X.get().fetch(e)).text(),r=new Rt;return r.svg(n),r}const oy=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function") return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let tn=null,ji=class{constructor(){tn||(tn=URL.createObjectURL(new Blob([oy],{type:"application/javascript"}))),this.worker=new Worker(tn)}};ji.revokeObjectURL=function(){tn&&(URL.revokeObjectURL(tn),tn=null)};const ay=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let en=null;class lu{constructor(){en||(en=URL.createObjectURL(new Blob([ay],{type:"application/javascript"}))),this.worker=new Worker(en)}}lu.revokeObjectURL=function(){en&&(URL.revokeObjectURL(en),en=null)};let _c=0,hi;class cy{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:n}=new ji;n.addEventListener("message",r=>{n.terminate(),ji.revokeObjectURL(),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,n){return this._run("loadImageBitmap",[t,n?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){hi===void 0&&(hi=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<hi&&(this._createdWorkers++,t=new lu().worker,t.addEventListener("message",n=>{this._complete(n.data),this._returnWorker(n.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){this._resolveHash[t.uuid]&&(t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),delete this._resolveHash[t.uuid])}async _run(t,n){await this._initWorkers();const r=new Promise((s,i)=>{this._queue.push({id:t,arguments:n,resolve:s,reject:i})});return this._next(),r}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const n=this._queue.pop(),r=n.id;this._resolveHash[_c]={resolve:n.resolve,reject:n.reject},t.postMessage({data:n.arguments,uuid:_c++,id:r})}reset(){this._workerPool.forEach(t=>t.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:t})=>{t?.(new Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}const bc=new cy,hy=[".jpeg",".jpg",".png",".webp",".avif"],ly=["image/jpeg","image/png","image/webp","image/avif"];async function uy(e,t){const n=await X.get().fetch(e);if(!n.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${n.status} ${n.statusText}`);const r=await n.blob();return t?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}const uu={name:"loadTextures",id:"texture",extension:{type:E.LoadParser,priority:_e.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return _n(e,ly)||bn(e,hy)},async load(e,t,n){let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await bc.isImageBitmapSupported()?r=await bc.loadImageBitmap(e,t):r=await uy(e,t):r=await new Promise((i,o)=>{r=X.get().createImage(),r.crossOrigin=this.config.crossOrigin,r.src=e,r.complete?i(r):(r.onload=()=>{i(r)},r.onerror=o)});const s=new ln({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:t.data?.resolution||jo(e),...t.data});return No(s,n,e)},unload(e){e.destroy(!0)}},dy=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let li,ui;function fy(e,t,n){n===void 0&&!t.startsWith("data:")?e.crossOrigin=my(t):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")}function py(e){return new Promise((t,n)=>{e.addEventListener("canplaythrough",r),e.addEventListener("error",s),e.load();function r(){i(),t()}function s(o){i(),n(o)}function i(){e.removeEventListener("canplaythrough",r),e.removeEventListener("error",s)}})}function my(e,t=globalThis.location){if(e.startsWith("data:"))return"";t||(t=globalThis.location);const n=new URL(e,document.baseURI);return n.hostname!==t.hostname||n.port!==t.port||n.protocol!==t.protocol?"anonymous":""}function gy(){const e=[],t=[];for(const n of dy){const r=Hn.MIME_TYPES[n.substring(1)]||`video/${n.substring(1)}`;ys(r)&&(e.push(n),t.includes(r)||t.push(r))}return{validVideoExtensions:e,validVideoMime:t}}const yy={name:"loadVideo",id:"video",extension:{type:E.LoadParser,name:"loadVideo"},test(e){if(!li||!ui){const{validVideoExtensions:r,validVideoMime:s}=gy();li=r,ui=s}const t=_n(e,ui),n=bn(e,li);return t||n},async load(e,t,n){const r={...Hn.defaultOptions,resolution:t.data?.resolution||jo(e),alphaMode:t.data?.alphaMode||await bl(),...t.data},s=document.createElement("video"),i={preload:r.autoLoad!==!1?"auto":void 0,"webkit-playsinline":r.playsinline!==!1?"":void 0,playsinline:r.playsinline!==!1?"":void 0,muted:r.muted===!0?"":void 0,loop:r.loop===!0?"":void 0,autoplay:r.autoPlay!==!1?"":void 0};Object.keys(i).forEach(c=>{const h=i[c];h!==void 0&&s.setAttribute(c,h)}),r.muted===!0&&(s.muted=!0),fy(s,e,r.crossorigin);const o=document.createElement("source");let a;if(r.mime)a=r.mime;else if(e.startsWith("data:"))a=e.slice(5,e.indexOf(";"));else if(!e.startsWith("blob:")){const c=e.split("?")[0].slice(e.lastIndexOf(".")+1).toLowerCase();a=Hn.MIME_TYPES[c]||`video/${c}`}return o.src=e,a&&(o.type=a),new Promise((c,h)=>{r.preload&&!r.autoPlay&&s.load(),s.addEventListener("canplay",l),s.addEventListener("error",u),o.addEventListener("error",u),s.appendChild(o);async function l(){const d=new Hn({...r,resource:s});f(),t.data.preload&&await py(s),c(No(d,n,e))}function u(d){f(),h(d)}function f(){s.removeEventListener("canplay",l),s.removeEventListener("error",u),o.removeEventListener("error",u)}})},unload(e){e.destroy(!0)}},du={extension:{type:E.ResolveParser,name:"resolveTexture"},test:uu.test,parse:e=>({resolution:parseFloat(gn.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e})},_y={extension:{type:E.ResolveParser,priority:-2,name:"resolveJson"},test:e=>gn.RETINA_PREFIX.test(e)&&e.endsWith(".json"),parse:du.parse};class by{constructor(){this._detections=[],this._initialized=!1,this.resolver=new gn,this.loader=new Vp,this.cache=gt,this._backgroundLoader=new Bp(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){Q("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let i=t.manifest;typeof i=="string"&&(i=await this.load(i)),this.resolver.addManifest(i)}const n=t.texturePreference?.resolution??1,r=typeof n=="number"?[n]:n,s=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:r}}),t.preferences&&this.setPreferences(t.preferences),t.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...t.loadOptions})}add(t){this.resolver.add(t)}async load(t,n){this._initialized||await this.init();const r=ts(t),s=Nt(t).map(a=>{if(typeof a!="string"){const c=this.resolver.getAlias(a);return c.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(c)?c[0]:c}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),i=this.resolver.resolve(s),o=await this._mapLoadToResolve(i,n);return r?o[s[0]]:o}addBundle(t,n){this.resolver.addBundle(t,n)}async loadBundle(t,n){this._initialized||await this.init();let r=!1;typeof t=="string"&&(r=!0,t=[t]);const s=this.resolver.resolveBundle(t),i={},o=Object.keys(s);let a=0;const c=[],h=()=>{n?.(c.reduce((u,f)=>u+f,0)/a)},l=o.map((u,f)=>{const d=s[u],p=Object.values(d),g=[...new Set(p.flat())].reduce((y,x)=>y+(x.progressSize||1),0);return c.push(0),a+=g,this._mapLoadToResolve(d,y=>{c[f]=y*g,h()}).then(y=>{i[u]=y})});return await Promise.all(l),r?i[t[0]]:i}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const n=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(n))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const n=this.resolver.resolveBundle(t);Object.values(n).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return gt.get(t);const n={};for(let r=0;r<t.length;r++)n[r]=gt.get(t[r]);return n}async _mapLoadToResolve(t,n){const r=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const s=await this.loader.load(r,n);this._backgroundLoader.active=!0;const i={};return r.forEach(o=>{const a=s[o.src],c=[o.src];o.alias&&c.push(...o.alias),c.forEach(h=>{i[h]=a}),gt.set(c,a)}),i}async unload(t){this._initialized||await this.init();const n=Nt(t).map(s=>typeof s!="string"?s.src:s),r=this.resolver.resolve(n);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=Nt(t);const n=this.resolver.resolveBundle(t),r=Object.keys(n).map(s=>this._unloadFromResolved(n[s]));await Promise.all(r)}async _unloadFromResolved(t){const n=Object.values(t);n.forEach(r=>{gt.remove(r.src)}),await this.loader.unload(n)}async _detectFormats(t){let n=[];t.preferredFormats&&(n=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const r of t.detections)t.skipDetections||await r.test()?n=await r.add(n):t.skipDetections||(n=await r.remove(n));return n=n.filter((r,s)=>n.indexOf(r)===s),n}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(n=>{n.config&&Object.keys(n.config).filter(r=>r in t).forEach(r=>{n.config[r]=t[r]})})}}const ge=new by;Y.handleByList(E.LoadParser,ge.loader.parsers).handleByList(E.ResolveParser,ge.resolver.parsers).handleByList(E.CacheParser,ge.cache.parsers).handleByList(E.DetectionParser,ge.detections);Y.add(Fp,Lp,Dp,Wp,jp,Np,Up,Yp,Kp,im,ry,uu,yy,Op,Rp,du,_y);const xc={loader:E.LoadParser,resolver:E.ResolveParser,cache:E.CacheParser,detection:E.DetectionParser};Y.handle(E.Asset,e=>{const t=e.ref;Object.entries(xc).filter(([n])=>!!t[n]).forEach(([n,r])=>Y.add(Object.assign(t[n],{extension:t[n].extension??r})))},e=>{const t=e.ref;Object.keys(xc).filter(n=>!!t[n]).forEach(n=>Y.remove(t[n]))});class xy{constructor(){this.isBatchable=!1}reset(){this.isBatchable=!1,this.context=null,this.graphicsData&&(this.graphicsData.destroy(),this.graphicsData=null)}destroy(){this.reset()}}class vy{constructor(){this.instructions=new Mo}init(){this.instructions.reset()}destroy(){this.instructions.destroy(),this.instructions=null}}const Uo=class Ni{constructor(t){this._renderer=t,this._managedContexts=new gr({renderer:t,type:"resource",name:"graphicsContext"})}init(t){Ni.defaultOptions.bezierSmoothness=t?.bezierSmoothness??Ni.defaultOptions.bezierSmoothness}getContextRenderData(t){return this.getGpuContext(t).graphicsData||this._initContextRenderData(t)}updateGpuContext(t){const n=t._gpuData,r=!!n[this._renderer.uid],s=n[this._renderer.uid]||this._initContext(t);return(t.dirty||!r)&&(r&&s.reset(),s.isBatchable=!1,t.dirty=!1),s}getGpuContext(t){return t._gpuData[this._renderer.uid]||this._initContext(t)}_initContextRenderData(t){const n=new vy,r=this.getGpuContext(t);return r.graphicsData=n,n.init(),n}_initContext(t){const n=new xy;return n.context=t,t._gpuData[this._renderer.uid]=n,this._managedContexts.add(t),n}destroy(){this._managedContexts.destroy(),this._renderer=null}};Uo.extension={type:[E.CanvasSystem],name:"graphicsContext"};Uo.defaultOptions={bezierSmoothness:.5};let wy=Uo;class fu{constructor(t,n){this.state=$l.for2d(),this.renderer=t,this._adaptor=n,this.renderer.runners.contextChange.add(this),this._managedGraphics=new gr({renderer:t,type:"renderable",priority:-1,name:"graphics"})}contextChange(){this._adaptor.contextChange(this.renderer)}validateRenderable(t){return!1}addRenderable(t,n){this._managedGraphics.add(t),this.renderer.renderPipes.batch.break(n),n.add(t)}updateRenderable(t){}execute(t){t.isRenderable&&this._adaptor.execute(this,t)}destroy(){this._managedGraphics.destroy(),this.renderer=null,this._adaptor.destroy(),this._adaptor=null}}fu.extension={type:[E.CanvasPipes],name:"graphics"};function Sy(e,t,n){const r=(e>>24&255)/255;t[n++]=(e&255)/255*r,t[n++]=(e>>8&255)/255*r,t[n++]=(e>>16&255)/255*r,t[n++]=r}class Ay{constructor(){this.batches=[],this.batched=!1}destroy(){this.batches.forEach(t=>{Mt.return(t)}),this.batches.length=0}}class pu{constructor(t,n){this.state=$l.for2d(),this.renderer=t,this._adaptor=n,this.renderer.runners.contextChange.add(this),this._managedGraphics=new gr({renderer:t,type:"renderable",priority:-1,name:"graphics"})}contextChange(){this._adaptor.contextChange(this.renderer)}validateRenderable(t){const n=t.context,r=!!t._gpuData,i=this.renderer.graphicsContext.updateGpuContext(n);return!!(i.isBatchable||r!==i.isBatchable)}addRenderable(t,n){const s=this.renderer.graphicsContext.updateGpuContext(t.context);t.didViewUpdate&&this._rebuild(t),s.isBatchable?this._addToBatcher(t,n):(this.renderer.renderPipes.batch.break(n),n.add(t))}updateRenderable(t){const r=this._getGpuDataForRenderable(t).batches;for(let s=0;s<r.length;s++){const i=r[s];i._batcher.updateElement(i)}}execute(t){if(!t.isRenderable)return;const n=this.renderer,r=t.context;if(!n.graphicsContext.getGpuContext(r).batches.length)return;const i=r.customShader||this._adaptor.shader;this.state.blendMode=t.groupBlendMode;const o=i.resources.localUniforms.uniforms;o.uTransformMatrix=t.groupTransform,o.uRound=n._roundPixels|t._roundPixels,Sy(t.groupColorAlpha,o.uColor,0),this._adaptor.execute(this,t)}_rebuild(t){const n=this._getGpuDataForRenderable(t),s=this.renderer.graphicsContext.updateGpuContext(t.context);n.destroy(),s.isBatchable&&this._updateBatchesForRenderable(t,n)}_addToBatcher(t,n){const r=this.renderer.renderPipes.batch,s=this._getGpuDataForRenderable(t).batches;for(let i=0;i<s.length;i++){const o=s[i];r.addToBatch(o,n)}}_getGpuDataForRenderable(t){return t._gpuData[this.renderer.uid]||this._initGpuDataForRenderable(t)}_initGpuDataForRenderable(t){const n=new Ay;return t._gpuData[this.renderer.uid]=n,this._managedGraphics.add(t),n}_updateBatchesForRenderable(t,n){const r=t.context,i=this.renderer.graphicsContext.getGpuContext(r),o=this.renderer._roundPixels|t._roundPixels;n.batches=i.batches.map(a=>{const c=Mt.get(Bo);return a.copyTo(c),c.renderable=t,c.roundPixels=o,c})}destroy(){this._managedGraphics.destroy(),this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null}}pu.extension={type:[E.WebGLPipes,E.WebGPUPipes],name:"graphics"};Y.add(fu);Y.add(pu);Y.add(wy);Y.add(Lo);class rs extends Eo{constructor(t){t instanceof Rt&&(t={context:t});const{context:n,roundPixels:r,...s}=t||{};super({label:"Graphics",...s}),this.renderPipeId="graphics",n?this.context=n:(this.context=this._ownedContext=new Rt,this.context.autoGarbageCollect=this.autoGarbageCollect),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=r??!1}set context(t){t!==this._context&&(this._context&&(this._context.off("update",this.onViewUpdate,this),this._context.off("unload",this.unload,this)),this._context=t,this._context.on("update",this.onViewUpdate,this),this._context.on("unload",this.unload,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||t?.context===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_onTouch(t){this._gcLastUsed=t,this._context._gcLastUsed=t}_callContextMethod(t,n){return this.context[t](...n),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new rs(this._context.clone()):(this._ownedContext=null,new rs(this._context))}lineStyle(t,n,r){G(st,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const s={};return t&&(s.width=t),n&&(s.color=n),r&&(s.alpha=r),this.context.strokeStyle=s,this}beginFill(t,n){G(st,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const r={};return t!==void 0&&(r.color=t),n!==void 0&&(r.alpha=n),this.context.fillStyle=r,this}endFill(){G(st,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==Rt.defaultStrokeStyle.width||t.color!==Rt.defaultStrokeStyle.color||t.alpha!==Rt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return G(st,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return G(st,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return G(st,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return G(st,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return G(st,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return G(st,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class Ty extends Eo{constructor(t,n){const{text:r,resolution:s,style:i,anchor:o,width:a,height:c,roundPixels:h,...l}=t;super({...l}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=n,this.text=r??"",this.style=i,this.resolution=s??null,this.allowChildren=!1,this._anchor=new yt({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=h??!1,a!==void 0&&(this.width=a),c!==void 0&&(this.height=c)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){t||(t={}),this._style?.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,n){typeof t=="object"?(n=t.height??t.width,t=t.width):n??(n=t),t!==void 0&&this._setWidth(t,this.bounds.width),n!==void 0&&this._setHeight(n,this.bounds.height)}containsPoint(t){const n=this.bounds.width,r=this.bounds.height,s=-n*this.anchor.x;let i=0;return t.x>=s&&t.x<=s+n&&(i=-r*this.anchor.y,t.y>=i&&t.y<=i+r)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t?.style)&&this._style.destroy(t),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}}function Cy(e,t){let n=e[0]??{};return(typeof n=="string"||e[1])&&(G(st,`use new ${t}({ text: "hi!", style }) instead`),n={text:n,style:e[1]}),n}class Py{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,n){const r=X.get().createCanvas();r.width=t,r.height=n;const s=r.getContext("2d");return{canvas:r,context:s}}getOptimalCanvasAndContext(t,n,r=1){t=Math.ceil(t*r-1e-6),n=Math.ceil(n*r-1e-6),t=on(t),n=on(n);const s=(t<<17)+(n<<1);this._canvasPool[s]||(this._canvasPool[s]=[]);let i=this._canvasPool[s].pop();return i||(i=this._createCanvasAndContext(t,n)),i}returnCanvasAndContext(t){const n=t.canvas,{width:r,height:s}=n,i=(r<<17)+(s<<1);t.context.resetTransform(),t.context.clearRect(0,0,r,s),this._canvasPool[i].push(t)}clear(){this._canvasPool={}}}const Ui=new Py;mr.register(Ui);let Ce=null,ee=null;function ky(e,t){Ce||(Ce=X.get().createCanvas(256,128),ee=Ce.getContext("2d",{willReadFrequently:!0}),ee.globalCompositeOperation="copy",ee.globalAlpha=1),(Ce.width<e||Ce.height<t)&&(Ce.width=on(e),Ce.height=on(t))}function vc(e,t,n){for(let r=0,s=4*n*t;r<t;++r,s+=4)if(e[s+3]!==0)return!1;return!0}function wc(e,t,n,r,s){const i=4*t;for(let o=r,a=r*i+4*n;o<=s;++o,a+=i)if(e[a+3]!==0)return!1;return!0}function My(...e){let t=e[0];t.canvas||(t={canvas:e[0],resolution:e[1]});const{canvas:n}=t,r=Math.min(t.resolution??1,1),s=t.width??n.width,i=t.height??n.height;let o=t.output;if(ky(s,i),!ee)throw new TypeError("Failed to get canvas 2D context");ee.drawImage(n,0,0,s,i,0,0,s*r,i*r);const c=ee.getImageData(0,0,s,i).data;let h=0,l=0,u=s-1,f=i-1;for(;l<i&&vc(c,s,l);)++l;if(l===i)return at.EMPTY;for(;vc(c,s,f);)--f;for(;wc(c,s,h,l,f);)++h;for(;wc(c,s,u,l,f);)--u;return++u,++f,ee.globalCompositeOperation="source-over",ee.strokeRect(h,l,u-h,f-l),ee.globalCompositeOperation="copy",o??(o=new at),o.set(h/r,l/r,(u-h)/r,(f-l)/r),o}class Ey{constructor(t=0,n=0,r=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=t,this.resetTtl=r,this.size=0,this.ttl=n}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(t){if(this.has(t)){const n=this.items[t];delete this.items[t],this.size--,n.prev!==null&&(n.prev.next=n.next),n.next!==null&&(n.next.prev=n.prev),this.first===n&&(this.first=n.next),this.last===n&&(this.last=n.prev)}return this}entries(t=this.keys()){const n=new Array(t.length);for(let r=0;r<t.length;r++){const s=t[r];n[r]=[s,this.get(s)]}return n}evict(t=!1){if(t||this.size>0){const n=this.first;delete this.items[n.key],--this.size===0?(this.first=null,this.last=null):(this.first=n.next,this.first.prev=null)}return this}expiresAt(t){let n;return this.has(t)&&(n=this.items[t].expiry),n}get(t){const n=this.items[t];if(n!==void 0){if(this.ttl>0&&n.expiry<=Date.now()){this.delete(t);return}return this.moveToEnd(n),n.value}}has(t){return t in this.items}moveToEnd(t){this.last!==t&&(t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),t.prev=this.last,t.next=null,this.last!==null&&(this.last.next=t),this.last=t,this.first===null&&(this.first=t))}keys(){const t=new Array(this.size);let n=this.first,r=0;for(;n!==null;)t[r++]=n.key,n=n.next;return t}setWithEvicted(t,n,r=this.resetTtl){let s=null;if(this.has(t))this.set(t,n,!0,r);else{this.max>0&&this.size===this.max&&(s={...this.first},this.evict(!0));let i=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:n};++this.size===1?this.first=i:this.last.next=i,this.last=i}return s}set(t,n,r=!1,s=this.resetTtl){let i=this.items[t];return r||i!==void 0?(i.value=n,r===!1&&s&&(i.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(i)):(this.max>0&&this.size===this.max&&this.evict(!0),i=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:n},++this.size===1?this.first=i:this.last.next=i,this.last=i),this}values(t=this.keys()){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=this.get(t[r]);return n}}function Iy(e=1e3,t=0,n=!1){if(isNaN(e)||e<0)throw new TypeError("Invalid max value");if(isNaN(t)||t<0)throw new TypeError("Invalid ttl value");if(typeof n!="boolean")throw new TypeError("Invalid resetTtl value");return new Ey(e,t,n)}function mu(e){return!!e.tagStyles&&Object.keys(e.tagStyles).length>0}function gu(e){return e.includes("<")}function zy(e,t){return e.clone().assign(t)}function $y(e,t){const n=[],r=t.tagStyles;if(!mu(t)||!gu(e))return n.push({text:e,style:t}),n;const s=[t],i=[];let o="",a=0;for(;a<e.length;){const c=e[a];if(c==="<"){const h=e.indexOf(">",a);if(h===-1){o+=c,a++;continue}const l=e.slice(a+1,h);if(l.startsWith("/")){const u=l.slice(1).trim();if(i.length>0&&i[i.length-1]===u){o.length>0&&(n.push({text:o,style:s[s.length-1]}),o=""),s.pop(),i.pop(),a=h+1;continue}else{o+=e.slice(a,h+1),a=h+1;continue}}else{const u=l.trim();if(r[u]){o.length>0&&(n.push({text:o,style:s[s.length-1]}),o="");const f=s[s.length-1],d=zy(f,r[u]);s.push(d),i.push(u),a=h+1;continue}else{o+=e.slice(a,h+1),a=h+1;continue}}}else o+=c,a++}return o.length>0&&n.push({text:o,style:s[s.length-1]}),n}const Ry=[10,13],Oy=new Set(Ry),By=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],Fy=new Set(By),Dy=/(\r\n|\r|\n)/,Ly=/(?:\r\n|\r|\n)/;function Wo(e){return typeof e!="string"?!1:Oy.has(e.charCodeAt(0))}function Ut(e,t){return typeof e!="string"?!1:Fy.has(e.charCodeAt(0))}function yu(e){return e==="normal"||e==="pre-line"}function _u(e){return e==="normal"}function Qt(e){if(typeof e!="string")return"";let t=e.length-1;for(;t>=0&&Ut(e[t]);)t--;return t<e.length-1?e.slice(0,t+1):e}function bu(e){const t=[],n=[];if(typeof e!="string")return t;for(let r=0;r<e.length;r++){const s=e[r],i=e[r+1];if(Ut(s)||Wo(s)){n.length>0&&(t.push(n.join("")),n.length=0),s==="\r"&&i===`
`?(t.push(`\r
`),r++):t.push(s);continue}n.push(s)}return n.length>0&&t.push(n.join("")),t}function xu(e,t,n,r){const s=n(e),i=[];for(let o=0;o<s.length;o++){let a=s[o],c=a,h=1;for(;s[o+h];){const l=s[o+h];if(!r(c,l,e,o,t))a+=l,c=l,h++;else break}o+=h-1,i.push(a)}return i}const Gy=/\r\n|\r|\n/g;function jy(e,t,n,r,s,i,o,a){const c=$y(e,t);if(_u(t.whiteSpace))for(let B=0;B<c.length;B++){const W=c[B];c[B]={text:W.text.replace(Gy," "),style:W.style}}const l=[];let u=[];for(const B of c){const W=B.text.split(Dy);for(let P=0;P<W.length;P++){const M=W[P];M===`\r
`||M==="\r"||M===`
`?(l.push(u),u=[]):M.length>0&&u.push({text:M,style:B.style})}}(u.length>0||l.length===0)&&l.push(u);const f=n?Ny(l,t,r,s,o,a):l,d=[],p=[],m=[],g=[],y=[];let x=0;const b=t._fontString,_=i(b);_.fontSize===0&&(_.fontSize=t.fontSize,_.ascent=t.fontSize);let v="",w=!!t.dropShadow;for(const B of f){let W=0,P=_.ascent,M=_.descent,j="";for(const H of B){const ct=H.style._fontString,ft=i(ct);ct!==v&&(r.font=ct,v=ct);const vt=s(H.text,H.style.letterSpacing,r);W+=vt,P=Math.max(P,ft.ascent),M=Math.max(M,ft.descent),j+=H.text,!w&&H.style.dropShadow&&(w=!0)}B.length===0&&(P=_.ascent,M=_.descent),d.push(W),p.push(P),m.push(M),y.push(j);const I=t.lineHeight||P+M;g.push(I+t.leading),x=Math.max(x,W)}const A=t._stroke?.width||0,C=(n&&t.align!=="left"&&t.align!=="justify"?Math.max(x,t.wordWrapWidth):x)+A+(t.dropShadow?t.dropShadow.distance:0);let T=0;for(let B=0;B<g.length;B++)T+=g[B];T=Math.max(T,g[0]+A);const O=T+(t.dropShadow?t.dropShadow.distance:0),F=t.lineHeight||_.fontSize;return{width:C,height:O,lines:y,lineWidths:d,lineHeight:F+t.leading,maxLineWidth:x,fontProperties:_,runsByLine:f,lineAscents:p,lineDescents:m,lineHeights:g,hasDropShadow:w}}function Ny(e,t,n,r,s,i){const{letterSpacing:o,whiteSpace:a,wordWrapWidth:c,breakWords:h}=t,l=yu(a),u=c+o,f={};let d="";const p=(g,y)=>{const x=`${g}|${y.styleKey}`;let b=f[x];if(b===void 0){const _=y._fontString;_!==d&&(n.font=_,d=_),b=r(g,y.letterSpacing,n)+y.letterSpacing,f[x]=b}return b},m=[];for(const g of e){const y=Uy(g),x=m.length,b=T=>{let O=0,F=T;do{const{token:B,style:W}=y[F];O+=p(B,W),F++}while(F<y.length&&y[F].continuesFromPrevious);return O},_=T=>{const O=[];let F=T;do O.push({token:y[F].token,style:y[F].style}),F++;while(F<y.length&&y[F].continuesFromPrevious);return O};let v=[],w=0,A=!l,k=null;const $=()=>{k&&k.text.length>0&&v.push(k),k=null},C=()=>{if($(),v.length>0){const T=v[v.length-1];T.text=Qt(T.text),T.text.length===0&&v.pop()}m.push(v),v=[],w=0,A=!1};for(let T=0;T<y.length;T++){const{token:O,style:F,continuesFromPrevious:B}=y[T],W=p(O,F);if(l){const j=Ut(O),I=k?.text[k.text.length-1]??v[v.length-1]?.text.slice(-1)??"",H=I?Ut(I):!1;if(j&&H)continue}const P=!B,M=P?b(T):W;if(M>u&&P)if(w>0&&C(),h){const j=_(T);for(let I=0;I<j.length;I++){const H=j[I].token,ct=j[I].style,ft=xu(H,h,i,s);for(const vt of ft){const Zt=p(vt,ct);Zt+w>u&&C(),!k||k.style!==ct?($(),k={text:vt,style:ct}):k.text+=vt,w+=Zt}}T+=j.length-1}else{const j=_(T);$(),m.push(j.map(I=>({text:I.token,style:I.style}))),A=!1,T+=j.length-1}else if(M+w>u&&P){if(Ut(O)){A=!1;continue}C(),k={text:O,style:F},w=W}else if(B&&!h)!k||k.style!==F?($(),k={text:O,style:F}):k.text+=O,w+=W;else{const j=Ut(O);if(w===0&&j&&!A)continue;!k||k.style!==F?($(),k={text:O,style:F}):k.text+=O,w+=W}}if($(),v.length>0){const T=v[v.length-1];T.text=Qt(T.text),T.text.length===0&&v.pop()}(v.length>0||m.length===x)&&m.push(v)}return m}function Uy(e){const t=[];let n=!1;for(const r of e){const s=bu(r.text);let i=!0;for(const o of s){const a=Ut(o)||Wo(o),c=i&&n&&!a;t.push({token:o,style:r.style,continuesFromPrevious:c}),n=!a,i=!1}}return t}const Wy={willReadFrequently:!0};function Sc(e,t,n,r,s){let i=n[e];return typeof i!="number"&&(i=s(e,t,r)+t,n[e]=i),i}function Vy(e,t,n,r,s,i,o){const a=n.getContext("2d",Wy);a.font=t._fontString;let c=0,h="";const l=[],u=Object.create(null),{letterSpacing:f,whiteSpace:d}=t,p=yu(d),m=_u(d);let g=!p;const y=t.wordWrapWidth+f,x=bu(e);for(let _=0;_<x.length;_++){let v=x[_];if(Wo(v)){if(!m){l.push(Qt(h)),g=!p,h="",c=0;continue}v=" "}if(p){const A=Ut(v),k=Ut(h[h.length-1]);if(A&&k)continue}const w=Sc(v,f,u,a,r);if(w>y)if(h!==""&&(l.push(Qt(h)),h="",c=0),s(v,t.breakWords)){const A=xu(v,t.breakWords,o,i);for(const k of A){const $=Sc(k,f,u,a,r);$+c>y&&(l.push(Qt(h)),g=!1,h="",c=0),h+=k,c+=$}}else h.length>0&&(l.push(Qt(h)),h="",c=0),l.push(Qt(v)),g=!1,h="",c=0;else w+c>y&&(g=!1,l.push(Qt(h)),h="",c=0),(h.length>0||!Ut(v)||g)&&(h+=v,c+=w)}const b=Qt(h);return b.length>0&&l.push(b),l.join(`
`)}const Ac={willReadFrequently:!0},he=class R{static get experimentalLetterSpacingSupported(){let t=R._experimentalLetterSpacingSupported;if(t===void 0){const n=X.get().getCanvasRenderingContext2D().prototype;t=R._experimentalLetterSpacingSupported="letterSpacing"in n||"textLetterSpacing"in n}return t}constructor(t,n,r,s,i,o,a,c,h,l){this.text=t,this.style=n,this.width=r,this.height=s,this.lines=i,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=c,this.fontProperties=h,l&&(this.runsByLine=l.runsByLine,this.lineAscents=l.lineAscents,this.lineDescents=l.lineDescents,this.lineHeights=l.lineHeights,this.hasDropShadow=l.hasDropShadow)}static measureText(t=" ",n,r=R._canvas,s=n.wordWrap){const i=`${t}-${n.styleKey}-wordWrap-${s}`;if(R._measurementCache.has(i))return R._measurementCache.get(i);if(mu(n)&&gu(t)){const v=jy(t,n,s,R._context,R._measureText,R.measureFont,R.canBreakChars,R.wordWrapSplit),w=new R(t,n,v.width,v.height,v.lines,v.lineWidths,v.lineHeight,v.maxLineWidth,v.fontProperties,{runsByLine:v.runsByLine,lineAscents:v.lineAscents,lineDescents:v.lineDescents,lineHeights:v.lineHeights,hasDropShadow:v.hasDropShadow});return R._measurementCache.set(i,w),w}const a=n._fontString,c=R.measureFont(a);c.fontSize===0&&(c.fontSize=n.fontSize,c.ascent=n.fontSize,c.descent=0);const h=R._context;h.font=a;const u=(s?R._wordWrap(t,n,r):t).split(Ly),f=new Array(u.length);let d=0;for(let v=0;v<u.length;v++){const w=R._measureText(u[v],n.letterSpacing,h);f[v]=w,d=Math.max(d,w)}const p=n._stroke?.width??0,m=n.lineHeight||c.fontSize,g=R._getAlignWidth(d,n,s),y=R._adjustWidthForStyle(g,n),x=Math.max(m,c.fontSize+p)+(u.length-1)*(m+n.leading),b=R._adjustHeightForStyle(x,n),_=new R(t,n,y,b,u,f,m+n.leading,d,c);return R._measurementCache.set(i,_),_}static _adjustWidthForStyle(t,n){const r=n._stroke?.width||0;let s=t+r;return n.dropShadow&&(s+=n.dropShadow.distance),s}static _adjustHeightForStyle(t,n){let r=t;return n.dropShadow&&(r+=n.dropShadow.distance),r}static _getAlignWidth(t,n,r){return r&&n.align!=="left"&&n.align!=="justify"?Math.max(t,n.wordWrapWidth):t}static _measureText(t,n,r){let s=!1;R.experimentalLetterSpacingSupported&&(R.experimentalLetterSpacing?(r.letterSpacing=`${n}px`,r.textLetterSpacing=`${n}px`,s=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));const i=r.measureText(t);let o=i.width;const a=-(i.actualBoundingBoxLeft??0);let h=(i.actualBoundingBoxRight??0)-a;if(o>0)if(s)o-=n,h-=n;else{const l=(R.graphemeSegmenter(t).length-1)*n;o+=l,h+=l}return Math.max(o,h)}static _wordWrap(t,n,r=R._canvas){return Vy(t,n,r,R._measureText,R.canBreakWords,R.canBreakChars,R.wordWrapSplit)}static isBreakingSpace(t,n){return Ut(t)}static canBreakWords(t,n){return n}static canBreakChars(t,n,r,s,i){return!0}static wordWrapSplit(t){return R.graphemeSegmenter(t)}static measureFont(t){if(R._fonts[t])return R._fonts[t];const n=R._context;n.font=t;const r=n.measureText(R.METRICS_STRING+R.BASELINE_SYMBOL),s=r.actualBoundingBoxAscent??0,i=r.actualBoundingBoxDescent??0,o={ascent:s,descent:i,fontSize:s+i};return R._fonts[t]=o,o}static clearMetrics(t=""){t?delete R._fonts[t]:R._fonts={}}static get _canvas(){if(!R.__canvas){let t;try{const n=new OffscreenCanvas(0,0);if(n.getContext("2d",Ac)?.measureText)return R.__canvas=n,n;t=X.get().createCanvas()}catch{t=X.get().createCanvas()}t.width=t.height=10,R.__canvas=t}return R.__canvas}static get _context(){return R.__context||(R.__context=R._canvas.getContext("2d",Ac)),R.__context}};he.METRICS_STRING="|q";he.BASELINE_SYMBOL="M";he.BASELINE_MULTIPLIER=1.4;he.HEIGHT_MULTIPLIER=2;he.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const e=new Intl.Segmenter;return t=>{const n=e.segment(t),r=[];let s=0;for(const i of n)r[s++]=i.segment;return r}}return e=>[...e]})();he.experimentalLetterSpacing=!1;he._fonts={};he._measurementCache=Iy(1e3);let te=he;const Zy=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Wi(e){const t=typeof e.fontSize=="number"?`${e.fontSize}px`:e.fontSize;let n=e.fontFamily;Array.isArray(e.fontFamily)||(n=e.fontFamily.split(","));for(let r=n.length-1;r>=0;r--){let s=n[r].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!Zy.includes(s)&&(s=`"${s}"`),n[r]=s}return`${e.fontStyle} ${e.fontVariant} ${e.fontWeight} ${t} ${n.join(",")}`}const Tc=1e5;function Dr(e,t,n,r=0,s=0,i=0){if(e.texture===U.WHITE&&!e.fill)return ut.shared.setValue(e.color).setAlpha(e.alpha??1).toHexa();if(e.fill){if(e.fill instanceof bs){const o=e.fill,a=t.createPattern(o.texture.source.resource,"repeat"),c=o.transform.copyTo(D.shared);return c.scale(o.texture.source.pixelWidth,o.texture.source.pixelHeight),a.setTransform(c),a}else if(e.fill instanceof ie){const o=e.fill,a=o.type==="linear",c=o.textureSpace==="local";let h=1,l=1;c&&n&&(h=n.width+r,l=n.height+r);let u,f=!1;if(a){const{start:d,end:p}=o;u=t.createLinearGradient(d.x*h+s,d.y*l+i,p.x*h+s,p.y*l+i),f=Math.abs(p.x-d.x)<Math.abs((p.y-d.y)*.1)}else{const{center:d,innerRadius:p,outerCenter:m,outerRadius:g}=o;u=t.createRadialGradient(d.x*h+s,d.y*l+i,p*h,m.x*h+s,m.y*l+i,g*h)}if(f&&c&&n){const d=n.lineHeight/l;for(let p=0;p<n.lines.length;p++){const m=(p*n.lineHeight+r/2)/l;o.colorStops.forEach(g=>{let y=m+g.offset*d;y=Math.max(0,Math.min(1,y)),u.addColorStop(Math.floor(y*Tc)/Tc,ut.shared.setValue(g.color).toHex())})}}else o.colorStops.forEach(d=>{u.addColorStop(d.offset,ut.shared.setValue(d.color).toHex())});return u}}else{const o=t.createPattern(e.texture.source.resource,"repeat"),a=e.matrix.copyTo(D.shared);return a.scale(e.texture.source.pixelWidth,e.texture.source.pixelHeight),o.setTransform(a),o}return Q("FillStyle not recognised",e),"red"}const Cc=new at;class Hy{getCanvasAndContext(t){const{text:n,style:r,resolution:s=1}=t,i=r._getFinalPadding(),o=te.measureText(n||" ",r),a=Math.ceil(Math.ceil(Math.max(1,o.width)+i*2)*s),c=Math.ceil(Math.ceil(Math.max(1,o.height)+i*2)*s),h=Ui.getOptimalCanvasAndContext(a,c);this._renderTextToCanvas(r,i,s,h,o);const l=r.trim?My({canvas:h.canvas,width:a,height:c,resolution:1,output:Cc}):Cc.set(0,0,a,c);return{canvasAndContext:h,frame:l}}returnCanvasAndContext(t){Ui.returnCanvasAndContext(t)}_renderTextToCanvas(t,n,r,s,i){if(i.runsByLine&&i.runsByLine.length>0){this._renderTaggedTextToCanvas(i,t,n,r,s);return}const{canvas:o,context:a}=s,c=Wi(t),h=i.lines,l=i.lineHeight,u=i.lineWidths,f=i.maxLineWidth,d=i.fontProperties,p=o.height;if(a.resetTransform(),a.scale(r,r),a.textBaseline=t.textBaseline,t._stroke?.width){const w=t._stroke;a.lineWidth=w.width,a.miterLimit=w.miterLimit,a.lineJoin=w.join,a.lineCap=w.cap}a.font=c;let m,g;const y=t.dropShadow?2:1,x=t.wordWrap?t.wordWrapWidth:f,_=(t._stroke?.width??0)/2;let v=(l-d.fontSize)/2;l-d.fontSize<0&&(v=0);for(let w=0;w<y;++w){const A=t.dropShadow&&w===0,k=A?Math.ceil(Math.max(1,p)+n*2):0,$=k*r;if(A)this._setupDropShadow(a,t,r,$);else{const C=t._gradientBounds,T=t._gradientOffset;if(C){const O={width:C.width,height:C.height,lineHeight:C.height,lines:i.lines};this._setFillAndStrokeStyles(a,t,O,n,_,T?.x??0,T?.y??0)}else T?this._setFillAndStrokeStyles(a,t,i,n,_,T.x,T.y):this._setFillAndStrokeStyles(a,t,i,n,_);a.shadowColor="black"}for(let C=0;C<h.length;C++)m=_,g=_+C*l+d.ascent+v,m+=this._getAlignmentOffset(u[C],x,t.align),t._stroke?.width&&this._drawLetterSpacing(h[C],t,s,m+n,g+n-k,!0),t._fill!==void 0&&this._drawLetterSpacing(h[C],t,s,m+n,g+n-k)}}_renderTaggedTextToCanvas(t,n,r,s,i){const{canvas:o,context:a}=i,{runsByLine:c,lineWidths:h,maxLineWidth:l,lineAscents:u,lineHeights:f,hasDropShadow:d}=t,p=o.height;a.resetTransform(),a.scale(s,s),a.textBaseline=n.textBaseline;const m=d?2:1,g=n.wordWrap?n.wordWrapWidth:l,x=(n._stroke?.width??0)/2,b=[];for(let _=0;_<c.length;_++){const v=c[_],w=[];for(const A of v){const k=Wi(A.style);a.font=k,w.push({width:te._measureText(A.text,A.style.letterSpacing,a),font:k})}b.push(w)}for(let _=0;_<m;++_){const v=d&&_===0,w=v?Math.ceil(Math.max(1,p)+r*2):0,A=w*s;v||(a.shadowColor="black");let k=x;for(let $=0;$<c.length;$++){const C=c[$],T=h[$],O=u[$],F=f[$],B=b[$];let W=x;W+=this._getAlignmentOffset(T,g,n.align);const P=k+O;let M=W+r;for(let j=0;j<C.length;j++){const I=C[j],{width:H,font:ct}=B[j];if(a.font=ct,a.textBaseline=I.style.textBaseline,I.style._stroke?.width){const ft=I.style._stroke;if(a.lineWidth=ft.width,a.miterLimit=ft.miterLimit,a.lineJoin=ft.join,a.lineCap=ft.cap,v)if(I.style.dropShadow)this._setupDropShadow(a,I.style,s,A);else{M+=H;continue}else{const vt=te.measureFont(ct),Zt=I.style.lineHeight||vt.fontSize,Ne={width:H,height:Zt,lineHeight:Zt,lines:[I.text]};a.strokeStyle=Dr(ft,a,Ne,r*2,M-r,k)}this._drawLetterSpacing(I.text,I.style,i,M,P+r-w,!0)}M+=H}M=W+r;for(let j=0;j<C.length;j++){const I=C[j],{width:H,font:ct}=B[j];if(a.font=ct,a.textBaseline=I.style.textBaseline,I.style._fill!==void 0){if(v)if(I.style.dropShadow)this._setupDropShadow(a,I.style,s,A);else{M+=H;continue}else{const ft=te.measureFont(ct),vt=I.style.lineHeight||ft.fontSize,Zt={width:H,height:vt,lineHeight:vt,lines:[I.text]};a.fillStyle=Dr(I.style._fill,a,Zt,r*2,M-r,k)}this._drawLetterSpacing(I.text,I.style,i,M,P+r-w,!1)}M+=H}k+=F}}}_setFillAndStrokeStyles(t,n,r,s,i,o=0,a=0){if(t.fillStyle=n._fill?Dr(n._fill,t,r,s*2,o,a):null,n._stroke?.width){const c=i+s*2;t.strokeStyle=Dr(n._stroke,t,r,c,o,a)}}_setupDropShadow(t,n,r,s){t.fillStyle="black",t.strokeStyle="black";const i=n.dropShadow,o=i.color,a=i.alpha;t.shadowColor=ut.shared.setValue(o).setAlpha(a).toRgbaString();const c=i.blur*r,h=i.distance*r;t.shadowBlur=c,t.shadowOffsetX=Math.cos(i.angle)*h,t.shadowOffsetY=Math.sin(i.angle)*h+s}_getAlignmentOffset(t,n,r){return r==="right"?n-t:r==="center"?(n-t)/2:0}_drawLetterSpacing(t,n,r,s,i,o=!1){const{context:a}=r,c=n.letterSpacing;let h=!1;if(te.experimentalLetterSpacingSupported&&(te.experimentalLetterSpacing?(a.letterSpacing=`${c}px`,a.textLetterSpacing=`${c}px`,h=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),c===0||h){o?a.strokeText(t,s,i):a.fillText(t,s,i);return}let l=s;const u=te.graphemeSegmenter(t);let f=a.measureText(t).width,d=0;for(let p=0;p<u.length;++p){const m=u[p];o?a.strokeText(m,l,i):a.fillText(m,l,i);let g="";for(let y=p+1;y<u.length;++y)g+=u[y];d=a.measureText(g).width,l+=f-d+c,f=d}}}const qe=new Hy,Vo=class ze extends qt{constructor(t={}){super(),this.uid=it("textStyle"),this._tick=0,this._cachedFontString=null,Yy(t),t instanceof ze&&(t=t._toObject());const s={...ze.defaultTextStyle,...t};for(const i in s){const o=i;this[o]=s[i]}this._tagStyles=t.tagStyles??void 0,this.update(),this._tick=0}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.update())}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...ze.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...ze.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.update())}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.update())}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.update())}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.update())}get filters(){return this._filters}set filters(t){this._filters!==t&&(this._filters=Object.freeze(t),this.update())}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.update())}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...Rt.defaultFillStyle,...t},()=>{this._fill=$e({...this._originalFill},Rt.defaultFillStyle)})),this._fill=$e(t===0?"black":t,Rt.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...Rt.defaultStrokeStyle,...t},()=>{this._stroke=ns({...this._originalStroke},Rt.defaultStrokeStyle)})),this._stroke=ns(t,Rt.defaultStrokeStyle),this.update())}get tagStyles(){return this._tagStyles}set tagStyles(t){this._tagStyles!==t&&(this._tagStyles=t??void 0,this.update())}update(){this._tick++,this._cachedFontString=null,this.emit("update",this)}reset(){const t=ze.defaultTextStyle;for(const n in t)this[n]=t[n]}assign(t){for(const n in t){const r=n;this[r]=t[n]}return this}get styleKey(){return`${this.uid}-${this._tick}`}get _fontString(){return this._cachedFontString===null&&(this._cachedFontString=Wi(this)),this._cachedFontString}_toObject(){return{align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill?{...this._fill}:void 0,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke?{...this._stroke}:void 0,textBaseline:this.textBaseline,trim:this.trim,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0,tagStyles:this._tagStyles?{...this._tagStyles}:void 0}}clone(){return new ze(this._toObject())}_getFinalPadding(){let t=0;if(this._filters)for(let n=0;n<this._filters.length;n++)t+=this._filters[n].padding;return Math.max(this._padding,t)}destroy(t=!1){if(this.removeAllListeners(),typeof t=="boolean"?t:t?.texture){const r=typeof t=="boolean"?t:t?.textureSource;this._fill?.texture&&this._fill.texture.destroy(r),this._originalFill?.texture&&this._originalFill.texture.destroy(r),this._stroke?.texture&&this._stroke.texture.destroy(r),this._originalStroke?.texture&&this._originalStroke.texture.destroy(r)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,n){return new Proxy(t,{set:(r,s,i)=>(r[s]===i||(r[s]=i,n?.(s,i),this.update()),!0)})}_isFillStyle(t){return(t??null)!==null&&!(ut.isColorLike(t)||t instanceof ie||t instanceof bs)}};Vo.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Vo.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Re=Vo;function Yy(e){const t=e;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const n=Re.defaultDropShadow;e.dropShadow={alpha:t.dropShadowAlpha??n.alpha,angle:t.dropShadowAngle??n.angle,blur:t.dropShadowBlur??n.blur,color:t.dropShadowColor??n.color,distance:t.dropShadowDistance??n.distance}}if(t.strokeThickness!==void 0){G(st,"strokeThickness is now a part of stroke");const n=t.stroke;let r={};if(ut.isColorLike(n))r.color=n;else if(n instanceof ie||n instanceof bs)r.fill=n;else if(Object.hasOwnProperty.call(n,"color")||Object.hasOwnProperty.call(n,"fill"))r=n;else throw new Error("Invalid stroke value.");e.stroke={...r,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){if(G(st,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(t.fill)||t.fill.length===0)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");t.fill.length!==t.fillGradientStops.length&&Q("The number of fill colors must match the number of fill gradient stops.");const n=new ie({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),r=t.fillGradientStops.slice(),s=t.fill.map(i=>ut.shared.setValue(i).toNumber());r.forEach((i,o)=>{n.addColorStop(i,s[o])}),e.fill={fill:n}}}function Xy(e,t){const{texture:n,bounds:r}=e,s=t._style._getFinalPadding();el(r,t._anchor,n);const i=t._anchor._x*s*2,o=t._anchor._y*s*2;r.minX-=s-i,r.minY-=s-o,r.maxX-=s-i,r.maxY-=s-o}class qy{constructor(){this.batcherName="default",this.topology="triangle-list",this.attributeSize=4,this.indexSize=6,this.packAsQuad=!0,this.roundPixels=0,this._attributeStart=0,this._batcher=null,this._batch=null}get blendMode(){return this.renderable.groupBlendMode}get color(){return this.renderable.groupColorAlpha}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.bounds=null}destroy(){this.reset()}}class Ky extends qy{}class vu{constructor(t){this._renderer=t,t.runners.resolutionChange.add(this),this._managedTexts=new gr({renderer:t,type:"renderable",onUnload:this.onTextUnload.bind(this),name:"canvasText"})}resolutionChange(){for(const t in this._managedTexts.items){const n=this._managedTexts.items[t];n?._autoResolution&&n.onViewUpdate()}}validateRenderable(t){const n=this._getGpuText(t),r=t.styleKey;return n.currentKey!==r?!0:t._didTextUpdate}addRenderable(t,n){const r=this._getGpuText(t);if(t._didTextUpdate){const s=t._autoResolution?this._renderer.resolution:t.resolution;(r.currentKey!==t.styleKey||t._resolution!==s)&&this._updateGpuText(t),t._didTextUpdate=!1,Xy(r,t)}this._renderer.renderPipes.batch.addToBatch(r,n)}updateRenderable(t){const n=this._getGpuText(t);n._batcher.updateElement(n)}_updateGpuText(t){const n=this._getGpuText(t);n.texture&&this._renderer.canvasText.decreaseReferenceCount(n.currentKey),t._resolution=t._autoResolution?this._renderer.resolution:t.resolution,n.texture=this._renderer.canvasText.getManagedTexture(t),n.currentKey=t.styleKey}_getGpuText(t){return t._gpuData[this._renderer.uid]||this.initGpuText(t)}initGpuText(t){const n=new Ky;return n.currentKey="--",n.renderable=t,n.transform=t.groupTransform,n.bounds={minX:0,maxX:1,minY:0,maxY:0},n.roundPixels=this._renderer._roundPixels|t._roundPixels,t._gpuData[this._renderer.uid]=n,this._managedTexts.add(t),n}onTextUnload(t){const n=t._gpuData[this._renderer.uid];if(!n)return;const{canvasText:r}=this._renderer;r.getReferenceCount(n.currentKey)>0?r.decreaseReferenceCount(n.currentKey):n.texture&&r.returnTexture(n.texture)}destroy(){this._managedTexts.destroy(),this._renderer=null}}vu.extension={type:[E.WebGLPipes,E.WebGPUPipes,E.CanvasPipes],name:"text"};const Jy=new Dt;function Qy(e,t,n,r){const s=Jy;s.minX=0,s.minY=0,s.maxX=e.width/r|0,s.maxY=e.height/r|0;const i=ps.getOptimalTexture(s.width,s.height,r,!1);return i.source.uploadMethodId="image",i.source.resource=e,i.source.alphaMode="premultiply-alpha-on-upload",i.frame.width=t/r,i.frame.height=n/r,i.source.emit("update",i.source),i.updateUvs(),i}class wu{constructor(t,n){this._activeTextures={},this._renderer=t,this._retainCanvasContext=n}getTexture(t,n,r,s){typeof t=="string"&&(G("8.0.0","CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),t={text:t,style:r,resolution:n}),t.style instanceof Re||(t.style=new Re(t.style)),t.textureStyle instanceof an||(t.textureStyle=new an(t.textureStyle)),typeof t.text!="string"&&(t.text=t.text.toString());const{text:i,style:o,textureStyle:a}=t,c=t.resolution??this._renderer.resolution,{frame:h,canvasAndContext:l}=qe.getCanvasAndContext({text:i,style:o,resolution:c}),u=Qy(l.canvas,h.width,h.height,c);if(a&&(u.source.style=a),o.trim&&(h.pad(o.padding),u.frame.copyFrom(h),u.frame.scale(1/c),u.updateUvs()),o.filters){const f=this._applyFilters(u,o.filters);return this.returnTexture(u),qe.returnCanvasAndContext(l),f}return this._renderer.texture.initSource(u._source),this._retainCanvasContext||qe.returnCanvasAndContext(l),u}returnTexture(t){const n=t.source,r=n.resource;if(this._retainCanvasContext&&r?.getContext){const s=r.getContext("2d");s&&qe.returnCanvasAndContext({canvas:r,context:s})}n.resource=null,n.uploadMethodId="unknown",n.alphaMode="no-premultiply-alpha",ps.returnTexture(t,!0)}renderTextToCanvas(){G("8.10.0","CanvasTextSystem.renderTextToCanvas: no longer supported, use CanvasTextSystem.getTexture instead")}getManagedTexture(t){t._resolution=t._autoResolution?this._renderer.resolution:t.resolution;const n=t.styleKey;if(this._activeTextures[n])return this._increaseReferenceCount(n),this._activeTextures[n].texture;const r=this.getTexture({text:t.text,style:t.style,resolution:t._resolution,textureStyle:t.textureStyle});return this._activeTextures[n]={texture:r,usageCount:1},r}decreaseReferenceCount(t){const n=this._activeTextures[t];n&&(n.usageCount--,n.usageCount===0&&(this.returnTexture(n.texture),this._activeTextures[t]=null))}getReferenceCount(t){return this._activeTextures[t]?.usageCount??0}_increaseReferenceCount(t){this._activeTextures[t].usageCount++}_applyFilters(t,n){const r=this._renderer.renderTarget.renderTarget,s=this._renderer.filter.generateFilteredTexture({texture:t,filters:n});return this._renderer.renderTarget.bind(r,!1),s}destroy(){this._renderer=null;for(const t in this._activeTextures)this._activeTextures[t]&&this.returnTexture(this._activeTextures[t].texture);this._activeTextures=null}}class Su extends wu{constructor(t){super(t,!0)}}Su.extension={type:[E.CanvasSystem],name:"canvasText"};class Au extends wu{constructor(t){super(t,!1)}}Au.extension={type:[E.WebGLSystem,E.WebGPUSystem],name:"canvasText"};Y.add(Su);Y.add(Au);Y.add(vu);class t_ extends Ty{constructor(...t){const n=Cy(t,"Text");super(n,Re),this.renderPipeId="text",n.textureStyle&&(this.textureStyle=n.textureStyle instanceof an?n.textureStyle:new an(n.textureStyle))}updateBounds(){const t=this._bounds,n=this._anchor;let r=0,s=0;if(this._style.trim){const{frame:i,canvasAndContext:o}=qe.getCanvasAndContext({text:this.text,style:this._style,resolution:1});qe.returnCanvasAndContext(o),r=i.width,s=i.height}else{const i=te.measureText(this._text,this._style);r=i.width,s=i.height}t.minX=-n._x*r,t.maxX=t.minX+r,t.minY=-n._y*s,t.maxY=t.minY+s}}Y.add(Ld,Gd);function S(e,t,n){function r(a,c){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:c,constr:o,traits:new Set},enumerable:!1}),a._zod.traits.has(e))return;a._zod.traits.add(e),t(a,c);const h=o.prototype,l=Object.keys(h);for(let u=0;u<l.length;u++){const f=l[u];f in a||(a[f]=h[f].bind(a))}}const s=n?.Parent??Object;class i extends s{}Object.defineProperty(i,"name",{value:e});function o(a){var c;const h=n?.Parent?new i:this;r(h,a),(c=h._zod).deferred??(c.deferred=[]);for(const l of h._zod.deferred)l();return h}return Object.defineProperty(o,"init",{value:r}),Object.defineProperty(o,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(e)}),Object.defineProperty(o,"name",{value:e}),o}class nn extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Tu extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Cu={};function oe(e){return Cu}function Pu(e){const t=Object.values(e).filter(r=>typeof r=="number");return Object.entries(e).filter(([r,s])=>t.indexOf(+r)===-1).map(([r,s])=>s)}function Vi(e,t){return typeof t=="bigint"?t.toString():t}function Zo(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function xn(e){return e==null}function Ho(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function e_(e,t){const n=(e.toString().split(".")[1]||"").length,r=t.toString();let s=(r.split(".")[1]||"").length;if(s===0&&/\d?e-\d?/.test(r)){const c=r.match(/\d?e-(\d?)/);c?.[1]&&(s=Number.parseInt(c[1]))}const i=n>s?n:s,o=Number.parseInt(e.toFixed(i).replace(".","")),a=Number.parseInt(t.toFixed(i).replace(".",""));return o%a/10**i}const Pc=Symbol("evaluating");function L(e,t,n){let r;Object.defineProperty(e,t,{get(){if(r!==Pc)return r===void 0&&(r=Pc,r=n()),r},set(s){Object.defineProperty(e,t,{value:s})},configurable:!0})}function Le(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function be(...e){const t={};for(const n of e){const r=Object.getOwnPropertyDescriptors(n);Object.assign(t,r)}return Object.defineProperties({},t)}function kc(e){return JSON.stringify(e)}function n_(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const ku="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function ss(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const r_=Zo(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function rr(e){if(ss(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const n=t.prototype;return!(ss(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function Mu(e){return rr(e)?{...e}:Array.isArray(e)?[...e]:e}const Zi=new Set(["string","number","symbol"]);function dn(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function xe(e,t,n){const r=new e._zod.constr(t??e._zod.def);return(!t||n?.parent)&&(r._zod.parent=e),r}function z(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function s_(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const i_={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function o_(e,t){const n=e._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".pick() cannot be used on object schemas containing refinements");const i=be(e._zod.def,{get shape(){const o={};for(const a in t){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&(o[a]=n.shape[a])}return Le(this,"shape",o),o},checks:[]});return xe(e,i)}function a_(e,t){const n=e._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".omit() cannot be used on object schemas containing refinements");const i=be(e._zod.def,{get shape(){const o={...e._zod.def.shape};for(const a in t){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&delete o[a]}return Le(this,"shape",o),o},checks:[]});return xe(e,i)}function c_(e,t){if(!rr(t))throw new Error("Invalid input to extend: expected a plain object");const n=e._zod.def.checks;if(n&&n.length>0){const i=e._zod.def.shape;for(const o in t)if(Object.getOwnPropertyDescriptor(i,o)!==void 0)throw new Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}const s=be(e._zod.def,{get shape(){const i={...e._zod.def.shape,...t};return Le(this,"shape",i),i}});return xe(e,s)}function h_(e,t){if(!rr(t))throw new Error("Invalid input to safeExtend: expected a plain object");const n=be(e._zod.def,{get shape(){const r={...e._zod.def.shape,...t};return Le(this,"shape",r),r}});return xe(e,n)}function l_(e,t){const n=be(e._zod.def,{get shape(){const r={...e._zod.def.shape,...t._zod.def.shape};return Le(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return xe(e,n)}function u_(e,t,n){const s=t._zod.def.checks;if(s&&s.length>0)throw new Error(".partial() cannot be used on object schemas containing refinements");const o=be(t._zod.def,{get shape(){const a=t._zod.def.shape,c={...a};if(n)for(const h in n){if(!(h in a))throw new Error(`Unrecognized key: "${h}"`);n[h]&&(c[h]=e?new e({type:"optional",innerType:a[h]}):a[h])}else for(const h in a)c[h]=e?new e({type:"optional",innerType:a[h]}):a[h];return Le(this,"shape",c),c},checks:[]});return xe(t,o)}function d_(e,t,n){const r=be(t._zod.def,{get shape(){const s=t._zod.def.shape,i={...s};if(n)for(const o in n){if(!(o in i))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(i[o]=new e({type:"nonoptional",innerType:s[o]}))}else for(const o in s)i[o]=new e({type:"nonoptional",innerType:s[o]});return Le(this,"shape",i),i}});return xe(t,r)}function Ke(e,t=0){if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(e.issues[n]?.continue!==!0)return!0;return!1}function sr(e,t){return t.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(e),n})}function Lr(e){return typeof e=="string"?e:e?.message}function ae(e,t,n){const r={...e,path:e.path??[]};if(!e.message){const s=Lr(e.inst?._zod.def?.error?.(e))??Lr(t?.error?.(e))??Lr(n.customError?.(e))??Lr(n.localeError?.(e))??"Invalid input";r.message=s}return delete r.inst,delete r.continue,t?.reportInput||delete r.input,r}function Yo(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function Xo(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function ir(...e){const[t,n,r]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:r}:{...t}}const Eu=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,Vi,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Iu=S("$ZodError",Eu),xs=S("$ZodError",Eu,{Parent:Error});function f_(e,t=n=>n.message){const n={},r=[];for(const s of e.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}function p_(e,t=n=>n.message){const n={_errors:[]},r=s=>{for(const i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(o=>r({issues:o}));else if(i.code==="invalid_key")r({issues:i.issues});else if(i.code==="invalid_element")r({issues:i.issues});else if(i.path.length===0)n._errors.push(t(i));else{let o=n,a=0;for(;a<i.path.length;){const c=i.path[a];a===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(i))):o[c]=o[c]||{_errors:[]},o=o[c],a++}}};return r(e),n}const vs=e=>(t,n,r,s)=>{const i=r?Object.assign(r,{async:!1}):{async:!1},o=t._zod.run({value:n,issues:[]},i);if(o instanceof Promise)throw new nn;if(o.issues.length){const a=new(s?.Err??e)(o.issues.map(c=>ae(c,i,oe())));throw ku(a,s?.callee),a}return o.value},Mc=vs(xs),ws=e=>async(t,n,r,s)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let o=t._zod.run({value:n,issues:[]},i);if(o instanceof Promise&&(o=await o),o.issues.length){const a=new(s?.Err??e)(o.issues.map(c=>ae(c,i,oe())));throw ku(a,s?.callee),a}return o.value},Ec=ws(xs),Ss=e=>(t,n,r)=>{const s=r?{...r,async:!1}:{async:!1},i=t._zod.run({value:n,issues:[]},s);if(i instanceof Promise)throw new nn;return i.issues.length?{success:!1,error:new(e??Iu)(i.issues.map(o=>ae(o,s,oe())))}:{success:!0,data:i.value}},m_=Ss(xs),As=e=>async(t,n,r)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let i=t._zod.run({value:n,issues:[]},s);return i instanceof Promise&&(i=await i),i.issues.length?{success:!1,error:new e(i.issues.map(o=>ae(o,s,oe())))}:{success:!0,data:i.value}},g_=As(xs),y_=e=>(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return vs(e)(t,n,s)},__=e=>(t,n,r)=>vs(e)(t,n,r),b_=e=>async(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ws(e)(t,n,s)},x_=e=>async(t,n,r)=>ws(e)(t,n,r),v_=e=>(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Ss(e)(t,n,s)},w_=e=>(t,n,r)=>Ss(e)(t,n,r),S_=e=>async(t,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return As(e)(t,n,s)},A_=e=>async(t,n,r)=>As(e)(t,n,r),T_=/^[cC][^\s-]{8,}$/,C_=/^[0-9a-z]+$/,P_=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,k_=/^[0-9a-vA-V]{20}$/,M_=/^[A-Za-z0-9]{27}$/,E_=/^[a-zA-Z0-9_-]{21}$/,I_=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,z_=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Ic=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,$_=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,R_="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function O_(){return new RegExp(R_,"u")}const B_=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,F_=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,D_=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,L_=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,G_=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,zu=/^[A-Za-z0-9_-]*$/,j_=/^\+[1-9]\d{6,14}$/,$u="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",N_=new RegExp(`^${$u}$`);function Ru(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function U_(e){return new RegExp(`^${Ru(e)}$`)}function W_(e){const t=Ru({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${t}(?:${n.join("|")})`;return new RegExp(`^${$u}T(?:${r})$`)}const V_=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},Z_=/^-?\d+$/,H_=/^-?\d+(?:\.\d+)?$/,Y_=/^(?:true|false)$/i,X_=/^[^A-Z]*$/,q_=/^[^a-z]*$/,xt=S("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),Ou={number:"number",bigint:"bigint",object:"date"},Bu=S("$ZodCheckLessThan",(e,t)=>{xt.init(e,t);const n=Ou[typeof t.value];e._zod.onattach.push(r=>{const s=r._zod.bag,i=(t.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<i&&(t.inclusive?s.maximum=t.value:s.exclusiveMaximum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:"too_big",maximum:typeof t.value=="object"?t.value.getTime():t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Fu=S("$ZodCheckGreaterThan",(e,t)=>{xt.init(e,t);const n=Ou[typeof t.value];e._zod.onattach.push(r=>{const s=r._zod.bag,i=(t.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>i&&(t.inclusive?s.minimum=t.value:s.exclusiveMinimum=t.value)}),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:"too_small",minimum:typeof t.value=="object"?t.value.getTime():t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),K_=S("$ZodCheckMultipleOf",(e,t)=>{xt.init(e,t),e._zod.onattach.push(n=>{var r;(r=n._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):e_(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),J_=S("$ZodCheckNumberFormat",(e,t)=>{xt.init(e,t),t.format=t.format||"float64";const n=t.format?.includes("int"),r=n?"int":"number",[s,i]=i_[t.format];e._zod.onattach.push(o=>{const a=o._zod.bag;a.format=t.format,a.minimum=s,a.maximum=i,n&&(a.pattern=Z_)}),e._zod.check=o=>{const a=o.value;if(n){if(!Number.isInteger(a)){o.issues.push({expected:r,format:t.format,code:"invalid_type",continue:!1,input:a,inst:e});return}if(!Number.isSafeInteger(a)){a>0?o.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,inclusive:!0,continue:!t.abort}):o.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:r,inclusive:!0,continue:!t.abort});return}}a<s&&o.issues.push({origin:"number",input:a,code:"too_small",minimum:s,inclusive:!0,inst:e,continue:!t.abort}),a>i&&o.issues.push({origin:"number",input:a,code:"too_big",maximum:i,inclusive:!0,inst:e,continue:!t.abort})}}),Q_=S("$ZodCheckMaxSize",(e,t)=>{var n;xt.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!xn(s)&&s.size!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<s&&(r._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{const s=r.value;s.size<=t.maximum||r.issues.push({origin:Yo(s),code:"too_big",maximum:t.maximum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),tb=S("$ZodCheckMinSize",(e,t)=>{var n;xt.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!xn(s)&&s.size!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>s&&(r._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{const s=r.value;s.size>=t.minimum||r.issues.push({origin:Yo(s),code:"too_small",minimum:t.minimum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),eb=S("$ZodCheckSizeEquals",(e,t)=>{var n;xt.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!xn(s)&&s.size!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag;s.minimum=t.size,s.maximum=t.size,s.size=t.size}),e._zod.check=r=>{const s=r.value,i=s.size;if(i===t.size)return;const o=i>t.size;r.issues.push({origin:Yo(s),...o?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),nb=S("$ZodCheckMaxLength",(e,t)=>{var n;xt.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!xn(s)&&s.length!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<s&&(r._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{const s=r.value;if(s.length<=t.maximum)return;const o=Xo(s);r.issues.push({origin:o,code:"too_big",maximum:t.maximum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),rb=S("$ZodCheckMinLength",(e,t)=>{var n;xt.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!xn(s)&&s.length!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>s&&(r._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{const s=r.value;if(s.length>=t.minimum)return;const o=Xo(s);r.issues.push({origin:o,code:"too_small",minimum:t.minimum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),sb=S("$ZodCheckLengthEquals",(e,t)=>{var n;xt.init(e,t),(n=e._zod.def).when??(n.when=r=>{const s=r.value;return!xn(s)&&s.length!==void 0}),e._zod.onattach.push(r=>{const s=r._zod.bag;s.minimum=t.length,s.maximum=t.length,s.length=t.length}),e._zod.check=r=>{const s=r.value,i=s.length;if(i===t.length)return;const o=Xo(s),a=i>t.length;r.issues.push({origin:o,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),Ts=S("$ZodCheckStringFormat",(e,t)=>{var n,r;xt.init(e,t),e._zod.onattach.push(s=>{const i=s._zod.bag;i.format=t.format,t.pattern&&(i.patterns??(i.patterns=new Set),i.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=s=>{t.pattern.lastIndex=0,!t.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:t.format,input:s.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(r=e._zod).check??(r.check=()=>{})}),ib=S("$ZodCheckRegex",(e,t)=>{Ts.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),ob=S("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=X_),Ts.init(e,t)}),ab=S("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=q_),Ts.init(e,t)}),cb=S("$ZodCheckIncludes",(e,t)=>{xt.init(e,t);const n=dn(t.includes),r=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=r,e._zod.onattach.push(s=>{const i=s._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),e._zod.check=s=>{s.value.includes(t.includes,t.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:s.value,inst:e,continue:!t.abort})}}),hb=S("$ZodCheckStartsWith",(e,t)=>{xt.init(e,t);const n=new RegExp(`^${dn(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),lb=S("$ZodCheckEndsWith",(e,t)=>{xt.init(e,t);const n=new RegExp(`.*${dn(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}}),ub=S("$ZodCheckOverwrite",(e,t)=>{xt.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class db{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const r=t.split(`
`).filter(o=>o),s=Math.min(...r.map(o=>o.length-o.trimStart().length)),i=r.map(o=>o.slice(s)).map(o=>" ".repeat(this.indent*2)+o);for(const o of i)this.content.push(o)}compile(){const t=Function,n=this?.args,s=[...(this?.content??[""]).map(i=>`  ${i}`)];return new t(...n,s.join(`
`))}}const fb={major:4,minor:3,patch:6},Z=S("$ZodType",(e,t)=>{var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=fb;const r=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&r.unshift(e);for(const s of r)for(const i of s._zod.onattach)i(e);if(r.length===0)(n=e._zod).deferred??(n.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const s=(o,a,c)=>{let h=Ke(o),l;for(const u of a){if(u._zod.def.when){if(!u._zod.def.when(o))continue}else if(h)continue;const f=o.issues.length,d=u._zod.check(o);if(d instanceof Promise&&c?.async===!1)throw new nn;if(l||d instanceof Promise)l=(l??Promise.resolve()).then(async()=>{await d,o.issues.length!==f&&(h||(h=Ke(o,f)))});else{if(o.issues.length===f)continue;h||(h=Ke(o,f))}}return l?l.then(()=>o):o},i=(o,a,c)=>{if(Ke(o))return o.aborted=!0,o;const h=s(a,r,c);if(h instanceof Promise){if(c.async===!1)throw new nn;return h.then(l=>e._zod.parse(l,c))}return e._zod.parse(h,c)};e._zod.run=(o,a)=>{if(a.skipChecks)return e._zod.parse(o,a);if(a.direction==="backward"){const h=e._zod.parse({value:o.value,issues:[]},{...a,skipChecks:!0});return h instanceof Promise?h.then(l=>i(l,o,a)):i(h,o,a)}const c=e._zod.parse(o,a);if(c instanceof Promise){if(a.async===!1)throw new nn;return c.then(h=>s(h,r,a))}return s(c,r,a)}}L(e,"~standard",()=>({validate:s=>{try{const i=m_(e,s);return i.success?{value:i.data}:{issues:i.error?.issues}}catch{return g_(e,s).then(o=>o.success?{value:o.data}:{issues:o.error?.issues})}},vendor:"zod",version:1}))}),qo=S("$ZodString",(e,t)=>{Z.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??V_(e._zod.bag),e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),tt=S("$ZodStringFormat",(e,t)=>{Ts.init(e,t),qo.init(e,t)}),pb=S("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=z_),tt.init(e,t)}),mb=S("$ZodUUID",(e,t)=>{if(t.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(r===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Ic(r))}else t.pattern??(t.pattern=Ic());tt.init(e,t)}),gb=S("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=$_),tt.init(e,t)}),yb=S("$ZodURL",(e,t)=>{tt.init(e,t),e._zod.check=n=>{try{const r=n.value.trim(),s=new URL(r);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(s.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),t.normalize?n.value=s.href:n.value=r;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),_b=S("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=O_()),tt.init(e,t)}),bb=S("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=E_),tt.init(e,t)}),xb=S("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=T_),tt.init(e,t)}),vb=S("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=C_),tt.init(e,t)}),wb=S("$ZodULID",(e,t)=>{t.pattern??(t.pattern=P_),tt.init(e,t)}),Sb=S("$ZodXID",(e,t)=>{t.pattern??(t.pattern=k_),tt.init(e,t)}),Ab=S("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=M_),tt.init(e,t)}),Tb=S("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=W_(t)),tt.init(e,t)}),Cb=S("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=N_),tt.init(e,t)}),Pb=S("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=U_(t)),tt.init(e,t)}),kb=S("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=I_),tt.init(e,t)}),Mb=S("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=B_),tt.init(e,t),e._zod.bag.format="ipv4"}),Eb=S("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=F_),tt.init(e,t),e._zod.bag.format="ipv6",e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),Ib=S("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=D_),tt.init(e,t)}),zb=S("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=L_),tt.init(e,t),e._zod.check=n=>{const r=n.value.split("/");try{if(r.length!==2)throw new Error;const[s,i]=r;if(!i)throw new Error;const o=Number(i);if(`${o}`!==i)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${s}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function Du(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const $b=S("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=G_),tt.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=n=>{Du(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function Rb(e){if(!zu.test(e))return!1;const t=e.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return Du(n)}const Ob=S("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=zu),tt.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=n=>{Rb(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),Bb=S("$ZodE164",(e,t)=>{t.pattern??(t.pattern=j_),tt.init(e,t)});function Fb(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const s=JSON.parse(atob(r));return!("typ"in s&&s?.typ!=="JWT"||!s.alg||t&&(!("alg"in s)||s.alg!==t))}catch{return!1}}const Db=S("$ZodJWT",(e,t)=>{tt.init(e,t),e._zod.check=n=>{Fb(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),Lu=S("$ZodNumber",(e,t)=>{Z.init(e,t),e._zod.pattern=e._zod.bag.pattern??H_,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=Number(n.value)}catch{}const s=n.value;if(typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s))return n;const i=typeof s=="number"?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:s,inst:e,...i?{received:i}:{}}),n}}),Lb=S("$ZodNumberFormat",(e,t)=>{J_.init(e,t),Lu.init(e,t)}),Gb=S("$ZodBoolean",(e,t)=>{Z.init(e,t),e._zod.pattern=Y_,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=!!n.value}catch{}const s=n.value;return typeof s=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:e}),n}}),jb=S("$ZodUnknown",(e,t)=>{Z.init(e,t),e._zod.parse=n=>n}),Nb=S("$ZodNever",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function zc(e,t,n){e.issues.length&&t.issues.push(...sr(n,e.issues)),t.value[n]=e.value}const Ub=S("$ZodArray",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>{const s=n.value;if(!Array.isArray(s))return n.issues.push({expected:"array",code:"invalid_type",input:s,inst:e}),n;n.value=Array(s.length);const i=[];for(let o=0;o<s.length;o++){const a=s[o],c=t.element._zod.run({value:a,issues:[]},r);c instanceof Promise?i.push(c.then(h=>zc(h,n,o))):zc(c,n,o)}return i.length?Promise.all(i).then(()=>n):n}});function is(e,t,n,r,s){if(e.issues.length){if(s&&!(n in r))return;t.issues.push(...sr(n,e.issues))}e.value===void 0?n in r&&(t.value[n]=void 0):t.value[n]=e.value}function Gu(e){const t=Object.keys(e.shape);for(const r of t)if(!e.shape?.[r]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${r}": expected a Zod schema`);const n=s_(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function ju(e,t,n,r,s,i){const o=[],a=s.keySet,c=s.catchall._zod,h=c.def.type,l=c.optout==="optional";for(const u in t){if(a.has(u))continue;if(h==="never"){o.push(u);continue}const f=c.run({value:t[u],issues:[]},r);f instanceof Promise?e.push(f.then(d=>is(d,n,u,t,l))):is(f,n,u,t,l)}return o.length&&n.issues.push({code:"unrecognized_keys",keys:o,input:t,inst:i}),e.length?Promise.all(e).then(()=>n):n}const Wb=S("$ZodObject",(e,t)=>{if(Z.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const a=t.shape;Object.defineProperty(t,"shape",{get:()=>{const c={...a};return Object.defineProperty(t,"shape",{value:c}),c}})}const r=Zo(()=>Gu(t));L(e._zod,"propValues",()=>{const a=t.shape,c={};for(const h in a){const l=a[h]._zod;if(l.values){c[h]??(c[h]=new Set);for(const u of l.values)c[h].add(u)}}return c});const s=ss,i=t.catchall;let o;e._zod.parse=(a,c)=>{o??(o=r.value);const h=a.value;if(!s(h))return a.issues.push({expected:"object",code:"invalid_type",input:h,inst:e}),a;a.value={};const l=[],u=o.shape;for(const f of o.keys){const d=u[f],p=d._zod.optout==="optional",m=d._zod.run({value:h[f],issues:[]},c);m instanceof Promise?l.push(m.then(g=>is(g,a,f,h,p))):is(m,a,f,h,p)}return i?ju(l,h,a,c,r.value,e):l.length?Promise.all(l).then(()=>a):a}}),Vb=S("$ZodObjectJIT",(e,t)=>{Wb.init(e,t);const n=e._zod.parse,r=Zo(()=>Gu(t)),s=f=>{const d=new db(["shape","payload","ctx"]),p=r.value,m=b=>{const _=kc(b);return`shape[${_}]._zod.run({ value: input[${_}], issues: [] }, ctx)`};d.write("const input = payload.value;");const g=Object.create(null);let y=0;for(const b of p.keys)g[b]=`key_${y++}`;d.write("const newResult = {};");for(const b of p.keys){const _=g[b],v=kc(b),A=f[b]?._zod?.optout==="optional";d.write(`const ${_} = ${m(b)};`),A?d.write(`
        if (${_}.issues.length) {
          if (${v} in input) {
            payload.issues = payload.issues.concat(${_}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${v}, ...iss.path] : [${v}]
            })));
          }
        }
        
        if (${_}.value === undefined) {
          if (${v} in input) {
            newResult[${v}] = undefined;
          }
        } else {
          newResult[${v}] = ${_}.value;
        }
        
      `):d.write(`
        if (${_}.issues.length) {
          payload.issues = payload.issues.concat(${_}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${v}, ...iss.path] : [${v}]
          })));
        }
        
        if (${_}.value === undefined) {
          if (${v} in input) {
            newResult[${v}] = undefined;
          }
        } else {
          newResult[${v}] = ${_}.value;
        }
        
      `)}d.write("payload.value = newResult;"),d.write("return payload;");const x=d.compile();return(b,_)=>x(f,b,_)};let i;const o=ss,a=!Cu.jitless,h=a&&r_.value,l=t.catchall;let u;e._zod.parse=(f,d)=>{u??(u=r.value);const p=f.value;return o(p)?a&&h&&d?.async===!1&&d.jitless!==!0?(i||(i=s(t.shape)),f=i(f,d),l?ju([],p,f,d,u,e):f):n(f,d):(f.issues.push({expected:"object",code:"invalid_type",input:p,inst:e}),f)}});function $c(e,t,n,r){for(const i of e)if(i.issues.length===0)return t.value=i.value,t;const s=e.filter(i=>!Ke(i));return s.length===1?(t.value=s[0].value,s[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(i=>i.issues.map(o=>ae(o,r,oe())))}),t)}const Zb=S("$ZodUnion",(e,t)=>{Z.init(e,t),L(e._zod,"optin",()=>t.options.some(s=>s._zod.optin==="optional")?"optional":void 0),L(e._zod,"optout",()=>t.options.some(s=>s._zod.optout==="optional")?"optional":void 0),L(e._zod,"values",()=>{if(t.options.every(s=>s._zod.values))return new Set(t.options.flatMap(s=>Array.from(s._zod.values)))}),L(e._zod,"pattern",()=>{if(t.options.every(s=>s._zod.pattern)){const s=t.options.map(i=>i._zod.pattern);return new RegExp(`^(${s.map(i=>Ho(i.source)).join("|")})$`)}});const n=t.options.length===1,r=t.options[0]._zod.run;e._zod.parse=(s,i)=>{if(n)return r(s,i);let o=!1;const a=[];for(const c of t.options){const h=c._zod.run({value:s.value,issues:[]},i);if(h instanceof Promise)a.push(h),o=!0;else{if(h.issues.length===0)return h;a.push(h)}}return o?Promise.all(a).then(c=>$c(c,s,e,i)):$c(a,s,e,i)}}),Hb=S("$ZodIntersection",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>{const s=n.value,i=t.left._zod.run({value:s,issues:[]},r),o=t.right._zod.run({value:s,issues:[]},r);return i instanceof Promise||o instanceof Promise?Promise.all([i,o]).then(([c,h])=>Rc(n,c,h)):Rc(n,i,o)}});function Hi(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(rr(e)&&rr(t)){const n=Object.keys(t),r=Object.keys(e).filter(i=>n.indexOf(i)!==-1),s={...e,...t};for(const i of r){const o=Hi(e[i],t[i]);if(!o.valid)return{valid:!1,mergeErrorPath:[i,...o.mergeErrorPath]};s[i]=o.data}return{valid:!0,data:s}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<e.length;r++){const s=e[r],i=t[r],o=Hi(s,i);if(!o.valid)return{valid:!1,mergeErrorPath:[r,...o.mergeErrorPath]};n.push(o.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Rc(e,t,n){const r=new Map;let s;for(const a of t.issues)if(a.code==="unrecognized_keys"){s??(s=a);for(const c of a.keys)r.has(c)||r.set(c,{}),r.get(c).l=!0}else e.issues.push(a);for(const a of n.issues)if(a.code==="unrecognized_keys")for(const c of a.keys)r.has(c)||r.set(c,{}),r.get(c).r=!0;else e.issues.push(a);const i=[...r].filter(([,a])=>a.l&&a.r).map(([a])=>a);if(i.length&&s&&e.issues.push({...s,keys:i}),Ke(e))return e;const o=Hi(t.value,n.value);if(!o.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(o.mergeErrorPath)}`);return e.value=o.data,e}const Nu=S("$ZodTuple",(e,t)=>{Z.init(e,t);const n=t.items;e._zod.parse=(r,s)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({input:i,inst:e,expected:"tuple",code:"invalid_type"}),r;r.value=[];const o=[],a=[...n].reverse().findIndex(l=>l._zod.optin!=="optional"),c=a===-1?0:n.length-a;if(!t.rest){const l=i.length>n.length,u=i.length<c-1;if(l||u)return r.issues.push({...l?{code:"too_big",maximum:n.length,inclusive:!0}:{code:"too_small",minimum:n.length},input:i,inst:e,origin:"array"}),r}let h=-1;for(const l of n){if(h++,h>=i.length&&h>=c)continue;const u=l._zod.run({value:i[h],issues:[]},s);u instanceof Promise?o.push(u.then(f=>Gr(f,r,h))):Gr(u,r,h)}if(t.rest){const l=i.slice(n.length);for(const u of l){h++;const f=t.rest._zod.run({value:u,issues:[]},s);f instanceof Promise?o.push(f.then(d=>Gr(d,r,h))):Gr(f,r,h)}}return o.length?Promise.all(o).then(()=>r):r}});function Gr(e,t,n){e.issues.length&&t.issues.push(...sr(n,e.issues)),t.value[n]=e.value}const Yb=S("$ZodMap",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>{const s=n.value;if(!(s instanceof Map))return n.issues.push({expected:"map",code:"invalid_type",input:s,inst:e}),n;const i=[];n.value=new Map;for(const[o,a]of s){const c=t.keyType._zod.run({value:o,issues:[]},r),h=t.valueType._zod.run({value:a,issues:[]},r);c instanceof Promise||h instanceof Promise?i.push(Promise.all([c,h]).then(([l,u])=>{Oc(l,u,n,o,s,e,r)})):Oc(c,h,n,o,s,e,r)}return i.length?Promise.all(i).then(()=>n):n}});function Oc(e,t,n,r,s,i,o){e.issues.length&&(Zi.has(typeof r)?n.issues.push(...sr(r,e.issues)):n.issues.push({code:"invalid_key",origin:"map",input:s,inst:i,issues:e.issues.map(a=>ae(a,o,oe()))})),t.issues.length&&(Zi.has(typeof r)?n.issues.push(...sr(r,t.issues)):n.issues.push({origin:"map",code:"invalid_element",input:s,inst:i,key:r,issues:t.issues.map(a=>ae(a,o,oe()))})),n.value.set(e.value,t.value)}const Xb=S("$ZodEnum",(e,t)=>{Z.init(e,t);const n=Pu(t.entries),r=new Set(n);e._zod.values=r,e._zod.pattern=new RegExp(`^(${n.filter(s=>Zi.has(typeof s)).map(s=>typeof s=="string"?dn(s):s.toString()).join("|")})$`),e._zod.parse=(s,i)=>{const o=s.value;return r.has(o)||s.issues.push({code:"invalid_value",values:n,input:o,inst:e}),s}}),qb=S("$ZodLiteral",(e,t)=>{if(Z.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(t.values);e._zod.values=n,e._zod.pattern=new RegExp(`^(${t.values.map(r=>typeof r=="string"?dn(r):r?dn(r.toString()):String(r)).join("|")})$`),e._zod.parse=(r,s)=>{const i=r.value;return n.has(i)||r.issues.push({code:"invalid_value",values:t.values,input:i,inst:e}),r}}),Kb=S("$ZodTransform",(e,t)=>{Z.init(e,t),e._zod.parse=(n,r)=>{if(r.direction==="backward")throw new Tu(e.constructor.name);const s=t.transform(n.value,n);if(r.async)return(s instanceof Promise?s:Promise.resolve(s)).then(o=>(n.value=o,n));if(s instanceof Promise)throw new nn;return n.value=s,n}});function Bc(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const Uu=S("$ZodOptional",(e,t)=>{Z.init(e,t),e._zod.optin="optional",e._zod.optout="optional",L(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),L(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${Ho(n.source)})?$`):void 0}),e._zod.parse=(n,r)=>{if(t.innerType._zod.optin==="optional"){const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(i=>Bc(i,n.value)):Bc(s,n.value)}return n.value===void 0?n:t.innerType._zod.run(n,r)}}),Jb=S("$ZodExactOptional",(e,t)=>{Uu.init(e,t),L(e._zod,"values",()=>t.innerType._zod.values),L(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(n,r)=>t.innerType._zod.run(n,r)}),Qb=S("$ZodNullable",(e,t)=>{Z.init(e,t),L(e._zod,"optin",()=>t.innerType._zod.optin),L(e._zod,"optout",()=>t.innerType._zod.optout),L(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${Ho(n.source)}|null)$`):void 0}),L(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,r)=>n.value===null?n:t.innerType._zod.run(n,r)}),tx=S("$ZodDefault",(e,t)=>{Z.init(e,t),e._zod.optin="optional",L(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);if(n.value===void 0)return n.value=t.defaultValue,n;const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(i=>Fc(i,t)):Fc(s,t)}});function Fc(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const ex=S("$ZodPrefault",(e,t)=>{Z.init(e,t),e._zod.optin="optional",L(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>(r.direction==="backward"||n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,r))}),nx=S("$ZodNonOptional",(e,t)=>{Z.init(e,t),L(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),e._zod.parse=(n,r)=>{const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(i=>Dc(i,e)):Dc(s,e)}});function Dc(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const rx=S("$ZodCatch",(e,t)=>{Z.init(e,t),L(e._zod,"optin",()=>t.innerType._zod.optin),L(e._zod,"optout",()=>t.innerType._zod.optout),L(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(i=>(n.value=i.value,i.issues.length&&(n.value=t.catchValue({...n,error:{issues:i.issues.map(o=>ae(o,r,oe()))},input:n.value}),n.issues=[]),n)):(n.value=s.value,s.issues.length&&(n.value=t.catchValue({...n,error:{issues:s.issues.map(i=>ae(i,r,oe()))},input:n.value}),n.issues=[]),n)}}),sx=S("$ZodPipe",(e,t)=>{Z.init(e,t),L(e._zod,"values",()=>t.in._zod.values),L(e._zod,"optin",()=>t.in._zod.optin),L(e._zod,"optout",()=>t.out._zod.optout),L(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,r)=>{if(r.direction==="backward"){const i=t.out._zod.run(n,r);return i instanceof Promise?i.then(o=>jr(o,t.in,r)):jr(i,t.in,r)}const s=t.in._zod.run(n,r);return s instanceof Promise?s.then(i=>jr(i,t.out,r)):jr(s,t.out,r)}});function jr(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}const ix=S("$ZodReadonly",(e,t)=>{Z.init(e,t),L(e._zod,"propValues",()=>t.innerType._zod.propValues),L(e._zod,"values",()=>t.innerType._zod.values),L(e._zod,"optin",()=>t.innerType?._zod?.optin),L(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(n,r)=>{if(r.direction==="backward")return t.innerType._zod.run(n,r);const s=t.innerType._zod.run(n,r);return s instanceof Promise?s.then(Lc):Lc(s)}});function Lc(e){return e.value=Object.freeze(e.value),e}const ox=S("$ZodFunction",(e,t)=>(Z.init(e,t),e._def=t,e._zod.def=t,e.implement=n=>{if(typeof n!="function")throw new Error("implement() must be called with a function");return function(...r){const s=e._def.input?Mc(e._def.input,r):r,i=Reflect.apply(n,this,s);return e._def.output?Mc(e._def.output,i):i}},e.implementAsync=n=>{if(typeof n!="function")throw new Error("implementAsync() must be called with a function");return async function(...r){const s=e._def.input?await Ec(e._def.input,r):r,i=await Reflect.apply(n,this,s);return e._def.output?await Ec(e._def.output,i):i}},e._zod.parse=(n,r)=>typeof n.value!="function"?(n.issues.push({code:"invalid_type",expected:"function",input:n.value,inst:e}),n):(e._def.output&&e._def.output._zod.def.type==="promise"?n.value=e.implementAsync(n.value):n.value=e.implement(n.value),n),e.input=(...n)=>{const r=e.constructor;return Array.isArray(n[0])?new r({type:"function",input:new Nu({type:"tuple",items:n[0],rest:n[1]}),output:e._def.output}):new r({type:"function",input:n[0],output:e._def.output})},e.output=n=>{const r=e.constructor;return new r({type:"function",input:e._def.input,output:n})},e)),ax=S("$ZodLazy",(e,t)=>{Z.init(e,t),L(e._zod,"innerType",()=>t.getter()),L(e._zod,"pattern",()=>e._zod.innerType?._zod?.pattern),L(e._zod,"propValues",()=>e._zod.innerType?._zod?.propValues),L(e._zod,"optin",()=>e._zod.innerType?._zod?.optin??void 0),L(e._zod,"optout",()=>e._zod.innerType?._zod?.optout??void 0),e._zod.parse=(n,r)=>e._zod.innerType._zod.run(n,r)}),cx=S("$ZodCustom",(e,t)=>{xt.init(e,t),Z.init(e,t),e._zod.parse=(n,r)=>n,e._zod.check=n=>{const r=n.value,s=t.fn(r);if(s instanceof Promise)return s.then(i=>Gc(i,n,r,e));Gc(s,n,r,e)}});function Gc(e,t,n,r){if(!e){const s={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(s.params=r._zod.def.params),t.issues.push(ir(s))}}var jc;class hx{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...n){const r=n[0];return this._map.set(t,r),r&&typeof r=="object"&&"id"in r&&this._idmap.set(r.id,t),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const r={...this.get(n)??{}};delete r.id;const s={...r,...this._map.get(t)};return Object.keys(s).length?s:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function lx(){return new hx}(jc=globalThis).__zod_globalRegistry??(jc.__zod_globalRegistry=lx());const Fn=globalThis.__zod_globalRegistry;function ux(e,t){return new e({type:"string",...z(t)})}function dx(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...z(t)})}function Nc(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...z(t)})}function fx(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...z(t)})}function px(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...z(t)})}function mx(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...z(t)})}function gx(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...z(t)})}function yx(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...z(t)})}function _x(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...z(t)})}function bx(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...z(t)})}function xx(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...z(t)})}function vx(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...z(t)})}function wx(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...z(t)})}function Sx(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...z(t)})}function Ax(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...z(t)})}function Tx(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...z(t)})}function Cx(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...z(t)})}function Px(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...z(t)})}function kx(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...z(t)})}function Mx(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...z(t)})}function Ex(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...z(t)})}function Ix(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...z(t)})}function zx(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...z(t)})}function $x(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...z(t)})}function Rx(e,t){return new e({type:"string",format:"date",check:"string_format",...z(t)})}function Ox(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...z(t)})}function Bx(e,t){return new e({type:"string",format:"duration",check:"string_format",...z(t)})}function Fx(e,t){return new e({type:"number",checks:[],...z(t)})}function Dx(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...z(t)})}function Lx(e,t){return new e({type:"boolean",...z(t)})}function Gx(e){return new e({type:"unknown"})}function jx(e,t){return new e({type:"never",...z(t)})}function Uc(e,t){return new Bu({check:"less_than",...z(t),value:e,inclusive:!1})}function di(e,t){return new Bu({check:"less_than",...z(t),value:e,inclusive:!0})}function Wc(e,t){return new Fu({check:"greater_than",...z(t),value:e,inclusive:!1})}function fi(e,t){return new Fu({check:"greater_than",...z(t),value:e,inclusive:!0})}function Vc(e,t){return new K_({check:"multiple_of",...z(t),value:e})}function Nx(e,t){return new Q_({check:"max_size",...z(t),maximum:e})}function Zc(e,t){return new tb({check:"min_size",...z(t),minimum:e})}function Ux(e,t){return new eb({check:"size_equals",...z(t),size:e})}function Wu(e,t){return new nb({check:"max_length",...z(t),maximum:e})}function os(e,t){return new rb({check:"min_length",...z(t),minimum:e})}function Vu(e,t){return new sb({check:"length_equals",...z(t),length:e})}function Wx(e,t){return new ib({check:"string_format",format:"regex",...z(t),pattern:e})}function Vx(e){return new ob({check:"string_format",format:"lowercase",...z(e)})}function Zx(e){return new ab({check:"string_format",format:"uppercase",...z(e)})}function Hx(e,t){return new cb({check:"string_format",format:"includes",...z(t),includes:e})}function Yx(e,t){return new hb({check:"string_format",format:"starts_with",...z(t),prefix:e})}function Xx(e,t){return new lb({check:"string_format",format:"ends_with",...z(t),suffix:e})}function vn(e){return new ub({check:"overwrite",tx:e})}function qx(e){return vn(t=>t.normalize(e))}function Kx(){return vn(e=>e.trim())}function Jx(){return vn(e=>e.toLowerCase())}function Qx(){return vn(e=>e.toUpperCase())}function t0(){return vn(e=>n_(e))}function e0(e,t,n){return new e({type:"array",element:t,...z(n)})}function n0(e,t,n){const r=z(n);return r.abort??(r.abort=!0),new e({type:"custom",check:"custom",fn:t,...r})}function r0(e,t,n){return new e({type:"custom",check:"custom",fn:t,...z(n)})}function s0(e){const t=i0(n=>(n.addIssue=r=>{if(typeof r=="string")n.issues.push(ir(r,n.value,t._zod.def));else{const s=r;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=n.value),s.inst??(s.inst=t),s.continue??(s.continue=!t._zod.def.abort),n.issues.push(ir(s))}},e(n.value,n)));return t}function i0(e,t){const n=new xt({check:"custom",...z(t)});return n._zod.check=e,n}function Zu(e){let t=e?.target??"draft-2020-12";return t==="draft-4"&&(t="draft-04"),t==="draft-7"&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:e?.metadata??Fn,target:t,unrepresentable:e?.unrepresentable??"throw",override:e?.override??(()=>{}),io:e?.io??"output",counter:0,seen:new Map,cycles:e?.cycles??"ref",reused:e?.reused??"inline",external:e?.external??void 0}}function ht(e,t,n={path:[],schemaPath:[]}){var r;const s=e._zod.def,i=t.seen.get(e);if(i)return i.count++,n.schemaPath.includes(e)&&(i.cycle=n.path),i.schema;const o={schema:{},count:1,cycle:void 0,path:n.path};t.seen.set(e,o);const a=e._zod.toJSONSchema?.();if(a)o.schema=a;else{const l={...n,schemaPath:[...n.schemaPath,e],path:n.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,o.schema,l);else{const f=o.schema,d=t.processors[s.type];if(!d)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${s.type}`);d(e,t,f,l)}const u=e._zod.parent;u&&(o.ref||(o.ref=u),ht(u,t,l),t.seen.get(u).isParent=!0)}const c=t.metadataRegistry.get(e);return c&&Object.assign(o.schema,c),t.io==="input"&&Tt(e)&&(delete o.schema.examples,delete o.schema.default),t.io==="input"&&o.schema._prefault&&((r=o.schema).default??(r.default=o.schema._prefault)),delete o.schema._prefault,t.seen.get(e).schema}function Hu(e,t){const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=new Map;for(const o of e.seen.entries()){const a=e.metadataRegistry.get(o[0])?.id;if(a){const c=r.get(a);if(c&&c!==o[0])throw new Error(`Duplicate schema id "${a}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);r.set(a,o[0])}}const s=o=>{const a=e.target==="draft-2020-12"?"$defs":"definitions";if(e.external){const u=e.external.registry.get(o[0])?.id,f=e.external.uri??(p=>p);if(u)return{ref:f(u)};const d=o[1].defId??o[1].schema.id??`schema${e.counter++}`;return o[1].defId=d,{defId:d,ref:`${f("__shared")}#/${a}/${d}`}}if(o[1]===n)return{ref:"#"};const h=`#/${a}/`,l=o[1].schema.id??`__schema${e.counter++}`;return{defId:l,ref:h+l}},i=o=>{if(o[1].schema.$ref)return;const a=o[1],{ref:c,defId:h}=s(o);a.def={...a.schema},h&&(a.defId=h);const l=a.schema;for(const u in l)delete l[u];l.$ref=c};if(e.cycles==="throw")for(const o of e.seen.entries()){const a=o[1];if(a.cycle)throw new Error(`Cycle detected: #/${a.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const o of e.seen.entries()){const a=o[1];if(t===o[0]){i(o);continue}if(e.external){const h=e.external.registry.get(o[0])?.id;if(t!==o[0]&&h){i(o);continue}}if(e.metadataRegistry.get(o[0])?.id){i(o);continue}if(a.cycle){i(o);continue}if(a.count>1&&e.reused==="ref"){i(o);continue}}}function Yu(e,t){const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=o=>{const a=e.seen.get(o);if(a.ref===null)return;const c=a.def??a.schema,h={...c},l=a.ref;if(a.ref=null,l){r(l);const f=e.seen.get(l),d=f.schema;if(d.$ref&&(e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0")?(c.allOf=c.allOf??[],c.allOf.push(d)):Object.assign(c,d),Object.assign(c,h),o._zod.parent===l)for(const m in c)m==="$ref"||m==="allOf"||m in h||delete c[m];if(d.$ref&&f.def)for(const m in c)m==="$ref"||m==="allOf"||m in f.def&&JSON.stringify(c[m])===JSON.stringify(f.def[m])&&delete c[m]}const u=o._zod.parent;if(u&&u!==l){r(u);const f=e.seen.get(u);if(f?.schema.$ref&&(c.$ref=f.schema.$ref,f.def))for(const d in c)d==="$ref"||d==="allOf"||d in f.def&&JSON.stringify(c[d])===JSON.stringify(f.def[d])&&delete c[d]}e.override({zodSchema:o,jsonSchema:c,path:a.path??[]})};for(const o of[...e.seen.entries()].reverse())r(o[0]);const s={};if(e.target==="draft-2020-12"?s.$schema="https://json-schema.org/draft/2020-12/schema":e.target==="draft-07"?s.$schema="http://json-schema.org/draft-07/schema#":e.target==="draft-04"?s.$schema="http://json-schema.org/draft-04/schema#":e.target,e.external?.uri){const o=e.external.registry.get(t)?.id;if(!o)throw new Error("Schema is missing an `id` property");s.$id=e.external.uri(o)}Object.assign(s,n.def??n.schema);const i=e.external?.defs??{};for(const o of e.seen.entries()){const a=o[1];a.def&&a.defId&&(i[a.defId]=a.def)}e.external||Object.keys(i).length>0&&(e.target==="draft-2020-12"?s.$defs=i:s.definitions=i);try{const o=JSON.parse(JSON.stringify(s));return Object.defineProperty(o,"~standard",{value:{...t["~standard"],jsonSchema:{input:as(t,"input",e.processors),output:as(t,"output",e.processors)}},enumerable:!1,writable:!1}),o}catch{throw new Error("Error converting schema to JSON.")}}function Tt(e,t){const n=t??{seen:new Set};if(n.seen.has(e))return!1;n.seen.add(e);const r=e._zod.def;if(r.type==="transform")return!0;if(r.type==="array")return Tt(r.element,n);if(r.type==="set")return Tt(r.valueType,n);if(r.type==="lazy")return Tt(r.getter(),n);if(r.type==="promise"||r.type==="optional"||r.type==="nonoptional"||r.type==="nullable"||r.type==="readonly"||r.type==="default"||r.type==="prefault")return Tt(r.innerType,n);if(r.type==="intersection")return Tt(r.left,n)||Tt(r.right,n);if(r.type==="record"||r.type==="map")return Tt(r.keyType,n)||Tt(r.valueType,n);if(r.type==="pipe")return Tt(r.in,n)||Tt(r.out,n);if(r.type==="object"){for(const s in r.shape)if(Tt(r.shape[s],n))return!0;return!1}if(r.type==="union"){for(const s of r.options)if(Tt(s,n))return!0;return!1}if(r.type==="tuple"){for(const s of r.items)if(Tt(s,n))return!0;return!!(r.rest&&Tt(r.rest,n))}return!1}const o0=(e,t={})=>n=>{const r=Zu({...n,processors:t});return ht(e,r),Hu(r,e),Yu(r,e)},as=(e,t,n={})=>r=>{const{libraryOptions:s,target:i}=r??{},o=Zu({...s??{},target:i,io:t,processors:n});return ht(e,o),Hu(o,e),Yu(o,e)},a0={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},c0=(e,t,n,r)=>{const s=n;s.type="string";const{minimum:i,maximum:o,format:a,patterns:c,contentEncoding:h}=e._zod.bag;if(typeof i=="number"&&(s.minLength=i),typeof o=="number"&&(s.maxLength=o),a&&(s.format=a0[a]??a,s.format===""&&delete s.format,a==="time"&&delete s.format),h&&(s.contentEncoding=h),c&&c.size>0){const l=[...c];l.length===1?s.pattern=l[0].source:l.length>1&&(s.allOf=[...l.map(u=>({...t.target==="draft-07"||t.target==="draft-04"||t.target==="openapi-3.0"?{type:"string"}:{},pattern:u.source}))])}},h0=(e,t,n,r)=>{const s=n,{minimum:i,maximum:o,format:a,multipleOf:c,exclusiveMaximum:h,exclusiveMinimum:l}=e._zod.bag;typeof a=="string"&&a.includes("int")?s.type="integer":s.type="number",typeof l=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(s.minimum=l,s.exclusiveMinimum=!0):s.exclusiveMinimum=l),typeof i=="number"&&(s.minimum=i,typeof l=="number"&&t.target!=="draft-04"&&(l>=i?delete s.minimum:delete s.exclusiveMinimum)),typeof h=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(s.maximum=h,s.exclusiveMaximum=!0):s.exclusiveMaximum=h),typeof o=="number"&&(s.maximum=o,typeof h=="number"&&t.target!=="draft-04"&&(h<=o?delete s.maximum:delete s.exclusiveMaximum)),typeof c=="number"&&(s.multipleOf=c)},l0=(e,t,n,r)=>{n.type="boolean"},u0=(e,t,n,r)=>{n.not={}},d0=(e,t,n,r)=>{},f0=(e,t,n,r)=>{const s=e._zod.def,i=Pu(s.entries);i.every(o=>typeof o=="number")&&(n.type="number"),i.every(o=>typeof o=="string")&&(n.type="string"),n.enum=i},p0=(e,t,n,r)=>{const s=e._zod.def,i=[];for(const o of s.values)if(o===void 0){if(t.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof o=="bigint"){if(t.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");i.push(Number(o))}else i.push(o);if(i.length!==0)if(i.length===1){const o=i[0];n.type=o===null?"null":typeof o,t.target==="draft-04"||t.target==="openapi-3.0"?n.enum=[o]:n.const=o}else i.every(o=>typeof o=="number")&&(n.type="number"),i.every(o=>typeof o=="string")&&(n.type="string"),i.every(o=>typeof o=="boolean")&&(n.type="boolean"),i.every(o=>o===null)&&(n.type="null"),n.enum=i},m0=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},g0=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Function types cannot be represented in JSON Schema")},y0=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},_0=(e,t,n,r)=>{if(t.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema")},b0=(e,t,n,r)=>{const s=n,i=e._zod.def,{minimum:o,maximum:a}=e._zod.bag;typeof o=="number"&&(s.minItems=o),typeof a=="number"&&(s.maxItems=a),s.type="array",s.items=ht(i.element,t,{...r,path:[...r.path,"items"]})},x0=(e,t,n,r)=>{const s=n,i=e._zod.def;s.type="object",s.properties={};const o=i.shape;for(const h in o)s.properties[h]=ht(o[h],t,{...r,path:[...r.path,"properties",h]});const a=new Set(Object.keys(o)),c=new Set([...a].filter(h=>{const l=i.shape[h]._zod;return t.io==="input"?l.optin===void 0:l.optout===void 0}));c.size>0&&(s.required=Array.from(c)),i.catchall?._zod.def.type==="never"?s.additionalProperties=!1:i.catchall?i.catchall&&(s.additionalProperties=ht(i.catchall,t,{...r,path:[...r.path,"additionalProperties"]})):t.io==="output"&&(s.additionalProperties=!1)},v0=(e,t,n,r)=>{const s=e._zod.def,i=s.inclusive===!1,o=s.options.map((a,c)=>ht(a,t,{...r,path:[...r.path,i?"oneOf":"anyOf",c]}));i?n.oneOf=o:n.anyOf=o},w0=(e,t,n,r)=>{const s=e._zod.def,i=ht(s.left,t,{...r,path:[...r.path,"allOf",0]}),o=ht(s.right,t,{...r,path:[...r.path,"allOf",1]}),a=h=>"allOf"in h&&Object.keys(h).length===1,c=[...a(i)?i.allOf:[i],...a(o)?o.allOf:[o]];n.allOf=c},S0=(e,t,n,r)=>{const s=n,i=e._zod.def;s.type="array";const o=t.target==="draft-2020-12"?"prefixItems":"items",a=t.target==="draft-2020-12"||t.target==="openapi-3.0"?"items":"additionalItems",c=i.items.map((f,d)=>ht(f,t,{...r,path:[...r.path,o,d]})),h=i.rest?ht(i.rest,t,{...r,path:[...r.path,a,...t.target==="openapi-3.0"?[i.items.length]:[]]}):null;t.target==="draft-2020-12"?(s.prefixItems=c,h&&(s.items=h)):t.target==="openapi-3.0"?(s.items={anyOf:c},h&&s.items.anyOf.push(h),s.minItems=c.length,h||(s.maxItems=c.length)):(s.items=c,h&&(s.additionalItems=h));const{minimum:l,maximum:u}=e._zod.bag;typeof l=="number"&&(s.minItems=l),typeof u=="number"&&(s.maxItems=u)},A0=(e,t,n,r)=>{const s=e._zod.def,i=ht(s.innerType,t,r),o=t.seen.get(e);t.target==="openapi-3.0"?(o.ref=s.innerType,n.nullable=!0):n.anyOf=[i,{type:"null"}]},T0=(e,t,n,r)=>{const s=e._zod.def;ht(s.innerType,t,r);const i=t.seen.get(e);i.ref=s.innerType},C0=(e,t,n,r)=>{const s=e._zod.def;ht(s.innerType,t,r);const i=t.seen.get(e);i.ref=s.innerType,n.default=JSON.parse(JSON.stringify(s.defaultValue))},P0=(e,t,n,r)=>{const s=e._zod.def;ht(s.innerType,t,r);const i=t.seen.get(e);i.ref=s.innerType,t.io==="input"&&(n._prefault=JSON.parse(JSON.stringify(s.defaultValue)))},k0=(e,t,n,r)=>{const s=e._zod.def;ht(s.innerType,t,r);const i=t.seen.get(e);i.ref=s.innerType;let o;try{o=s.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}n.default=o},M0=(e,t,n,r)=>{const s=e._zod.def,i=t.io==="input"?s.in._zod.def.type==="transform"?s.out:s.in:s.out;ht(i,t,r);const o=t.seen.get(e);o.ref=i},E0=(e,t,n,r)=>{const s=e._zod.def;ht(s.innerType,t,r);const i=t.seen.get(e);i.ref=s.innerType,n.readOnly=!0},Xu=(e,t,n,r)=>{const s=e._zod.def;ht(s.innerType,t,r);const i=t.seen.get(e);i.ref=s.innerType},I0=(e,t,n,r)=>{const s=e._zod.innerType;ht(s,t,r);const i=t.seen.get(e);i.ref=s},z0=S("ZodISODateTime",(e,t)=>{Tb.init(e,t),nt.init(e,t)});function $0(e){return $x(z0,e)}const R0=S("ZodISODate",(e,t)=>{Cb.init(e,t),nt.init(e,t)});function O0(e){return Rx(R0,e)}const B0=S("ZodISOTime",(e,t)=>{Pb.init(e,t),nt.init(e,t)});function F0(e){return Ox(B0,e)}const D0=S("ZodISODuration",(e,t)=>{kb.init(e,t),nt.init(e,t)});function L0(e){return Bx(D0,e)}const qu=(e,t)=>{Iu.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>p_(e,n)},flatten:{value:n=>f_(e,n)},addIssue:{value:n=>{e.issues.push(n),e.message=JSON.stringify(e.issues,Vi,2)}},addIssues:{value:n=>{e.issues.push(...n),e.message=JSON.stringify(e.issues,Vi,2)}},isEmpty:{get(){return e.issues.length===0}}})},G0=S("ZodError",qu),Lt=S("ZodError",qu,{Parent:Error}),j0=vs(Lt),N0=ws(Lt),U0=Ss(Lt),W0=As(Lt),V0=y_(Lt),Z0=__(Lt),H0=b_(Lt),Y0=x_(Lt),X0=v_(Lt),q0=w_(Lt),K0=S_(Lt),J0=A_(Lt),q=S("ZodType",(e,t)=>(Z.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:as(e,"input"),output:as(e,"output")}}),e.toJSONSchema=o0(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone(be(t,{checks:[...t.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),{parent:!0}),e.with=e.check,e.clone=(n,r)=>xe(e,n,r),e.brand=()=>e,e.register=((n,r)=>(n.add(e,r),e)),e.parse=(n,r)=>j0(e,n,r,{callee:e.parse}),e.safeParse=(n,r)=>U0(e,n,r),e.parseAsync=async(n,r)=>N0(e,n,r,{callee:e.parseAsync}),e.safeParseAsync=async(n,r)=>W0(e,n,r),e.spa=e.safeParseAsync,e.encode=(n,r)=>V0(e,n,r),e.decode=(n,r)=>Z0(e,n,r),e.encodeAsync=async(n,r)=>H0(e,n,r),e.decodeAsync=async(n,r)=>Y0(e,n,r),e.safeEncode=(n,r)=>X0(e,n,r),e.safeDecode=(n,r)=>q0(e,n,r),e.safeEncodeAsync=async(n,r)=>K0(e,n,r),e.safeDecodeAsync=async(n,r)=>J0(e,n,r),e.refine=(n,r)=>e.check(Kv(n,r)),e.superRefine=n=>e.check(Jv(n)),e.overwrite=n=>e.check(vn(n)),e.optional=()=>Xc(e),e.exactOptional=()=>Ov(e),e.nullable=()=>qc(e),e.nullish=()=>Xc(qc(e)),e.nonoptional=n=>jv(e,n),e.array=()=>Qu(e),e.or=n=>wn([e,n]),e.and=n=>Cv(e,n),e.transform=n=>Kc(e,$v(n)),e.default=n=>Dv(e,n),e.prefault=n=>Gv(e,n),e.catch=n=>Uv(e,n),e.pipe=n=>Kc(e,n),e.readonly=()=>Zv(e),e.describe=n=>{const r=e.clone();return Fn.add(r,{description:n}),r},Object.defineProperty(e,"description",{get(){return Fn.get(e)?.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return Fn.get(e);const r=e.clone();return Fn.add(r,n[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=n=>n(e),e)),Ku=S("_ZodString",(e,t)=>{qo.init(e,t),q.init(e,t),e._zod.processJSONSchema=(r,s,i)=>c0(e,r,s);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...r)=>e.check(Wx(...r)),e.includes=(...r)=>e.check(Hx(...r)),e.startsWith=(...r)=>e.check(Yx(...r)),e.endsWith=(...r)=>e.check(Xx(...r)),e.min=(...r)=>e.check(os(...r)),e.max=(...r)=>e.check(Wu(...r)),e.length=(...r)=>e.check(Vu(...r)),e.nonempty=(...r)=>e.check(os(1,...r)),e.lowercase=r=>e.check(Vx(r)),e.uppercase=r=>e.check(Zx(r)),e.trim=()=>e.check(Kx()),e.normalize=(...r)=>e.check(qx(...r)),e.toLowerCase=()=>e.check(Jx()),e.toUpperCase=()=>e.check(Qx()),e.slugify=()=>e.check(t0())}),Q0=S("ZodString",(e,t)=>{qo.init(e,t),Ku.init(e,t),e.email=n=>e.check(dx(tv,n)),e.url=n=>e.check(yx(ev,n)),e.jwt=n=>e.check(zx(gv,n)),e.emoji=n=>e.check(_x(nv,n)),e.guid=n=>e.check(Nc(Hc,n)),e.uuid=n=>e.check(fx(Nr,n)),e.uuidv4=n=>e.check(px(Nr,n)),e.uuidv6=n=>e.check(mx(Nr,n)),e.uuidv7=n=>e.check(gx(Nr,n)),e.nanoid=n=>e.check(bx(rv,n)),e.guid=n=>e.check(Nc(Hc,n)),e.cuid=n=>e.check(xx(sv,n)),e.cuid2=n=>e.check(vx(iv,n)),e.ulid=n=>e.check(wx(ov,n)),e.base64=n=>e.check(Mx(fv,n)),e.base64url=n=>e.check(Ex(pv,n)),e.xid=n=>e.check(Sx(av,n)),e.ksuid=n=>e.check(Ax(cv,n)),e.ipv4=n=>e.check(Tx(hv,n)),e.ipv6=n=>e.check(Cx(lv,n)),e.cidrv4=n=>e.check(Px(uv,n)),e.cidrv6=n=>e.check(kx(dv,n)),e.e164=n=>e.check(Ix(mv,n)),e.datetime=n=>e.check($0(n)),e.date=n=>e.check(O0(n)),e.time=n=>e.check(F0(n)),e.duration=n=>e.check(L0(n))});function jt(e){return ux(Q0,e)}const nt=S("ZodStringFormat",(e,t)=>{tt.init(e,t),Ku.init(e,t)}),tv=S("ZodEmail",(e,t)=>{gb.init(e,t),nt.init(e,t)}),Hc=S("ZodGUID",(e,t)=>{pb.init(e,t),nt.init(e,t)}),Nr=S("ZodUUID",(e,t)=>{mb.init(e,t),nt.init(e,t)}),ev=S("ZodURL",(e,t)=>{yb.init(e,t),nt.init(e,t)}),nv=S("ZodEmoji",(e,t)=>{_b.init(e,t),nt.init(e,t)}),rv=S("ZodNanoID",(e,t)=>{bb.init(e,t),nt.init(e,t)}),sv=S("ZodCUID",(e,t)=>{xb.init(e,t),nt.init(e,t)}),iv=S("ZodCUID2",(e,t)=>{vb.init(e,t),nt.init(e,t)}),ov=S("ZodULID",(e,t)=>{wb.init(e,t),nt.init(e,t)}),av=S("ZodXID",(e,t)=>{Sb.init(e,t),nt.init(e,t)}),cv=S("ZodKSUID",(e,t)=>{Ab.init(e,t),nt.init(e,t)}),hv=S("ZodIPv4",(e,t)=>{Mb.init(e,t),nt.init(e,t)}),lv=S("ZodIPv6",(e,t)=>{Eb.init(e,t),nt.init(e,t)}),uv=S("ZodCIDRv4",(e,t)=>{Ib.init(e,t),nt.init(e,t)}),dv=S("ZodCIDRv6",(e,t)=>{zb.init(e,t),nt.init(e,t)}),fv=S("ZodBase64",(e,t)=>{$b.init(e,t),nt.init(e,t)}),pv=S("ZodBase64URL",(e,t)=>{Ob.init(e,t),nt.init(e,t)}),mv=S("ZodE164",(e,t)=>{Bb.init(e,t),nt.init(e,t)}),gv=S("ZodJWT",(e,t)=>{Db.init(e,t),nt.init(e,t)}),Ju=S("ZodNumber",(e,t)=>{Lu.init(e,t),q.init(e,t),e._zod.processJSONSchema=(r,s,i)=>h0(e,r,s),e.gt=(r,s)=>e.check(Wc(r,s)),e.gte=(r,s)=>e.check(fi(r,s)),e.min=(r,s)=>e.check(fi(r,s)),e.lt=(r,s)=>e.check(Uc(r,s)),e.lte=(r,s)=>e.check(di(r,s)),e.max=(r,s)=>e.check(di(r,s)),e.int=r=>e.check(Yc(r)),e.safe=r=>e.check(Yc(r)),e.positive=r=>e.check(Wc(0,r)),e.nonnegative=r=>e.check(fi(0,r)),e.negative=r=>e.check(Uc(0,r)),e.nonpositive=r=>e.check(di(0,r)),e.multipleOf=(r,s)=>e.check(Vc(r,s)),e.step=(r,s)=>e.check(Vc(r,s)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function bt(e){return Fx(Ju,e)}const yv=S("ZodNumberFormat",(e,t)=>{Lb.init(e,t),Ju.init(e,t)});function Yc(e){return Dx(yv,e)}const _v=S("ZodBoolean",(e,t)=>{Gb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>l0(e,n,r)});function Ko(e){return Lx(_v,e)}const bv=S("ZodUnknown",(e,t)=>{jb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>d0()});function fn(){return Gx(bv)}const xv=S("ZodNever",(e,t)=>{Nb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>u0(e,n,r)});function vv(e){return jx(xv,e)}const wv=S("ZodArray",(e,t)=>{Ub.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>b0(e,n,r,s),e.element=t.element,e.min=(n,r)=>e.check(os(n,r)),e.nonempty=n=>e.check(os(1,n)),e.max=(n,r)=>e.check(Wu(n,r)),e.length=(n,r)=>e.check(Vu(n,r)),e.unwrap=()=>e.element});function Qu(e,t){return e0(wv,e,t)}const Sv=S("ZodObject",(e,t)=>{Vb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>x0(e,n,r,s),L(e,"shape",()=>t.shape),e.keyof=()=>Vt(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:fn()}),e.loose=()=>e.clone({...e._zod.def,catchall:fn()}),e.strict=()=>e.clone({...e._zod.def,catchall:vv()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>c_(e,n),e.safeExtend=n=>h_(e,n),e.merge=n=>l_(e,n),e.pick=n=>o_(e,n),e.omit=n=>a_(e,n),e.partial=(...n)=>u_(td,e,n[0]),e.required=(...n)=>d_(ed,e,n[0])});function dt(e,t){const n={type:"object",shape:e??{},...z(t)};return new Sv(n)}const Av=S("ZodUnion",(e,t)=>{Zb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>v0(e,n,r,s),e.options=t.options});function wn(e,t){return new Av({type:"union",options:e,...z(t)})}const Tv=S("ZodIntersection",(e,t)=>{Hb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>w0(e,n,r,s)});function Cv(e,t){return new Tv({type:"intersection",left:e,right:t})}const Pv=S("ZodTuple",(e,t)=>{Nu.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>S0(e,n,r,s),e.rest=n=>e.clone({...e._zod.def,rest:n})});function kv(e,t,n){const r=t instanceof Z,s=r?n:t,i=r?t:null;return new Pv({type:"tuple",items:e,rest:i,...z(s)})}const Mv=S("ZodMap",(e,t)=>{Yb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>_0(e,n),e.keyType=t.keyType,e.valueType=t.valueType,e.min=(...n)=>e.check(Zc(...n)),e.nonempty=n=>e.check(Zc(1,n)),e.max=(...n)=>e.check(Nx(...n)),e.size=(...n)=>e.check(Ux(...n))});function Ev(e,t,n){return new Mv({type:"map",keyType:e,valueType:t,...z(n)})}const Yi=S("ZodEnum",(e,t)=>{Xb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(r,s,i)=>f0(e,r,s),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(r,s)=>{const i={};for(const o of r)if(n.has(o))i[o]=t.entries[o];else throw new Error(`Key ${o} not found in enum`);return new Yi({...t,checks:[],...z(s),entries:i})},e.exclude=(r,s)=>{const i={...t.entries};for(const o of r)if(n.has(o))delete i[o];else throw new Error(`Key ${o} not found in enum`);return new Yi({...t,checks:[],...z(s),entries:i})}});function Vt(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(r=>[r,r])):e;return new Yi({type:"enum",entries:n,...z(t)})}const Iv=S("ZodLiteral",(e,t)=>{qb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>p0(e,n,r),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function Jo(e,t){return new Iv({type:"literal",values:Array.isArray(e)?e:[e],...z(t)})}const zv=S("ZodTransform",(e,t)=>{Kb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>y0(e,n),e._zod.parse=(n,r)=>{if(r.direction==="backward")throw new Tu(e.constructor.name);n.addIssue=i=>{if(typeof i=="string")n.issues.push(ir(i,n.value,t));else{const o=i;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=n.value),o.inst??(o.inst=e),n.issues.push(ir(o))}};const s=t.transform(n.value,n);return s instanceof Promise?s.then(i=>(n.value=i,n)):(n.value=s,n)}});function $v(e){return new zv({type:"transform",transform:e})}const td=S("ZodOptional",(e,t)=>{Uu.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Xu(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function Xc(e){return new td({type:"optional",innerType:e})}const Rv=S("ZodExactOptional",(e,t)=>{Jb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>Xu(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function Ov(e){return new Rv({type:"optional",innerType:e})}const Bv=S("ZodNullable",(e,t)=>{Qb.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>A0(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function qc(e){return new Bv({type:"nullable",innerType:e})}const Fv=S("ZodDefault",(e,t)=>{tx.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>C0(e,n,r,s),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Dv(e,t){return new Fv({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():Mu(t)}})}const Lv=S("ZodPrefault",(e,t)=>{ex.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>P0(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function Gv(e,t){return new Lv({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():Mu(t)}})}const ed=S("ZodNonOptional",(e,t)=>{nx.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>T0(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function jv(e,t){return new ed({type:"nonoptional",innerType:e,...z(t)})}const Nv=S("ZodCatch",(e,t)=>{rx.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>k0(e,n,r,s),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Uv(e,t){return new Nv({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Wv=S("ZodPipe",(e,t)=>{sx.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>M0(e,n,r,s),e.in=t.in,e.out=t.out});function Kc(e,t){return new Wv({type:"pipe",in:e,out:t})}const Vv=S("ZodReadonly",(e,t)=>{ix.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>E0(e,n,r,s),e.unwrap=()=>e._zod.def.innerType});function Zv(e){return new Vv({type:"readonly",innerType:e})}const Hv=S("ZodLazy",(e,t)=>{ax.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>I0(e,n,r,s),e.unwrap=()=>e._zod.def.getter()});function Yv(e){return new Hv({type:"lazy",getter:e})}const Xv=S("ZodFunction",(e,t)=>{ox.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>g0(e,n)});function qv(e){return new Xv({type:"function",input:Array.isArray(e?.input)?kv(e?.input):Qu(fn()),output:fn()})}const nd=S("ZodCustom",(e,t)=>{cx.init(e,t),q.init(e,t),e._zod.processJSONSchema=(n,r,s)=>m0(e,n)});function Je(e,t){return n0(nd,(()=>!0),t)}function Kv(e,t={}){return r0(nd,e,t)}function Jv(e){return s0(e)}const Qv=jt().refine(e=>/^[a-zA-Z0-9.*:-]+$/.test(e),{message:"Style key must contain only alphanumeric characters, dots, colons, hyphens, and asterisks"}),rd="*",Jc="*";function Qc(e){return[...e].sort()}function tw(e,t){return e===rd||e===t}function ew(e,t,n,r){if(e.length!==n.length)return null;let s=0;for(let a=0;a<e.length;a++){if(!tw(e[a],n[a]))return null;e[a]!==rd&&s++}let i=0;if(t.length===1&&t[0]===Jc)i=0;else if(t.length===0&&r.length===0)i=0;else if(t.length===0&&r.length>0)i=0;else{if(t.length>r.length)return null;for(const a of t)if(a!==Jc){if(!r.includes(a))return null;i++}}return{score:s*100+i,matchingNouns:s,matchingStates:i}}class nw{constructor(t={}){this.styles=new Map,this.options={validateKeys:t.validateKeys??!0,autoSortStates:t.autoSortStates??!0}}set(t,n,r){const{nounKey:s,stateKey:i}=this.buildKeys(t,n);if(this.options.validateKeys){const a=i?`${s}:${i}`:s;Qv.parse(a)}let o=this.styles.get(s);if(o||(o=new Map,this.styles.set(s,o)),o.has(i)){const a=i?`${s}:${i}`:s;console.warn(`StyleTree: Overwriting existing key "${a}"`)}o.set(i,r)}get(t,n){const{nounKey:r,stateKey:s}=this.buildKeys(t,n);return this.styles.get(r)?.get(s)}has(t,n){const{nounKey:r,stateKey:s}=this.buildKeys(t,n);return this.styles.get(r)?.has(s)??!1}buildKeys(t,n){const r=t,i=(this.options.autoSortStates?Qc(n):n).join("-");return{nounKey:r,stateKey:i}}get size(){let t=0;for(const n of this.styles.values())t+=n.size;return t}*keys(){for(const[t,n]of this.styles.entries())for(const r of n.keys())yield r?`${t}:${r}`:t}*values(){for(const t of this.styles.values())yield*t.values()}*entries(){for(const[t,n]of this.styles.entries())for(const[r,s]of n.entries())yield[r?`${t}:${r}`:t,s]}match(t){return this.findBestMatch(t)?.value}findBestMatch(t){const n=this.findAllMatches(t);return n.length>0?n[0]:void 0}findAllMatches(t){const n=t.nouns,r=t.states,s=Qc(r),i=[];for(const[o,a]of this.styles.entries()){const c=o.split(".");for(const[h,l]of a.entries()){const u=h===""?[]:h.split("-"),f=ew(c,u,n,s);if(f){const d=h?`${o}:${h}`:o;i.push({key:d,value:l,score:f.score,matchingNouns:f.matchingNouns,matchingStates:f.matchingStates})}}}return i.sort((o,a)=>a.score-o.score),i}}const rw="<",sw="|",iw=">",ow="<>",aw="x",cw="y",hw="s",lw="c",uw="e",dw="f",Xi="px",sd="%",id="/",fw=Object.freeze({X:aw,Y:cw}),pw=Object.freeze({START:hw,CENTER:lw,END:uw,FILL:dw}),mw=Object.freeze({START_SYMBOL:rw,CENTER_SYMBOL:sw,END_SYMBOL:iw,FILL_SYMBOL:ow}),od=Object.freeze({PX:Xi,PERCENT:sd}),ad=Object.freeze({...od,FRACTION:id}),Cs=Object.freeze({PX:Xi,PIXELS:Xi,PERCENT:sd,FRACTION:id});function yr(e){const t=[...new Set(Object.values(e))];if(!t.length)throw new Error("dictionary must contain at least one value");return t}Vt(yr(od));const gw=Jo(ad.FRACTION);Vt(yr(ad));const yw=bt().finite(),_w=bt().finite(),bw=dt({mode:Jo(Cs.PX),value:bt().finite()}),xw=dt({mode:Jo(Cs.PERCENT),value:bt().finite().refine(e=>e>=0&&e<=1,{message:"% value must be between 0 and 1"})}),vw=wn([bw,xw]),ww=dt({mode:gw,value:yw,base:_w}).refine(({base:e,value:t})=>e>=t,{message:"/ base must be >= value"}).refine(({base:e})=>e>0,{message:"/ base must be > 0"}),Sw=ww.transform(e=>({mode:Cs.PERCENT,value:e.value/e.base})),Aw=wn([vw,Sw]),Tw=wn([bt().finite(),Aw]).transform(e=>typeof e=="number"?{mode:Cs.PX,value:e}:e),qi=Tw,Ki=bt().finite(),Ji=dt({min:Ki.optional(),max:Ki.optional()});Vt(yr(fw));const cd=Vt(["row","column"]),Cw=Vt(["text","url"]),Qo=dt({type:Cw,value:jt()}),Qi=Vt(yr(pw)),Pw=Vt(yr(mw)),to=wn([Qi,Pw]),hd=dt({x:bt().finite().default(0),y:bt().finite().default(0)}),kw=dt({width:qi.default({mode:"px",value:0}),height:qi.default({mode:"px",value:0})}),Mw=["s","c","e"],Ew=["<","|",">"],or=Vt(Mw),Iw=Vt(Ew),eo=wn([or,Iw]);dt({px:or.default("s"),py:or.default("s")});const ld=hd.merge(kw).extend({px:or.default("s"),py:or.default("s")}),th=qi,zw=dt({x:bt().finite().optional(),y:bt().finite().optional(),width:th.optional(),height:th.optional(),px:eo.optional(),py:eo.optional()});hd.merge(dt({width:bt().finite(),height:bt().finite()}));const ud=dt({x:Qi.default("s"),y:Qi.default("s"),direction:cd.default("column")}),$w=ud,Rw=dt({x:to.optional(),y:to.optional(),direction:cd.optional()}),eh=dt({min:fn().optional(),max:fn().optional()}),Ow=dt({x:Ji.optional(),y:Ji.optional()}),Bw=Ow,dd=dt({area:ld,align:ud,content:Qo.optional(),order:bt().finite().default(0),absolute:Ko().default(!1),constrain:Bw.optional(),style:Je().optional(),id:jt().optional()}),Fw=dd,ta=Yv(()=>dd.extend({children:Ev(jt(),ta).optional()})),Dw=dt({x:eh.optional(),y:eh.optional()}).optional(),Lw=dt({area:zw.optional(),align:Rw.optional(),content:Qo.optional(),order:bt().finite().optional(),absolute:Ko().optional(),constrain:Dw,style:Je().optional(),id:jt().optional()});var no=function(e,t){return no=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},no(e,t)};function Sn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");no(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function ro(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function so(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function io(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function Xt(e){return typeof e=="function"}function fd(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var pi=fd(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function oo(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Ps=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,s,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=ro(o),c=a.next();!c.done;c=a.next()){var h=c.value;h.remove(this)}}catch(m){t={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}else o.remove(this);var l=this.initialTeardown;if(Xt(l))try{l()}catch(m){i=m instanceof pi?m.errors:[m]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var f=ro(u),d=f.next();!d.done;d=f.next()){var p=d.value;try{nh(p)}catch(m){i=i??[],m instanceof pi?i=io(io([],so(i)),so(m.errors)):i.push(m)}}}catch(m){r={error:m}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(r)throw r.error}}}if(i)throw new pi(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)nh(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&oo(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&oo(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})(),pd=Ps.EMPTY;function md(e){return e instanceof Ps||e&&"closed"in e&&Xt(e.remove)&&Xt(e.add)&&Xt(e.unsubscribe)}function nh(e){Xt(e)?e():e.unsubscribe()}var Gw={Promise:void 0},jw={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,io([e,t],so(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Nw(e){jw.setTimeout(function(){throw e})}function rh(){}function Kr(e){e()}var ea=(function(e){Sn(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,md(n)&&n.add(r)):r.destination=Vw,r}return t.create=function(n,r,s){return new ao(n,r,s)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})(Ps),Uw=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Ur(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Ur(r)}else Ur(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Ur(n)}},e})(),ao=(function(e){Sn(t,e);function t(n,r,s){var i=e.call(this)||this,o;return Xt(n)||!n?o={next:n??void 0,error:r??void 0,complete:s??void 0}:o=n,i.destination=new Uw(o),i}return t})(ea);function Ur(e){Nw(e)}function Ww(e){throw e}var Vw={closed:!0,next:rh,error:Ww,complete:rh},Zw=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function Hw(e){return e}function Yw(e){return e.length===0?Hw:e.length===1?e[0]:function(n){return e.reduce(function(r,s){return s(r)},n)}}var sh=(function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var s=this,i=qw(t)?t:new ao(t,n,r);return Kr(function(){var o=s,a=o.operator,c=o.source;i.add(a?a.call(i,c):c?s._subscribe(i):s._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=ih(n),new n(function(s,i){var o=new ao({next:function(a){try{t(a)}catch(c){i(c),o.unsubscribe()}},error:i,complete:s});r.subscribe(o)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[Zw]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Yw(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=ih(t),new t(function(r,s){var i;n.subscribe(function(o){return i=o},function(o){return s(o)},function(){return r(i)})})},e.create=function(t){return new e(t)},e})();function ih(e){var t;return(t=e??Gw.Promise)!==null&&t!==void 0?t:Promise}function Xw(e){return e&&Xt(e.next)&&Xt(e.error)&&Xt(e.complete)}function qw(e){return e&&e instanceof ea||Xw(e)&&md(e)}function Kw(e){return Xt(e?.lift)}function Jw(e){return function(t){if(Kw(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Qw(e,t,n,r,s){return new tS(e,t,n,r,s)}var tS=(function(e){Sn(t,e);function t(n,r,s,i,o,a){var c=e.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=r?function(h){try{r(h)}catch(l){n.error(l)}}:e.prototype._next,c._error=i?function(h){try{i(h)}catch(l){n.error(l)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=s?function(){try{s()}catch(h){n.error(h)}finally{this.unsubscribe()}}:e.prototype._complete,c}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t})(ea),eS=fd(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ks=(function(e){Sn(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new oh(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new eS},t.prototype.next=function(n){var r=this;Kr(function(){var s,i;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=ro(r.currentObservers),a=o.next();!a.done;a=o.next()){var c=a.value;c.next(n)}}catch(h){s={error:h}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}}})},t.prototype.error=function(n){var r=this;Kr(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},t.prototype.complete=function(){var n=this;Kr(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,s=this,i=s.hasError,o=s.isStopped,a=s.observers;return i||o?pd:(this.currentObservers=null,a.push(n),new Ps(function(){r.currentObservers=null,oo(a,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,i=r.thrownError,o=r.isStopped;s?n.error(i):o&&n.complete()},t.prototype.asObservable=function(){var n=new sh;return n.source=this,n},t.create=function(n,r){return new oh(n,r)},t})(sh),oh=(function(e){Sn(t,e);function t(n,r){var s=e.call(this)||this;return s.destination=n,s.source=r,s}return t.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},t.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:pd},t})(ks),ah=(function(e){Sn(t,e);function t(n){var r=e.call(this)||this;return r._value=n,r}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(n){var r=e.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},t.prototype.getValue=function(){var n=this,r=n.hasError,s=n.thrownError,i=n._value;if(r)throw s;return this._throwIfClosed(),i},t.prototype.next=function(n){e.prototype.next.call(this,this._value=n)},t})(ks);function nS(e,t){return Jw(function(n,r){var s=0;n.subscribe(Qw(r,function(i){r.next(e.call(t,i,s++))}))})}var gd=typeof global=="object"&&global&&global.Object===Object&&global,rS=typeof self=="object"&&self&&self.Object===Object&&self,le=gd||rS||Function("return this")(),pn=le.Symbol,yd=Object.prototype,sS=yd.hasOwnProperty,iS=yd.toString,$n=pn?pn.toStringTag:void 0;function oS(e){var t=sS.call(e,$n),n=e[$n];try{e[$n]=void 0;var r=!0}catch{}var s=iS.call(e);return r&&(t?e[$n]=n:delete e[$n]),s}var aS=Object.prototype,cS=aS.toString;function hS(e){return cS.call(e)}var lS="[object Null]",uS="[object Undefined]",ch=pn?pn.toStringTag:void 0;function _r(e){return e==null?e===void 0?uS:lS:ch&&ch in Object(e)?oS(e):hS(e)}function ar(e){return e!=null&&typeof e=="object"}var cs=Array.isArray;function _d(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var dS="[object AsyncFunction]",fS="[object Function]",pS="[object GeneratorFunction]",mS="[object Proxy]";function bd(e){if(!_d(e))return!1;var t=_r(e);return t==fS||t==pS||t==dS||t==mS}var mi=le["__core-js_shared__"],hh=(function(){var e=/[^.]+$/.exec(mi&&mi.keys&&mi.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})();function gS(e){return!!hh&&hh in e}var yS=Function.prototype,_S=yS.toString;function Ge(e){if(e!=null){try{return _S.call(e)}catch{}try{return e+""}catch{}}return""}var bS=/[\\^$.*+?()[\]{}|]/g,xS=/^\[object .+?Constructor\]$/,vS=Function.prototype,wS=Object.prototype,SS=vS.toString,AS=wS.hasOwnProperty,TS=RegExp("^"+SS.call(AS).replace(bS,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function CS(e){if(!_d(e)||gS(e))return!1;var t=bd(e)?TS:xS;return t.test(Ge(e))}function PS(e,t){return e?.[t]}function An(e,t){var n=PS(e,t);return CS(n)?n:void 0}var co=An(le,"WeakMap"),kS=9007199254740991,MS=/^(?:0|[1-9]\d*)$/;function ES(e,t){var n=typeof e;return t=t??kS,!!t&&(n=="number"||n!="symbol"&&MS.test(e))&&e>-1&&e%1==0&&e<t}function xd(e,t){return e===t||e!==e&&t!==t}var IS=9007199254740991;function vd(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=IS}function zS(e){return e!=null&&vd(e.length)&&!bd(e)}var $S=Object.prototype;function RS(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||$S;return e===n}function OS(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var BS="[object Arguments]";function lh(e){return ar(e)&&_r(e)==BS}var wd=Object.prototype,FS=wd.hasOwnProperty,DS=wd.propertyIsEnumerable,LS=lh((function(){return arguments})())?lh:function(e){return ar(e)&&FS.call(e,"callee")&&!DS.call(e,"callee")};function GS(){return!1}var Sd=typeof exports=="object"&&exports&&!exports.nodeType&&exports,uh=Sd&&typeof module=="object"&&module&&!module.nodeType&&module,jS=uh&&uh.exports===Sd,dh=jS?le.Buffer:void 0,NS=dh?dh.isBuffer:void 0,ho=NS||GS,US="[object Arguments]",WS="[object Array]",VS="[object Boolean]",ZS="[object Date]",HS="[object Error]",YS="[object Function]",XS="[object Map]",qS="[object Number]",KS="[object Object]",JS="[object RegExp]",QS="[object Set]",t1="[object String]",e1="[object WeakMap]",n1="[object ArrayBuffer]",r1="[object DataView]",s1="[object Float32Array]",i1="[object Float64Array]",o1="[object Int8Array]",a1="[object Int16Array]",c1="[object Int32Array]",h1="[object Uint8Array]",l1="[object Uint8ClampedArray]",u1="[object Uint16Array]",d1="[object Uint32Array]",K={};K[s1]=K[i1]=K[o1]=K[a1]=K[c1]=K[h1]=K[l1]=K[u1]=K[d1]=!0;K[US]=K[WS]=K[n1]=K[VS]=K[r1]=K[ZS]=K[HS]=K[YS]=K[XS]=K[qS]=K[KS]=K[JS]=K[QS]=K[t1]=K[e1]=!1;function f1(e){return ar(e)&&vd(e.length)&&!!K[_r(e)]}function p1(e){return function(t){return e(t)}}var Ad=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Kn=Ad&&typeof module=="object"&&module&&!module.nodeType&&module,m1=Kn&&Kn.exports===Ad,gi=m1&&gd.process,fh=(function(){try{var e=Kn&&Kn.require&&Kn.require("util").types;return e||gi&&gi.binding&&gi.binding("util")}catch{}})(),ph=fh&&fh.isTypedArray,Td=ph?p1(ph):f1,g1=Object.prototype,y1=g1.hasOwnProperty;function _1(e,t){var n=cs(e),r=!n&&LS(e),s=!n&&!r&&ho(e),i=!n&&!r&&!s&&Td(e),o=n||r||s||i,a=o?OS(e.length,String):[],c=a.length;for(var h in e)y1.call(e,h)&&!(o&&(h=="length"||s&&(h=="offset"||h=="parent")||i&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||ES(h,c)))&&a.push(h);return a}function b1(e,t){return function(n){return e(t(n))}}var x1=b1(Object.keys,Object),v1=Object.prototype,w1=v1.hasOwnProperty;function S1(e){if(!RS(e))return x1(e);var t=[];for(var n in Object(e))w1.call(e,n)&&n!="constructor"&&t.push(n);return t}function A1(e){return zS(e)?_1(e):S1(e)}var cr=An(Object,"create");function T1(){this.__data__=cr?cr(null):{},this.size=0}function C1(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var P1="__lodash_hash_undefined__",k1=Object.prototype,M1=k1.hasOwnProperty;function E1(e){var t=this.__data__;if(cr){var n=t[e];return n===P1?void 0:n}return M1.call(t,e)?t[e]:void 0}var I1=Object.prototype,z1=I1.hasOwnProperty;function $1(e){var t=this.__data__;return cr?t[e]!==void 0:z1.call(t,e)}var R1="__lodash_hash_undefined__";function O1(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=cr&&t===void 0?R1:t,this}function Fe(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Fe.prototype.clear=T1;Fe.prototype.delete=C1;Fe.prototype.get=E1;Fe.prototype.has=$1;Fe.prototype.set=O1;function B1(){this.__data__=[],this.size=0}function Ms(e,t){for(var n=e.length;n--;)if(xd(e[n][0],t))return n;return-1}var F1=Array.prototype,D1=F1.splice;function L1(e){var t=this.__data__,n=Ms(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():D1.call(t,n,1),--this.size,!0}function G1(e){var t=this.__data__,n=Ms(t,e);return n<0?void 0:t[n][1]}function j1(e){return Ms(this.__data__,e)>-1}function N1(e,t){var n=this.__data__,r=Ms(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function ue(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ue.prototype.clear=B1;ue.prototype.delete=L1;ue.prototype.get=G1;ue.prototype.has=j1;ue.prototype.set=N1;var hr=An(le,"Map");function U1(){this.size=0,this.__data__={hash:new Fe,map:new(hr||ue),string:new Fe}}function W1(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Es(e,t){var n=e.__data__;return W1(t)?n[typeof t=="string"?"string":"hash"]:n.map}function V1(e){var t=Es(this,e).delete(e);return this.size-=t?1:0,t}function Z1(e){return Es(this,e).get(e)}function H1(e){return Es(this,e).has(e)}function Y1(e,t){var n=Es(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function je(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}je.prototype.clear=U1;je.prototype.delete=V1;je.prototype.get=Z1;je.prototype.has=H1;je.prototype.set=Y1;function X1(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}function q1(){this.__data__=new ue,this.size=0}function K1(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function J1(e){return this.__data__.get(e)}function Q1(e){return this.__data__.has(e)}var tA=200;function eA(e,t){var n=this.__data__;if(n instanceof ue){var r=n.__data__;if(!hr||r.length<tA-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new je(r)}return n.set(e,t),this.size=n.size,this}function ye(e){var t=this.__data__=new ue(e);this.size=t.size}ye.prototype.clear=q1;ye.prototype.delete=K1;ye.prototype.get=J1;ye.prototype.has=Q1;ye.prototype.set=eA;function nA(e,t){for(var n=-1,r=e==null?0:e.length,s=0,i=[];++n<r;){var o=e[n];t(o,n,e)&&(i[s++]=o)}return i}function rA(){return[]}var sA=Object.prototype,iA=sA.propertyIsEnumerable,mh=Object.getOwnPropertySymbols,oA=mh?function(e){return e==null?[]:(e=Object(e),nA(mh(e),function(t){return iA.call(e,t)}))}:rA;function aA(e,t,n){var r=t(e);return cs(e)?r:X1(r,n(e))}function gh(e){return aA(e,A1,oA)}var lo=An(le,"DataView"),uo=An(le,"Promise"),fo=An(le,"Set"),yh="[object Map]",cA="[object Object]",_h="[object Promise]",bh="[object Set]",xh="[object WeakMap]",vh="[object DataView]",hA=Ge(lo),lA=Ge(hr),uA=Ge(uo),dA=Ge(fo),fA=Ge(co),fe=_r;(lo&&fe(new lo(new ArrayBuffer(1)))!=vh||hr&&fe(new hr)!=yh||uo&&fe(uo.resolve())!=_h||fo&&fe(new fo)!=bh||co&&fe(new co)!=xh)&&(fe=function(e){var t=_r(e),n=t==cA?e.constructor:void 0,r=n?Ge(n):"";if(r)switch(r){case hA:return vh;case lA:return yh;case uA:return _h;case dA:return bh;case fA:return xh}return t});var wh=le.Uint8Array,pA="__lodash_hash_undefined__";function mA(e){return this.__data__.set(e,pA),this}function gA(e){return this.__data__.has(e)}function hs(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new je;++t<n;)this.add(e[t])}hs.prototype.add=hs.prototype.push=mA;hs.prototype.has=gA;function yA(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function _A(e,t){return e.has(t)}var bA=1,xA=2;function Cd(e,t,n,r,s,i){var o=n&bA,a=e.length,c=t.length;if(a!=c&&!(o&&c>a))return!1;var h=i.get(e),l=i.get(t);if(h&&l)return h==t&&l==e;var u=-1,f=!0,d=n&xA?new hs:void 0;for(i.set(e,t),i.set(t,e);++u<a;){var p=e[u],m=t[u];if(r)var g=o?r(m,p,u,t,e,i):r(p,m,u,e,t,i);if(g!==void 0){if(g)continue;f=!1;break}if(d){if(!yA(t,function(y,x){if(!_A(d,x)&&(p===y||s(p,y,n,r,i)))return d.push(x)})){f=!1;break}}else if(!(p===m||s(p,m,n,r,i))){f=!1;break}}return i.delete(e),i.delete(t),f}function vA(e){var t=-1,n=Array(e.size);return e.forEach(function(r,s){n[++t]=[s,r]}),n}function wA(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var SA=1,AA=2,TA="[object Boolean]",CA="[object Date]",PA="[object Error]",kA="[object Map]",MA="[object Number]",EA="[object RegExp]",IA="[object Set]",zA="[object String]",$A="[object Symbol]",RA="[object ArrayBuffer]",OA="[object DataView]",Sh=pn?pn.prototype:void 0,yi=Sh?Sh.valueOf:void 0;function BA(e,t,n,r,s,i,o){switch(n){case OA:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case RA:return!(e.byteLength!=t.byteLength||!i(new wh(e),new wh(t)));case TA:case CA:case MA:return xd(+e,+t);case PA:return e.name==t.name&&e.message==t.message;case EA:case zA:return e==t+"";case kA:var a=vA;case IA:var c=r&SA;if(a||(a=wA),e.size!=t.size&&!c)return!1;var h=o.get(e);if(h)return h==t;r|=AA,o.set(e,t);var l=Cd(a(e),a(t),r,s,i,o);return o.delete(e),l;case $A:if(yi)return yi.call(e)==yi.call(t)}return!1}var FA=1,DA=Object.prototype,LA=DA.hasOwnProperty;function GA(e,t,n,r,s,i){var o=n&FA,a=gh(e),c=a.length,h=gh(t),l=h.length;if(c!=l&&!o)return!1;for(var u=c;u--;){var f=a[u];if(!(o?f in t:LA.call(t,f)))return!1}var d=i.get(e),p=i.get(t);if(d&&p)return d==t&&p==e;var m=!0;i.set(e,t),i.set(t,e);for(var g=o;++u<c;){f=a[u];var y=e[f],x=t[f];if(r)var b=o?r(x,y,f,t,e,i):r(y,x,f,e,t,i);if(!(b===void 0?y===x||s(y,x,n,r,i):b)){m=!1;break}g||(g=f=="constructor")}if(m&&!g){var _=e.constructor,v=t.constructor;_!=v&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof v=="function"&&v instanceof v)&&(m=!1)}return i.delete(e),i.delete(t),m}var jA=1,Ah="[object Arguments]",Th="[object Array]",Wr="[object Object]",NA=Object.prototype,Ch=NA.hasOwnProperty;function UA(e,t,n,r,s,i){var o=cs(e),a=cs(t),c=o?Th:fe(e),h=a?Th:fe(t);c=c==Ah?Wr:c,h=h==Ah?Wr:h;var l=c==Wr,u=h==Wr,f=c==h;if(f&&ho(e)){if(!ho(t))return!1;o=!0,l=!1}if(f&&!l)return i||(i=new ye),o||Td(e)?Cd(e,t,n,r,s,i):BA(e,t,c,n,r,s,i);if(!(n&jA)){var d=l&&Ch.call(e,"__wrapped__"),p=u&&Ch.call(t,"__wrapped__");if(d||p){var m=d?e.value():e,g=p?t.value():t;return i||(i=new ye),s(m,g,n,r,i)}}return f?(i||(i=new ye),GA(e,t,n,r,s,i)):!1}function Pd(e,t,n,r,s){return e===t?!0:e==null||t==null||!ar(e)&&!ar(t)?e!==e&&t!==t:UA(e,t,n,r,Pd,s)}function po(e,t){return Pd(e,t)}var kd=Symbol.for("immer-nothing"),Ph=Symbol.for("immer-draftable"),N=Symbol.for("immer-state");function Ot(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var lr=Object.getPrototypeOf;function mn(e){return!!e&&!!e[N]}function ce(e){return e?Md(e)||Array.isArray(e)||!!e[Ph]||!!e.constructor?.[Ph]||br(e)||zs(e):!1}var WA=Object.prototype.constructor.toString(),kh=new WeakMap;function Md(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let r=kh.get(n);return r===void 0&&(r=Function.toString.call(n),kh.set(n,r)),r===WA}function ur(e,t,n=!0){Is(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(s=>{t(s,e[s],e)}):e.forEach((r,s)=>t(s,r,e))}function Is(e){const t=e[N];return t?t.type_:Array.isArray(e)?1:br(e)?2:zs(e)?3:0}function mo(e,t){return Is(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ed(e,t,n){const r=Is(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function VA(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function br(e){return e instanceof Map}function zs(e){return e instanceof Set}function pt(e){return e.copy_||e.base_}function go(e,t){if(br(e))return new Map(e);if(zs(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Md(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[N];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const o=s[i],a=r[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[o]})}return Object.create(lr(e),r)}else{const r=lr(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function na(e,t=!1){return $s(e)||mn(e)||!ce(e)||(Is(e)>1&&Object.defineProperties(e,{set:Vr,add:Vr,clear:Vr,delete:Vr}),Object.freeze(e),t&&Object.values(e).forEach(n=>na(n,!0))),e}function ZA(){Ot(2)}var Vr={value:ZA};function $s(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var yo={};function De(e){const t=yo[e];return t||Ot(0,e),t}function HA(e,t){yo[e]||(yo[e]=t)}var dr;function ls(){return dr}function YA(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Mh(e,t){t&&(De("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function _o(e){bo(e),e.drafts_.forEach(XA),e.drafts_=null}function bo(e){e===dr&&(dr=e.parent_)}function Eh(e){return dr=YA(dr,e)}function XA(e){const t=e[N];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Ih(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[N].modified_&&(_o(t),Ot(4)),ce(e)&&(e=us(t,e),t.parent_||ds(t,e)),t.patches_&&De("Patches").generateReplacementPatches_(n[N].base_,e,t.patches_,t.inversePatches_)):e=us(t,n,[]),_o(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==kd?e:void 0}function us(e,t,n){if($s(t))return t;const r=e.immer_.shouldUseStrictIteration(),s=t[N];if(!s)return ur(t,(i,o)=>zh(e,s,t,i,o,n),r),t;if(s.scope_!==e)return t;if(!s.modified_)return ds(e,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const i=s.copy_;let o=i,a=!1;s.type_===3&&(o=new Set(i),i.clear(),a=!0),ur(o,(c,h)=>zh(e,s,i,c,h,n,a),r),ds(e,i,!1),n&&e.patches_&&De("Patches").generatePatches_(s,n,e.patches_,e.inversePatches_)}return s.copy_}function zh(e,t,n,r,s,i,o){if(s==null||typeof s!="object"&&!o)return;const a=$s(s);if(!(a&&!o)){if(mn(s)){const c=i&&t&&t.type_!==3&&!mo(t.assigned_,r)?i.concat(r):void 0,h=us(e,s,c);if(Ed(n,r,h),mn(h))e.canAutoFreeze_=!1;else return}else o&&n.add(s);if(ce(s)&&!a){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[r]===s&&a)return;us(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&(br(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))&&ds(e,s)}}}function ds(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&na(t,n)}function qA(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:ls(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=ra;n&&(s=[r],i=fr);const{revoke:o,proxy:a}=Proxy.revocable(s,i);return r.draft_=a,r.revoke_=o,a}var ra={get(e,t){if(t===N)return e;const n=pt(e);if(!mo(n,t))return KA(e,n,t);const r=n[t];return e.finalized_||!ce(r)?r:r===_i(e.base_,t)?(bi(e),e.copy_[t]=pr(r,e)):r},has(e,t){return t in pt(e)},ownKeys(e){return Reflect.ownKeys(pt(e))},set(e,t,n){const r=Id(pt(e),t);if(r?.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=_i(pt(e),t),i=s?.[N];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(VA(n,s)&&(n!==void 0||mo(e.base_,t)))return!0;bi(e),ne(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return _i(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,bi(e),ne(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=pt(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){Ot(11)},getPrototypeOf(e){return lr(e.base_)},setPrototypeOf(){Ot(12)}},fr={};ur(ra,(e,t)=>{fr[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});fr.deleteProperty=function(e,t){return fr.set.call(this,e,t,void 0)};fr.set=function(e,t,n){return ra.set.call(this,e[0],t,n,e[0])};function _i(e,t){const n=e[N];return(n?pt(n):e)[t]}function KA(e,t,n){const r=Id(t,n);return r?"value"in r?r.value:r.get?.call(e.draft_):void 0}function Id(e,t){if(!(t in e))return;let n=lr(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=lr(n)}}function ne(e){e.modified_||(e.modified_=!0,e.parent_&&ne(e.parent_))}function bi(e){e.copy_||(e.copy_=go(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var JA=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const o=this;return function(c=i,...h){return o.produce(c,l=>n.call(this,l,...h))}}typeof n!="function"&&Ot(6),r!==void 0&&typeof r!="function"&&Ot(7);let s;if(ce(t)){const i=Eh(this),o=pr(t,void 0);let a=!0;try{s=n(o),a=!1}finally{a?_o(i):bo(i)}return Mh(i,r),Ih(s,i)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===kd&&(s=void 0),this.autoFreeze_&&na(s,!0),r){const i=[],o=[];De("Patches").generateReplacementPatches_(t,s,i,o),r(i,o)}return s}else Ot(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(o,...a)=>this.produceWithPatches(o,c=>t(c,...a));let r,s;return[this.produce(t,n,(o,a)=>{r=o,s=a}),r,s]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){ce(e)||Ot(8),mn(e)&&(e=QA(e));const t=Eh(this),n=pr(e,void 0);return n[N].isManual_=!0,bo(t),n}finishDraft(e,t){const n=e&&e[N];(!n||!n.isManual_)&&Ot(9);const{scope_:r}=n;return Mh(r,t),Ih(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=De("Patches").applyPatches_;return mn(e)?r(e,t):this.produce(e,s=>r(s,t))}};function pr(e,t){const n=br(e)?De("MapSet").proxyMap_(e,t):zs(e)?De("MapSet").proxySet_(e,t):qA(e,t);return(t?t.scope_:ls()).drafts_.push(n),n}function QA(e){return mn(e)||Ot(10,e),zd(e)}function zd(e){if(!ce(e)||$s(e))return e;const t=e[N];let n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=go(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=go(e,!0);return ur(n,(s,i)=>{Ed(n,s,zd(i))},r),t&&(t.finalized_=!1),n}function tT(){class e extends Map{constructor(c,h){super(),this[N]={type_:2,parent_:h,scope_:h?h.scope_:ls(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:c,draft_:this,isManual_:!1,revoked_:!1}}get size(){return pt(this[N]).size}has(c){return pt(this[N]).has(c)}set(c,h){const l=this[N];return o(l),(!pt(l).has(c)||pt(l).get(c)!==h)&&(n(l),ne(l),l.assigned_.set(c,!0),l.copy_.set(c,h),l.assigned_.set(c,!0)),this}delete(c){if(!this.has(c))return!1;const h=this[N];return o(h),n(h),ne(h),h.base_.has(c)?h.assigned_.set(c,!1):h.assigned_.delete(c),h.copy_.delete(c),!0}clear(){const c=this[N];o(c),pt(c).size&&(n(c),ne(c),c.assigned_=new Map,ur(c.base_,h=>{c.assigned_.set(h,!1)}),c.copy_.clear())}forEach(c,h){const l=this[N];pt(l).forEach((u,f,d)=>{c.call(h,this.get(f),f,this)})}get(c){const h=this[N];o(h);const l=pt(h).get(c);if(h.finalized_||!ce(l)||l!==h.base_.get(c))return l;const u=pr(l,h);return n(h),h.copy_.set(c,u),u}keys(){return pt(this[N]).keys()}values(){const c=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const h=c.next();return h.done?h:{done:!1,value:this.get(h.value)}}}}entries(){const c=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const h=c.next();if(h.done)return h;const l=this.get(h.value);return{done:!1,value:[h.value,l]}}}}[Symbol.iterator](){return this.entries()}}function t(a,c){return new e(a,c)}function n(a){a.copy_||(a.assigned_=new Map,a.copy_=new Map(a.base_))}class r extends Set{constructor(c,h){super(),this[N]={type_:3,parent_:h,scope_:h?h.scope_:ls(),modified_:!1,finalized_:!1,copy_:void 0,base_:c,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return pt(this[N]).size}has(c){const h=this[N];return o(h),h.copy_?!!(h.copy_.has(c)||h.drafts_.has(c)&&h.copy_.has(h.drafts_.get(c))):h.base_.has(c)}add(c){const h=this[N];return o(h),this.has(c)||(i(h),ne(h),h.copy_.add(c)),this}delete(c){if(!this.has(c))return!1;const h=this[N];return o(h),i(h),ne(h),h.copy_.delete(c)||(h.drafts_.has(c)?h.copy_.delete(h.drafts_.get(c)):!1)}clear(){const c=this[N];o(c),pt(c).size&&(i(c),ne(c),c.copy_.clear())}values(){const c=this[N];return o(c),i(c),c.copy_.values()}entries(){const c=this[N];return o(c),i(c),c.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(c,h){const l=this.values();let u=l.next();for(;!u.done;)c.call(h,u.value,u.value,this),u=l.next()}}function s(a,c){return new r(a,c)}function i(a){a.copy_||(a.copy_=new Set,a.base_.forEach(c=>{if(ce(c)){const h=pr(c,a);a.drafts_.set(c,h),a.copy_.add(h)}else a.copy_.add(c)}))}function o(a){a.revoked_&&Ot(3,JSON.stringify(pt(a)))}HA("MapSet",{proxyMap_:t,proxySet_:s})}var eT=new JA,Jr=eT.produce;const St={scalar:"scalar",array:"array",map:"map",object:"object",set:"set",function:"function",container:"container",void:"void"},zt={undefined:"undefined",object:"object",boolean:"boolean",number:"number",bigint:"bigint",string:"string",symbol:"symbol",function:"function"},ot={string:"string",number:"number",boolean:"boolean",symbol:"symbol",array:"array",map:"map",object:"object",set:"set",null:"null",undefined:"undefined",function:"function"};class $t{constructor(t,n,r,s){this.type=t,this.form=n,this.typeOf=r,this.test=s}get family(){return[St.scalar,St.void,St.function].includes(this.form)?this.form:St.container}includes(t,n){return n?!(n!==this.typeOf||this.test&&!this.test(t)):this.includes(t,typeof t)}}const $h=[new $t(ot.undefined,St.void,zt.undefined),new $t(ot.null,St.void,zt.object,e=>e===null),new $t(ot.boolean,St.scalar,zt.boolean),new $t(ot.string,St.scalar,zt.string),new $t(ot.number,St.scalar,zt.number),new $t(ot.number,St.scalar,zt.bigint),new $t(ot.symbol,St.scalar,zt.symbol),new $t(ot.function,St.function,zt.function),new $t(ot.array,St.array,zt.object,e=>Array.isArray(e)),new $t(ot.map,St.map,zt.object,e=>e instanceof Map),new $t(ot.set,St.set,zt.object,e=>e instanceof Set),new $t(ot.object,St.object,zt.object,e=>e&&typeof e=="object")],fs=(e,t=!1)=>{if(t){const r=fs(e);if(typeof r=="object"){if(t===!0)return r.type;if(t==="type"||t==="form"||t==="typeOf"||t==="family")return r[t]}return r}const n=typeof e;for(let r=0;r<$h.length;++r){const s=$h[r];if(s.includes(e,n))return s}throw console.error("describe failure to analyze",e),new Error("cannot analyze value")};function Oe(e){return typeof e=="function"}function nT(e){return Oe(e?.lift)}function rT(e){return function(t){if(nT(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var xo=function(e,t){return xo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},xo(e,t)};function sa(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");xo(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function Rh(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function vo(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function wo(e,t,n){if(arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function sT(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var xi=sT(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Oh(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var ia=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,s,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=Rh(o),c=a.next();!c.done;c=a.next()){var h=c.value;h.remove(this)}}catch(m){t={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}else o.remove(this);var l=this.initialTeardown;if(Oe(l))try{l()}catch(m){i=m instanceof xi?m.errors:[m]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var f=Rh(u),d=f.next();!d.done;d=f.next()){var p=d.value;try{Bh(p)}catch(m){i=i??[],m instanceof xi?i=wo(wo([],vo(i)),vo(m.errors)):i.push(m)}}}catch(m){r={error:m}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(r)throw r.error}}}if(i)throw new xi(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Bh(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&Oh(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&Oh(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})();ia.EMPTY;function iT(e){return e instanceof ia||e&&"closed"in e&&Oe(e.remove)&&Oe(e.add)&&Oe(e.unsubscribe)}function Bh(e){Oe(e)?e():e.unsubscribe()}var oT={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,wo([e,t],vo(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function aT(e){oT.setTimeout(function(){throw e})}function Fh(){}var $d=(function(e){sa(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,iT(n)&&n.add(r)):r.destination=uT,r}return t.create=function(n,r,s){return new hT(n,r,s)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})(ia),cT=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Zr(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Zr(r)}else Zr(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Zr(n)}},e})(),hT=(function(e){sa(t,e);function t(n,r,s){var i=e.call(this)||this,o;return Oe(n)||!n?o={next:n??void 0,error:r??void 0,complete:s??void 0}:o=n,i.destination=new cT(o),i}return t})($d);function Zr(e){aT(e)}function lT(e){throw e}var uT={closed:!0,next:Fh,error:lT,complete:Fh};function dT(e){return e}function fT(e,t,n,r,s){return new pT(e,t,n,r,s)}var pT=(function(e){sa(t,e);function t(n,r,s,i,o,a){var c=e.call(this,n)||this;return c.onFinalize=o,c.shouldUnsubscribe=a,c._next=r?function(h){try{r(h)}catch(l){n.error(l)}}:e.prototype._next,c._error=i?function(h){try{i(h)}catch(l){n.error(l)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=s?function(){try{s()}catch(h){n.error(h)}finally{this.unsubscribe()}}:e.prototype._complete,c}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t})($d);function Rd(e,t){return t===void 0&&(t=dT),e=e??mT,rT(function(n,r){var s,i=!0;n.subscribe(fT(r,function(o){var a=t(o);(i||!e(s,a))&&(i=!1,s=a,r.next(o))}))})}function mT(e,t){return e===t}function Dn(e){return e instanceof Error?e:e?typeof e=="string"?new Error(e):new Error("unknown / bad error in Forestry"):new Error("(unknown error in Forestry (maybe a validation $test?)")}function Od(e){return typeof e=="object"&&e!==null}function gT(e){return Od(e)&&typeof e.parse=="function"}function yT(e){return Od(e)&&"value"in e&&typeof e.next=="function"&&typeof e.subscribe=="function"}function _T(e,t){return Array.isArray(e)?e.map(n=>function(r){return n.call(t,r,t)}):function(n){return e.call(t,n,t)}}function rn(e,t){return Array.isArray(t)?t.reduce((r,s)=>{if(r==null)return;switch(fs(r,!0)){case ot.map:return r.get(s);case ot.array:{if(typeof s=="number")return r[s];const o=parseInt(s,10);return isNaN(o)?void 0:r[o]}case ot.object:return r[s];default:return}},e):rn(e,t.split("."))}function oa(e,t,n){if(!Array.isArray(t))return oa(e,t.split("."),n);const[r]=t.slice(0,t.length-1).reduce(([o],a)=>{const c=fs(o,!0);switch(c){case ot.map:return o.has(a)||o.set(a,{}),[o.get(a)];case ot.array:{if(typeof a=="number")return o[a];const h=parseInt(a,10);if(isNaN(h))throw new Error(`Invalid array index: ${a}`);return o[h]===void 0&&(o[h]={}),[o[h]]}case ot.object:return(o[a]===void 0||o[a]===null)&&(o[a]={}),[o[a]];default:throw new Error(`Cannot set nested value on type: ${c}`)}},[e]),s=t[t.length-1],i=fs(r,!0);switch(i){case ot.map:r.set(s,n);break;case ot.array:if(typeof s=="number")r[s]=n;else{const o=parseInt(s,10);if(isNaN(o))throw new Error(`Invalid array index: ${s}`);r[o]=n}break;case ot.object:r[s]=n;break;default:throw new Error(`Cannot set value on type: ${i}`)}}function Dh(e){if(Array.isArray(e))return e;if(typeof e=="string")return e.split(".");throw console.log("unparsable $path: ",e),new Error("cannot parse $path")}function pe(e){return Array.isArray(e)?e.join("."):`${e}`}function So(e,t){return Array.isArray(e)?Array.isArray(t)?e.length?t.length?[...e,...t]:e:t:So(e,Dh(t)):So(Dh(e),t)}const bT="next,isActive,value,complete".split(",");function xT(e){const t=new Set;let n=e;for(;n&&n!==Object.prototype;)Object.getOwnPropertyNames(n).forEach(r=>{if(r==="constructor"||/^\$/.test(r))return;const s=Object.getOwnPropertyDescriptor(n,r);s&&typeof s.value=="function"&&t.add(r)}),n=Object.getPrototypeOf(n);return Array.from(t)}function vT(e){return xT(e).reduce((n,r)=>(/^\$/.test(r)||bT.includes(r)||typeof e[r]!="function"||(n[r]=(...s)=>e[r].apply(e,s)),n),{})}tT();class wT{constructor(t,n=!1){n||(this.#r=new ah(t.value)),t.schema&&(this.$schema=t.schema),this.debug=!!t.debug,this.#i=t.tests?_T(t.tests,this):void 0,t.prep&&(this.#n=t.prep.bind(this),this.#r&&this.#r.next(this.prep(this.value))),t.name&&typeof t.name=="string"&&(this.#t=t.name),t.res&&t.res instanceof Map&&t.res.forEach((r,s)=>this.$res.set(s,r))}#r;get $subject(){return this.#r}debug;#n;prep(t){return this.#n?this.#n.call(this,t,this.value):t}$res=new Map;#t;get $name(){return this.#t||(this.#t="forestry-store:"+`${Math.random()}`.split(".").pop()),this.#t}complete(){if(!this.isActive)return this.value;const t=this.value;return this.isActive=!1,this.#r&&this.#r.complete(),t}isActive=!0;next(t){if(!this.isActive)throw new Error("Cannot update completed store");if(!this.#r)throw new Error("Store requires $subject -- or override of next()");const n=this.prep(t),{isValid:r,error:s}=this.$validate(n);if(r){this.#h()?this.queuePendingValue(n):this.#r.next(n);return}throw this.debug&&this.$broadcast({action:"next-error",error:s,input:t,value:n}),Dn(s)}#a(t,n){const r=t.call(this,n,this);if(r)throw Dn(r)}get suspendValidation(){return this.#e.value.some(t=>t.suspendValidation)}$transact(t,n){if(typeof t=="function"){this.$transact({action:t,suspendValidation:!!n});return}const{action:r,suspendValidation:s}=t;let i="";try{let o=function(c){return r.call(a,c)};i=this.#u(s);const a=this;o(this.value),this.#c(i)}catch(o){throw i&&this.#l(i),o}}#e=new ah([]);observeTransStack(t){return this.#e.subscribe(t)}#c(t){let n=!1;const r=this.#e.value.map(s=>s.id===t?(n=!0,{...s,isTransaction:!1,suspendValidation:!1}):s);n&&this.#e.next(r),this.#o()}#o(){if(!this.#e.value.some(t=>t.isTransaction)){const t=this.#e.value.pop();this.#e.next([]),t&&(this.$broadcast({action:"checkTransComplete",phase:"next",value:t.value}),this.next(t.value))}}_$;get $(){return this._$||(this._$=vT(this)),this._$}queuePendingValue(t){const n=`${Math.random()}`.replace("0.",""),r=`level_${this.#e.value.length}-${n}-trans`,s=[...this.#e.value,{id:r,value:t,isTransaction:!1}];return this.#e.next(s),r}#h(){return this.#e.value.some(t=>t.isTransaction)}#d=()=>{if(this.#h())return;const t=this.#e.value.pop();return this.#e.next([]),t};dequeuePendingValue(t){if(this.#e.value.findIndex(r=>r.id===t)===this.#e.value.length-1&&!this.#e.value.some(r=>r.isTransaction))return this.#d()}#u(t=!1){const n=`${Math.random()}`.replace("0.",""),r=`level_${this.#e.value.length}-${n}-trans`,s=[...this.#e.value,{id:r,value:this.value,suspendValidation:t,isTransaction:!0}];return this.#e.next(s),r}#l(t){const n=this.#e.value.findIndex(r=>r.id===t);if(n>=0){const r=this.#e.value.slice(0,n);this.#e.next(r)}}get $root(){return this}get $isRoot(){return!0}$parent=void 0;$broadcast(t,n){(n||!this.$parent)&&this.receiver.next(t),this.$root&&this.$root!==this&&this.$root.$broadcast(t)}receiver=new ks;$validate(t){if(this.suspendValidation)return{isValid:!0};if(gT(this.$schema))try{this.$schema.parse(t)}catch(n){return{isValid:!1,error:Dn(n),source:"$schema"}}return this.$test(t)}$isValid(t){return this.$validate(t).isValid}$schema;#i;$test(t){let n;if(this.#i)try{if(Array.isArray(this.#i))for(const r of this.#i)n=r,this.#a(r,t);else typeof this.#i=="function"&&(n=this.#i,this.#a(this.#i,t))}catch(r){return{isValid:!1,value:t,error:Dn(r),testFn:n}}return{isValid:!0}}get value(){const t=this.#e.value;if(t.length)return t[t.length-1].value;if(!this.#r)throw new Error("Store requires $subject or overload of value");return this.#r.value}subscribe(t){return this.$subject.pipe(Rd(po)).subscribe(t)}get(t){if(!t||Array.isArray(t)&&t.length===0)return this.value;const n=Array.isArray(t)?t:pe(t).split(".");return rn(this.value,n)}set(t,n){const r=Jr(this.value,s=>{oa(s,t,n)});this.next(r)}mutate(t,n){if(!n||Array.isArray(n)&&n.length===0){const r=Jr(this.value,t);return this.next(r),this.value}else{const r=Array.isArray(n)?n:pe(n).split("."),s=Jr(this.value,i=>{const o=rn(i,r);o!==void 0&&t(o)});return this.next(s),this.value}}}class ST extends Map{#r;#n;#t;constructor(t,n){super(),this.#r=t,this.#n=n}#a(t){return pe(t)}$get(t){const n=this.#a(t),r=super.get(n);if(r)return r;if(this.#r.get(n)!==void 0)return this.$add(n,{}),super.get(n)}has(t){return super.has(this.#a(t))}set(t,n){const r=this.#a(t),s=super.get(r);if(s&&s!==n)throw new Error(`Branch already exists at ${r}`);return super.set(r,n),this.#d(),this}delete(t){const n=this.#a(t),r=super.get(n);if(!r)return!1;const s=this.$detach(n,r);return s&&r.isActive&&r.complete(),s}clear(){super.clear(),this.#l()}$add(t,n,...r){const s=this.#a(t);if(super.get(s))throw new Error(`Branch already exists at ${s}`);const o=this.#r.get(s);if(o===void 0)throw new Error(`Cannot create branch at ${s}; value is undefined`);const a=this.#h(n),c=this.#e(t,a),h=this.#r.$name+"."+s,l=o;let u;return c.subclass?u=new c.subclass({name:h,value:l,...c,path:t,parent:this.#r},...r):u=new xr({name:h,value:l,...c,parent:this.#r,path:t}),this.set(s,u),u}$detach(t,n){const r=this.#a(t),s=super.get(r);if(!s||n&&n!==s)return!1;const i=super.delete(r);return this.#l(),i}$completeAll(){for(const t of[...super.keys()])this.delete(t)}#e(t,n){const r=this.#a(t),s=Object.hasOwn(n,"subclass"),i=this.#c(t),o={...i?.params??{},...n};return s?(o.subclass=this.#o(n.subclass,r),o):(i&&Object.hasOwn(i.params,"subclass")&&(o.subclass=this.#o(o.subclass,r,i.source)),o)}#c(t){const n=this.#a(t);let r="",s;if(this.#n.has(n))r=`branchParams["${n}"]`,s=this.#n.get(n);else if(this.#n.has("*"))r='branchParams["*"]',s=this.#n.get("*");else return;return s?typeof s!="object"||Array.isArray(s)?(console.warn(`Branch params provided for "${n}" in ${r} are invalid`),{params:{},source:r}):{params:this.#h(s),source:r}:(console.warn(`Branch params provided for "${n}" in ${r} but do not exist`),{params:{},source:r})}#o(t,n,r){if(!t){console.warn(r?`Branch class provided for "${n}" in ${r} but does not exist`:`Branch class provided for "${n}" but does not exist`);return}if(typeof t!="function"){console.warn(r?`Branch class provided for "${n}" in ${r} is invalid`:`Branch class provided for "${n}" is invalid`);return}return t}#h(t){const n={...t};return Object.hasOwn(n,"value")&&delete n.value,Object.hasOwn(n,"path")&&delete n.path,Object.hasOwn(n,"parent")&&delete n.parent,n}#d(){this.#t||!this.size||(this.#t=this.#r.$subject.subscribe(()=>{this.#u()}))}#u(){if(!this.size){this.#l();return}for(const t of[...super.keys()])this.#r.get(t)===void 0&&this.delete(t);this.#l()}#l(){this.size||this.#t&&(this.#t.unsubscribe(),this.#t=void 0)}}class xr extends wT{#r;#n=new Map;$branches;constructor(t){const{path:n,parent:r}=t;if(n!==void 0&&r!==void 0){if(!yT(r))throw new Error("Forest branches must have parents");const i=rn(r?.value,n);super({...t,value:i},!0),this.$path=n,this.$parent=r,this.#r=r.receiver.subscribe({next:o=>{this.#a(o)}})}else super(t);t.branchClasses instanceof Map&&t.branchClasses.forEach((i,o)=>{this.#n.set(pe(o),{subclass:i})}),t.branchParams instanceof Map&&t.branchParams.forEach((i,o)=>{const a=pe(o),c=this.#n.get(a);if(c&&typeof c=="object"&&!Array.isArray(c)&&i&&typeof i=="object"&&!Array.isArray(i)){this.#n.set(a,{...c,...i});return}this.#n.set(a,i)}),this.$branches=new ST(this,this.#n)}$path=[];get $isRoot(){return!this.$parent}get fullPath(){if(this.$isRoot)return[];if(!this.$parent||!this.$path)throw new Error("Branch requires parent and path");const t=this.$parent.fullPath;return So(t,this.$path)}get value(){return this.$isRoot?super.value:rn(this.$root.value,this.fullPath)}get $root(){return this.$isRoot?this:this.$parent.$root}complete(){if(!this.isActive)return this.value;if(this.#r&&this.#r.unsubscribe(),this.$isRoot||this.$branches.$completeAll(),this.#e(),this.$isRoot){const t={type:"complete",timestamp:Date.now()};this.$broadcast(t,!0),this.receiver.complete()}return this.$branches.clear(),super.complete()}next(t){if(!this.isActive)throw new Error("Cannot update completed store");const n=this.prep(t),{isValid:r,error:s}=this.$validate(n);if(!r)throw this.debug&&console.error(`cannot update ${this.$name} with `,n,s),Dn(s);if(this.$parent&&this.$path)this.$parent.set(this.$path,n);else{const i=this.queuePendingValue(n);try{this.#t(n),this.dequeuePendingValue(i)&&super.next(n)}catch(o){throw this.dequeuePendingValue(i),o}}}#t(t){let n=null;const r=this.receiver.subscribe(s=>{s&&s.type==="validation-failure"&&(n=`Branch ${pe(s.branchPath)}: ${s.error}`)});try{const s={type:"set-pending",payload:t,timestamp:Date.now()};this.$broadcast(s,!0);const i={type:"$validate-all",timestamp:Date.now()};if(this.$broadcast(i,!0),n)throw this.debug&&console.error("Branch validation failed:",n),new Error(`Validation failed: ${n}`)}finally{r.unsubscribe()}}set(t,n){const r=Array.isArray(t)?t:pe(t).split("."),s=Jr(this.value,i=>{oa(i,r,n)});this.next(s)}$branch(t,n,...r){return console.warn("$branch is deprecated; use this.$branches.$add"),this.$branches.$add(t,n,...r)}get $br(){return this.$branches}#a(t){if(t.type==="complete")this.complete();else if(t.type==="set-pending"&&this.$parent&&this.$path){const n=rn(this.$parent.value,this.$path);po(n,this.value)||super.next(n)}}#e(){if(!this.$path||!(this.$parent instanceof xr))return;const t=this.$parent,n=pe(this.$path),r=t.$branches.get(n);r===this&&t.$branches.$detach(n,r)}get $subject(){if(this.$isRoot)return super.$subject;const t=this;return this.$root.$subject.pipe(nS(()=>t.value),Rd(po))}subscribe(t){return this.$subject.subscribe(t)}receiver=new ks;$broadcast(t,n){n||this.$isRoot?this.receiver.next(t):this.$root&&this.$root!==this?this.$root.$broadcast(t):console.warn("strange $broadcast pattern; node that is not $root has no $parent",this)}}function AT(e,t={}){const{axis:n,parentPixels:r}=t;if(e.mode==="px")return e.value;if(r===void 0){const s=n??"axis";throw new Error(`% size requires parent ${s}`)}return r*e.value}function TT(e,t){const n=t?.min,r=t?.max;if(n!==void 0&&r!==void 0&&n>r)return Math.max(e,n);let s=e;return n!==void 0&&(s=Math.max(s,n)),r!==void 0&&(s=Math.min(s,r)),s}function CT(e){return Array.isArray(e)?e.join("."):`${e}`}function PT(e){return CT(e)}var _t=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},lt,Bd,Lh,Gh,vi,jh,wi,Nh,Ln,Ao,To;function kT(e){return e instanceof G0?e.issues.map(t=>t.message).join("; "):e instanceof Error?e.message:"invalid value"}function Uh(e,t,n,r){if(e)try{return Ki.parse(e)}catch(s){throw new Error(`${n}.${t}.${r}: ${kT(s)}`)}}function Wh(e,t,n){const r=Uh(e?.min,t,n,"min"),s=Uh(e?.max,t,n,"max");if(!(!r&&!s))return Ji.parse({min:r,max:s})}function Vh(e,t,n){let r;try{r=to.parse(e??"s")}catch{throw new Error(`${n}.${t}: unsupported align "${String(e)}"`)}switch(r){case"<":return"s";case"|":return"c";case">":return"e";case"<>":return"f";default:return r}}function Zh(e,t,n){let r;try{r=eo.parse(e??"s")}catch{throw new Error(`${n}.area.p${t}: unsupported pivot "${String(e)}"`)}switch(r){case"<":return"s";case"|":return"c";case">":return"e";default:return r}}function MT(e,t){if(e){if(e instanceof Map)return new Map(e);if(typeof e=="object"&&!Array.isArray(e))return new Map(Object.entries(e));throw new Error(`${t}.children: expected Map or Record`)}}function Co(e={},t){const n=Lw.parse(e),r=n.id??t??"root";if(t===void 0){const d=n.area?.x!==void 0,p=n.area?.y!==void 0;if(!d||!p)throw new Error(`${r}.area: root requires explicit x and y`)}const i=ld.parse({...n.area??{},px:Zh(n.area?.px,"x",r),py:Zh(n.area?.py,"y",r)}),o=$w.parse({x:Vh(n.align?.x,"x",r),y:Vh(n.align?.y,"y",r),direction:n.align?.direction}),a=Wh(n.constrain?.x,"x",r),c=Wh(n.constrain?.y,"y",r),h=a||c?{x:a,y:c}:void 0,l=MT(e.children,r),u=l&&l.size?new Map([...l.entries()].map(([d,p])=>[d,Co(p,d)])):void 0,f=Fw.parse({area:i,align:o,content:n.content,order:n.order,absolute:n.absolute,constrain:h,style:n.style,id:n.id??t});return ta.parse({...f,children:u})}function ET(e){const t=new Map(e.branchParams??[]);return t.has("*")||t.set("*",{subclass:sn}),{...e,branchParams:t}}class sn extends xr{constructor(t){const n=sn.isStoreParams(t)?{...t,value:ta.parse(t.value)}:{value:Co(t)};super(ET(n)),lt.add(this)}static isStoreParams(t){if(!t||typeof t!="object"||!Object.prototype.hasOwnProperty.call(t,"value"))return!1;const n=t;return"path"in n||"parent"in n||"schema"in n||"branchParams"in n}get id(){return this.value.id}get name(){return _t(this,lt,"m",Bd).call(this)??this.value.id??"root"}get identityPath(){return this.$parent&&this.$parent instanceof sn?`${this.$parent.identityPath}/${this.name}`:this.name}get parentTree(){return this.$parent instanceof sn?this.$parent:void 0}get order(){return this.value.order}get absolute(){return this.value.absolute}get content(){return this.value.content}get direction(){return this.value.align.direction}get anchorX(){return _t(this,lt,"m",Ao).call(this,"x")}get anchorY(){return _t(this,lt,"m",Ao).call(this,"y")}get x(){return this.anchorX-_t(this,lt,"m",To).call(this,"x")}get y(){return this.anchorY-_t(this,lt,"m",To).call(this,"y")}get absAnchorX(){return this.parentTree?this.parentTree.absX+this.anchorX:this.anchorX}get absAnchorY(){return this.parentTree?this.parentTree.absY+this.anchorY:this.anchorY}get absX(){const t=this.parentTree;return t?t.absX+this.x:this.x}get absY(){const t=this.parentTree;return t?t.absY+this.y:this.y}get width(){return _t(this,lt,"m",Ln).call(this,"x")}get height(){return _t(this,lt,"m",Ln).call(this,"y")}get area(){return{x:this.x,y:this.y,width:this.width,height:this.height}}get rect(){return this.area}get childrenMap(){const t=[],n=this.value.children;if(!n)return new Map;for(const r of n.keys()){const s=this.$br.$get(["children",r]);s&&t.push([r,s])}return t.sort((r,s)=>{const i=r[1].order-s[1].order;return i!==0?i:r[0].localeCompare(s[0])}),new Map(t)}get children(){return[...this.childrenMap.values()]}getChild(t){if(this.value.children?.has(t))return this.$br.$get(["children",t])}addChild(t,n={}){if(this.value.children?.has(t))throw new Error(`${this.identityPath}: child ${t} already exists`);const r=Co(n,t);this.mutate(i=>{const o=new Map(i.children??[]);o.set(t,r),i.children=o});const s=this.$br.$get(["children",t]);if(!s)throw new Error(`${this.identityPath}: could not create branch for child ${t}`);return s}removeChild(t){this.value.children?.has(t)&&(this.$br.delete(PT(["children",t])),this.mutate(n=>{if(!n.children?.has(t))return;const r=new Map(n.children);r.delete(t),n.children=r.size?r:void 0}))}setPosition(t,n){this.mutate(r=>{r.area.x=t,r.area.y=n})}setOrder(t){if(!Number.isFinite(t))throw new Error(`${this.identityPath}.order: order must be finite`);this.mutate(n=>{n.order=t})}setAbsolute(t){this.mutate(n=>{n.absolute=t})}setDirection(t){this.mutate(n=>{n.align.direction=t})}setContent(t){const n=Qo.parse(t);this.mutate(r=>{r.content=n})}clearContent(){this.mutate(t=>{t.content=void 0})}setWidthPx(t){if(!Number.isFinite(t)||t<0)throw new Error(`${this.identityPath}.x: px must be finite and >= 0`);this.mutate(n=>{n.area.width={mode:"px",value:t}})}setHeightPx(t){if(!Number.isFinite(t)||t<0)throw new Error(`${this.identityPath}.y: px must be finite and >= 0`);this.mutate(n=>{n.area.height={mode:"px",value:t}})}setWidthPercent(t){if(!Number.isFinite(t)||t<0||t>1)throw new Error(`${this.identityPath}.x: percent must be between 0 and 1`);this.mutate(n=>{n.area.width={mode:"%",value:t}})}setHeightPercent(t){if(!Number.isFinite(t)||t<0||t>1)throw new Error(`${this.identityPath}.y: percent must be between 0 and 1`);this.mutate(n=>{n.area.height={mode:"%",value:t}})}resolveWidth(t){return _t(this,lt,"m",Ln).call(this,"x",t)}resolveHeight(t){return _t(this,lt,"m",Ln).call(this,"y",t)}resolveArea(t,n){return{x:this.x,y:this.y,width:this.resolveWidth(t),height:this.resolveHeight(n)}}resolveRect(t,n){return this.resolveArea(t,n)}}lt=new WeakSet,Bd=function(){const t=this.$path;if(!t||t.length!==2||t[0]!=="children")return;const n=t[1];return typeof n=="string"?n:void 0},Lh=function(t){const n=this.parentTree;if(n)return t==="x"?n.width:n.height},Gh=function(t){return t==="x"?this.value.constrain?.x:this.value.constrain?.y},vi=function(t){return t==="x"?this.value.align.x:this.value.align.y},jh=function(t){return t==="x"?this.value.area.px:this.value.area.py},wi=function(t,n){return n.direction==="row"&&t==="x"||n.direction==="column"&&t==="y"},Nh=function(t){const n=this.parentTree;if(!n||this.absolute||!_t(this,lt,"m",wi).call(this,t,n))return 0;let r=0;for(const s of n.children){if(s===this)break;r+=t==="x"?s.width:s.height}return r},Ln=function(t,n){const r=n??_t(this,lt,"m",Lh).call(this,t),s=_t(this,lt,"m",vi).call(this,t),i=t==="x"?this.value.area.width:this.value.area.height,a=!this.absolute&&s==="f"&&r!==void 0?r:AT(i,{axis:t,parentPixels:r}),c=_t(this,lt,"m",Gh).call(this,t),h=c?.min,l=c?.max;return TT(a,{min:h,max:l})},Ao=function(t){const n=t==="x"?this.value.area.x:this.value.area.y,r=this.parentTree;if(!r||this.absolute)return n;const s=_t(this,lt,"m",vi).call(this,t),i=t==="x"?r.width:r.height,o=t==="x"?this.width:this.height;let a=n;switch(s){case"c":a=(i-o)/2+n;break;case"e":a=i-o-n;break;default:a=n;break}return _t(this,lt,"m",wi).call(this,t,r)?a+_t(this,lt,"m",Nh).call(this,t):a},To=function(t){const n=t==="x"?this.width:this.height;switch(_t(this,lt,"m",jh).call(this,t)){case"c":return n/2;case"e":return n;default:return 0}};var wt=function(e,t,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(e,n):s?s.value=n:t.set(e,n),n},Jt=function(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)},de,We,Gn,Ve,Ze,He;class aa extends xr{constructor(t,n={}){if(super(t),de.set(this,void 0),We.set(this,void 0),Gn.set(this,void 0),Ve.set(this,void 0),Ze.set(this,!1),He.set(this,!1),aa.isApplicationConfig(n)){wt(this,de,n,"f");return}wt(this,de,n.app,"f"),wt(this,We,n.ticker,"f"),wt(this,Gn,n.container,"f")}static isApplicationConfig(t){return!!t&&typeof t=="object"&&"ticker"in t&&"renderer"in t}get application(){return Jt(this,de,"f")??this.$parent?.application}set application(t){wt(this,de,t,"f")}get app(){return this.application}set app(t){this.application=t}get container(){return Jt(this,Gn,"f")??this.$parent?.container}get tickerContainer(){return this.container}set tickerContainer(t){wt(this,Gn,t,"f")}get ticker(){if(Jt(this,We,"f"))return Jt(this,We,"f");if(Jt(this,de,"f")?.ticker)return Jt(this,de,"f").ticker;const t=this.$parent?.ticker;if(t)return t;throw new Error(`${this.constructor.name}: ticker is unavailable (expected config.ticker, config.app.ticker, or parent.ticker)`)}set ticker(t){wt(this,We,t,"f")}queueResolve(){const t=this.ticker;if(Jt(this,Ze,"f")){wt(this,He,!0,"f");return}t.addOnce(this.$.onTick,this),wt(this,Ve,t,"f"),wt(this,Ze,!0,"f")}kickoff(){this.queueResolve()}onTick(){this.isDirty()&&(this.resolve(),this.clearDirty()),wt(this,Ze,!1,"f"),wt(this,Ve,void 0,"f"),Jt(this,He,"f")&&(wt(this,He,!1,"f"),this.queueResolve())}cleanup(){Jt(this,Ve,"f")?.remove(this.$.onTick,this),this.ticker?.remove(this.$.onTick,this),wt(this,Ve,void 0,"f"),wt(this,Ze,!1,"f"),wt(this,He,!1,"f")}}de=new WeakMap,We=new WeakMap,Gn=new WeakMap,Ve=new WeakMap,Ze=new WeakMap,He=new WeakMap;const IT=Vt(["icon","iconVertical","text","inline"]);dt({id:jt(),sprite:Je().optional(),icon:Je().optional(),iconUrl:jt().optional(),rightSprite:Je().optional(),rightIcon:Je().optional(),rightIconUrl:jt().optional(),label:jt().optional(),mode:IT.optional(),isDisabled:Ko().optional().default(!1),onClick:qv().optional(),variant:jt().optional(),bitmapFont:jt().optional()});dt({r:bt().min(0).max(1),g:bt().min(0).max(1),b:bt().min(0).max(1)});function Hr(e){const t=Math.round(e.r*255),n=Math.round(e.g*255),r=Math.round(e.b*255);return t<<16|n<<8|r}function zT(e){return!!e&&typeof e=="object"&&"renderer"in e&&"ticker"in e}function $T(e){return zT(e)?{app:e}:{ticker:e.ticker}}class J extends aa{#r;#n;#t;#a=!1;#e;#c;#o;#h;#d;#u;#l;#i;constructor(t,n,r,s){super({value:{dirty:!0}},$T(r)),this.id=t.id,this.#r=n,this.#n=t,this.#t=J.#S(t),this.#e=t.isDisabled??!1,this.#c=new sn({id:t.id,area:{x:0,y:0,width:{mode:"px",value:0},height:{mode:"px",value:0},px:"s",py:"s"},align:{x:"s",y:"s",direction:this.#t==="iconVertical"?"column":"row"}}),this.#o=new Ft({label:`button-${this.id}`,...s}),this.#h=new rs,this.#d=new Ft({label:`button-content-${this.id}`}),this.#o.addChild(this.#h),this.#o.addChild(this.#d),this.#E(),this.#I()}static#S(t){return t.mode?t.mode:!t.sprite&&!t.icon&&t.label?"text":(t.sprite||t.icon)&&t.label?"inline":"icon"}get#A(){return this.#t==="icon"||this.#t==="iconVertical"||this.#t==="inline"&&!!(this.#n.sprite||this.#n.icon)}get#T(){return this.#t==="inline"&&!!(this.#n.rightSprite||this.#n.rightIcon)}get#C(){return!!this.#n.label&&this.#t!=="icon"}get container(){return this.#o}get rect(){return this.#c.rect}get children(){return this.#c.children}get isHovered(){return this.#a}get isDisabled(){return this.#e}get mode(){return this.#t}static#f(t){if(typeof t!="string")return;const n=t.trim();return n.length?n:void 0}#m(t){if(!t)return;const n=t.texture,r=n?.source;return J.#f(r?.resource?.src)??J.#f(r?.src)??J.#f(n?.resource?.src)??J.#f(n?.url)}#P(t){if(!t)return;const n=t.children?.[0];return this.#m(n)}#k(t,n,r){const s=t==="right"?this.#n.rightIconUrl:this.#n.iconUrl;return J.#f(s)??this.#m(n)??this.#P(r)}#g(t,n){return this.#c.addChild(t,{id:`${this.id}-${t}`,order:n,area:{x:0,y:0,width:{mode:"px",value:0},height:{mode:"px",value:0},px:"s",py:"s"},align:{x:"s",y:"s",direction:"column"}})}#y(t,n){const r=t==="left"?"icon-left":"icon-right",s=t==="right"?this.#n.rightSprite:this.#n.sprite,i=t==="right"?this.#n.rightIcon:this.#n.icon,o=this.#g(r,n),a=this.#k(t,s,i);a&&o.setContent({type:"url",value:a});const c=new Ft({label:`${this.id}-${r}-host`});return s?("anchor"in s&&s.anchor&&s.anchor.set(0),c.addChild(s)):i&&c.addChild(i),this.#d.addChild(c),{tree:o,host:c,sprite:s,container:i,role:t}}#M(t){const n=this.#g("label",t);n.setContent({type:"text",value:this.#n.label??""});const r=new Ft({label:`${this.id}-label-host`}),s=new t_({text:this.#n.label??"",style:new Re({fontSize:13,fill:16777215,align:"center",fontFamily:this.#n.bitmapFont??"Arial"})});return r.addChild(s),this.#d.addChild(r),{tree:n,host:r,textDisplay:s}}#E(){let t=0;this.#A&&(this.#u=this.#y("left",t),t+=1),this.#C&&(this.#i=this.#M(t),t+=1),this.#T&&(this.#l=this.#y("right",t))}#I(){this.#o.eventMode=this.#e?"none":"static",this.#o.cursor=this.#e?"default":"pointer",this.#o.on("pointerenter",this.#_),this.#o.on("pointerleave",this.#b),this.#o.on("pointertap",this.#x)}#_=()=>{this.#e||this.setHovered(!0)};#b=()=>{this.#e||this.setHovered(!1)};#x=()=>{!this.#e&&this.#n.onClick&&this.#n.onClick()};#z(){return this.#e?["disabled"]:this.#a?["hover"]:[]}#s(...t){const n=this.#z(),r=this.#n.variant;let s=[];if(this.#t==="text"?s=["text"]:this.#t==="inline"?s=["inline"]:this.#t==="iconVertical"&&(s=["iconVertical"]),r){const i=this.#r.match({nouns:["button",r,...s,...t],states:n});if(i!==void 0)return i}return this.#r.match({nouns:["button",...s,...t],states:n})}#$(){return this.#t==="text"||this.#t==="inline"?12:4}#R(){return this.#t==="text"||this.#t==="inline"?6:4}#O(){return this.#t==="text"||this.#t==="inline"?4:0}#B(){return this.#t==="inline"?{x:16,y:16}:{x:32,y:32}}#F(){return this.#t==="text"||this.#t==="inline"?{r:1,g:1,b:1}:{r:0,g:0,b:0}}#D(){return this.#t==="text"||this.#t==="inline"?1:.5}#L(){return this.#t==="text"||this.#t==="inline"?0:1}#G(){const t=this.#s("borderRadius")??this.#O(),n=this.#s("stroke","color")??{r:.5,g:.5,b:.5},r=this.#s("stroke","alpha")??1,s=this.#s("stroke","width")??this.#L(),i=this.#s("fill","color"),o=this.#s("fill","alpha"),a={borderRadius:t};return i&&(o??1)>0?a.fill={color:i,alpha:this.#e?(o??1)*.5:o??1}:(this.#t==="text"||this.#t==="inline")&&(a.fill={color:{r:.33,g:.67,b:.6},alpha:this.#e?.5:1}),n&&s>0&&(a.stroke={color:n,width:s,alpha:r}),a}#p(t){const n=this.#B(),r=t.role==="right",s=r?this.#s("rightIcon","size","x")??this.#s("icon","size","x")??n.x:this.#s("icon","size","x")??n.x,i=r?this.#s("rightIcon","size","y")??this.#s("icon","size","y")??n.y:this.#s("icon","size","y")??n.y,o=r?this.#s("rightIcon","alpha")??this.#s("icon","alpha")??1:this.#s("icon","alpha")??1,a=r?this.#s("rightIcon","tint")??this.#s("icon","tint"):this.#s("icon","tint");return{width:s,height:i,alpha:o,tint:a}}#v(){const t=this.#s("label","fontSize")??13,n=this.#s("label","color")??this.#F(),r=this.#s("label","alpha")??this.#D();return{textStyle:{fontSize:t,fill:Hr(n),align:"center",fontFamily:this.#n.bitmapFont??"Arial"},alpha:this.#e?r*.5:r}}#j(t){const n=this.#n.label??"",r=typeof t.fontSize=="number"?t.fontSize:13,s=Math.max(0,n.length*r*.6),i=Math.max(0,r*1.2);let o=s,a=i;if(this.#i)try{this.#i.textDisplay.text=n,this.#i.textDisplay.style=new Re(t);const c=this.#i.textDisplay.getLocalBounds();Number.isFinite(c.width)&&c.width>=0&&(o=c.width),Number.isFinite(c.height)&&c.height>=0&&(a=c.height)}catch{}try{const c=te.measureText(n,t);Number.isFinite(c.width)&&c.width>=0&&(o=c.width),Number.isFinite(c.height)&&c.height>=0&&(a=c.height)}catch{}return{width:o,height:a}}#N(){const n=(this.#t==="iconVertical"?"column":"row")==="row",r=this.#t==="iconVertical"?this.#s("iconGap")??4:this.#t==="inline"?this.#s("iconGap")??8:0,s=this.#s("padding","x")??this.#$(),i=this.#s("padding","y")??this.#R();this.#c.setDirection(n?"row":"column");const o=[];if(this.#u){const h=this.#p(this.#u);o.push({tree:this.#u.tree,width:h.width,height:h.height})}if(this.#i){const{textStyle:h}=this.#v(),l=this.#j(h);o.push({tree:this.#i.tree,width:l.width,height:l.height})}if(this.#l){const h=this.#p(this.#l);o.push({tree:this.#l.tree,width:h.width,height:h.height})}const a=n?o.reduce((h,l)=>h+l.width,0)+Math.max(0,o.length-1)*r:o.reduce((h,l)=>Math.max(h,l.width),0),c=n?o.reduce((h,l)=>Math.max(h,l.height),0):o.reduce((h,l)=>h+l.height,0)+Math.max(0,o.length-1)*r;for(const[h,l]of o.entries()){const u=h*r,f=n?u:0;let d=n?0:u;n&&this.#t==="inline"&&(d=Math.max(0,(c-l.height)/2)),l.tree.setPosition(f,d),l.tree.setWidthPx(l.width),l.tree.setHeightPx(l.height)}this.#c.setWidthPx(a+s*2),this.#c.setHeightPx(c+i*2),this.#d.position.set(s,i)}#U(){const t=this.#G(),{width:n,height:r}=this.#c.rect;this.#h.clear();const s=t.borderRadius??0;t.fill?.color&&(this.#h.roundRect(0,0,n,r,s),this.#h.fill({color:Hr(t.fill.color),alpha:t.fill.alpha??1})),t.stroke?.color&&t.stroke.width&&t.stroke.width>0&&(this.#h.roundRect(0,0,n,r,s),this.#h.stroke({color:Hr(t.stroke.color),alpha:t.stroke.alpha??1,width:t.stroke.width}))}#w(t){const n=this.#p(t);if(t.host.position.set(t.tree.x,t.tree.y),t.sprite){t.sprite.width=n.width,t.sprite.height=n.height,t.sprite.alpha=this.#e?n.alpha*.5:n.alpha,t.sprite.tint=n.tint?Hr(n.tint):16777215;return}if(t.container){const r=t.container.getLocalBounds();r.width>0&&r.height>0&&t.container.scale.set(n.width/r.width,n.height/r.height),t.container.alpha=this.#e?n.alpha*.5:n.alpha}}#W(){if(!this.#i)return;const{textStyle:t,alpha:n}=this.#v();this.#i.host.position.set(this.#i.tree.x,this.#i.tree.y),this.#i.textDisplay.text=this.#n.label??"",this.#i.tree.setContent({type:"text",value:this.#n.label??""}),this.#i.textDisplay.style=new Re(t),this.#i.textDisplay.alpha=n}isDirty(){return this.value.dirty}clearDirty(){this.set("dirty",!1)}markDirty(){this.value.dirty||this.set("dirty",!0),this.queueResolve()}resolve(){this.#N(),this.#o.position.set(this.#c.x,this.#c.y),this.#U(),this.#u&&this.#w(this.#u),this.#l&&this.#w(this.#l),this.#W()}setHovered(t){this.#a!==t&&(this.#a=t,this.markDirty())}setDisabled(t){this.#e!==t&&(this.#e=t,this.#o.eventMode=t?"none":"static",this.#o.cursor=t?"default":"pointer",this.markDirty())}setPosition(t,n){this.#c.setPosition(t,n),this.markDirty()}getConfig(){return this.#n}getPreferredSize(){const{width:t,height:n}=this.#c.rect;return{width:t,height:n}}cleanup(){this.#o.off("pointerenter",this.#_),this.#o.off("pointerleave",this.#b),this.#o.off("pointertap",this.#x),super.cleanup()}}function vr(){const e=new nw;return e.set("button.padding.x",[],8),e.set("button.padding.y",[],8),e.set("button.borderRadius",[],4),e.set("button.icon.size.x",[],32),e.set("button.icon.size.y",[],32),e.set("button.icon.alpha",[],1),e.set("button.stroke.color",[],{r:.6,g:.6,b:.6}),e.set("button.stroke.width",[],1),e.set("button.stroke.alpha",[],1),e.set("button.label.fontSize",[],11),e.set("button.label.color",[],{r:.2,g:.2,b:.2}),e.set("button.label.alpha",[],.8),e.set("button.label.padding",[],8),e.set("button.fill.color",["hover"],{r:.9,g:.95,b:1}),e.set("button.fill.alpha",["hover"],1),e.set("button.stroke.color",["hover"],{r:.4,g:.6,b:.9}),e.set("button.icon.alpha",["disabled"],.4),e.set("button.stroke.alpha",["disabled"],.4),e.set("button.iconVertical.padding.x",[],8),e.set("button.iconVertical.padding.y",[],8),e.set("button.iconVertical.borderRadius",[],4),e.set("button.iconVertical.icon.size.x",[],32),e.set("button.iconVertical.icon.size.y",[],32),e.set("button.iconVertical.icon.alpha",[],1),e.set("button.iconVertical.iconGap",[],6),e.set("button.iconVertical.stroke.color",[],{r:.6,g:.6,b:.6}),e.set("button.iconVertical.stroke.width",[],1),e.set("button.iconVertical.stroke.alpha",[],1),e.set("button.iconVertical.label.fontSize",[],11),e.set("button.iconVertical.label.color",[],{r:.2,g:.2,b:.2}),e.set("button.iconVertical.label.alpha",[],.8),e.set("button.iconVertical.fill.color",["hover"],{r:.9,g:.95,b:1}),e.set("button.iconVertical.fill.alpha",["hover"],1),e.set("button.iconVertical.stroke.color",["hover"],{r:.4,g:.6,b:.9}),e.set("button.iconVertical.icon.alpha",["disabled"],.4),e.set("button.iconVertical.stroke.alpha",["disabled"],.4),e.set("button.iconVertical.label.alpha",["disabled"],.4),e.set("button.text.padding.x",[],16),e.set("button.text.padding.y",[],8),e.set("button.text.borderRadius",[],6),e.set("button.text.fill.color",[],{r:.2,g:.5,b:.8}),e.set("button.text.fill.alpha",[],1),e.set("button.text.label.fontSize",[],14),e.set("button.text.label.color",[],{r:1,g:1,b:1}),e.set("button.text.label.alpha",[],1),e.set("button.text.fill.color",["hover"],{r:.3,g:.6,b:.9}),e.set("button.text.fill.alpha",["disabled"],.5),e.set("button.text.label.alpha",["disabled"],.5),e.set("button.inline.padding.x",[],12),e.set("button.inline.padding.y",[],8),e.set("button.inline.borderRadius",[],6),e.set("button.inline.iconGap",[],8),e.set("button.inline.icon.size.x",[],20),e.set("button.inline.icon.size.y",[],20),e.set("button.inline.icon.alpha",[],1),e.set("button.inline.fill.color",[],{r:.15,g:.65,b:.45}),e.set("button.inline.fill.alpha",[],1),e.set("button.inline.label.fontSize",[],14),e.set("button.inline.label.color",[],{r:1,g:1,b:1}),e.set("button.inline.label.alpha",[],1),e.set("button.inline.fill.color",["hover"],{r:.1,g:.8,b:.6}),e.set("button.inline.stroke.color",["hover"],{r:.2,g:.4,b:.9}),e.set("button.inline.stroke.width",["hover"],1),e.set("button.inline.stroke.alpha",["hover"],1),e.set("button.inline.fill.alpha",["disabled"],.5),e.set("button.inline.icon.alpha",["disabled"],.5),e.set("button.inline.label.alpha",["disabled"],.5),e.set("button.primary.text.fill.color",[],{r:.8,g:.2,b:.2}),e.set("button.primary.text.fill.color",["hover"],{r:.9,g:.3,b:.3}),e}function Ct(e,t){const n=new hn(e);return t!==void 0&&(n.tint=t),n}const RT={title:"Button",args:{mode:"icon"},argTypes:{mode:{control:"select",options:["icon","iconVertical","text","inline"]}}},jn={render:()=>{const e=document.createElement("div");e.style.width="100%",e.style.height="400px",e.style.position="relative";const t=new yn;return t.init({width:800,height:400,backgroundColor:16119285,antialias:!0}).then(async()=>{e.appendChild(t.canvas);const n=await ge.load("/placeholder-art.png"),r=vr(),s=new J({id:"btn-1",mode:"icon",sprite:Ct(n,4491468),onClick:()=>console.log("Blue clicked")},r,t);s.setPosition(50,50);const i=new J({id:"btn-2",mode:"icon",sprite:Ct(n,4508808),onClick:()=>console.log("Green clicked")},r,t);i.setPosition(110,50);const o=new J({id:"btn-3",mode:"icon",sprite:Ct(n,13404228),isDisabled:!0},r,t);o.setPosition(170,50),t.stage.addChild(s.container),t.stage.addChild(i.container),t.stage.addChild(o.container),s.kickoff(),i.kickoff(),o.kickoff()}),e}},Nn={render:()=>{const e=document.createElement("div");e.style.width="100%",e.style.height="400px",e.style.position="relative";const t=new yn;return t.init({width:800,height:400,backgroundColor:16119285,antialias:!0}).then(async()=>{e.appendChild(t.canvas);const n=await ge.load("/placeholder-art.png"),r=vr(),s=new J({id:"btn-1",mode:"iconVertical",sprite:Ct(n,4491468),label:"Blue",onClick:()=>console.log("Blue clicked")},r,t);s.setPosition(50,50);const i=new J({id:"btn-2",mode:"iconVertical",sprite:Ct(n,4508808),label:"Green",onClick:()=>console.log("Green clicked")},r,t);i.setPosition(130,50);const o=new J({id:"btn-3",mode:"iconVertical",sprite:Ct(n,13404228),label:"Orange",isDisabled:!0},r,t);o.setPosition(210,50),t.stage.addChild(s.container),t.stage.addChild(i.container),t.stage.addChild(o.container),s.kickoff(),i.kickoff(),o.kickoff()}),e}},Un={render:()=>{const e=document.createElement("div");e.style.width="100%",e.style.height="400px",e.style.position="relative";const t=new yn;return t.init({width:800,height:400,backgroundColor:16119285,antialias:!0}).then(()=>{e.appendChild(t.canvas);const n=vr(),r=new J({id:"text-btn-1",label:"Submit",mode:"text",onClick:()=>console.log("Submit clicked")},n,t);r.setPosition(50,50);const s=new J({id:"text-btn-2",label:"Cancel",mode:"text",onClick:()=>console.log("Cancel clicked")},n,t);s.setPosition(180,50);const i=new J({id:"text-btn-3",label:"Disabled",mode:"text",isDisabled:!0},n,t);i.setPosition(310,50),t.stage.addChild(r.container),t.stage.addChild(s.container),t.stage.addChild(i.container),r.kickoff(),s.kickoff(),i.kickoff()}),e}},Wn={render:()=>{const e=document.createElement("div");e.style.width="100%",e.style.height="400px",e.style.position="relative";const t=new yn;return t.init({width:800,height:400,backgroundColor:16119285,antialias:!0}).then(async()=>{e.appendChild(t.canvas);const n=await ge.load("/placeholder-art.png"),r=vr(),s=new J({id:"inline-btn-1",sprite:Ct(n,4491468),label:"Add Item",mode:"inline",onClick:()=>console.log("Add Item clicked")},r,t);s.setPosition(50,50);const i=new J({id:"inline-btn-2",sprite:Ct(n,13386820),label:"Delete",mode:"inline",onClick:()=>console.log("Delete clicked")},r,t);i.setPosition(200,50);const o=new J({id:"inline-btn-3",sprite:Ct(n,8947848),label:"Disabled",mode:"inline",isDisabled:!0},r,t);o.setPosition(330,50);const a=new J({id:"inline-btn-4",label:"Dropdown",rightSprite:Ct(n,16777215),mode:"inline",onClick:()=>console.log("Dropdown clicked")},r,t);a.setPosition(50,120);const c=new J({id:"inline-btn-5",sprite:Ct(n,4491468),label:"Both Icons",rightSprite:Ct(n,16777215),mode:"inline",onClick:()=>console.log("Both Icons clicked")},r,t);c.setPosition(200,120),t.stage.addChild(s.container),t.stage.addChild(i.container),t.stage.addChild(o.container),t.stage.addChild(a.container),t.stage.addChild(c.container),s.kickoff(),i.kickoff(),o.kickoff(),a.kickoff(),c.kickoff()}),e}},Vn={render:()=>{const e=document.createElement("div");e.style.width="100%",e.style.height="400px",e.style.position="relative";const t=new yn;return t.init({width:800,height:400,backgroundColor:16119285,antialias:!0}).then(async()=>{e.appendChild(t.canvas);const n=await ge.load("/placeholder-art.png"),r=vr(),s=new J({id:"icon-demo",mode:"icon",sprite:Ct(n,4491468),onClick:()=>console.log("Icon clicked")},r,t);s.setPosition(50,30);const i=new J({id:"icon-vertical-demo",mode:"iconVertical",sprite:Ct(n,8930508),label:"Vertical",onClick:()=>console.log("IconVertical clicked")},r,t);i.setPosition(50,100);const o=new J({id:"text-demo",mode:"text",label:"Text Mode",onClick:()=>console.log("Text clicked")},r,t);o.setPosition(50,190);const a=new J({id:"inline-demo",mode:"inline",sprite:Ct(n,4508808),label:"Inline Mode",onClick:()=>console.log("Inline clicked")},r,t);a.setPosition(50,250),t.stage.addChild(s.container),t.stage.addChild(i.container),t.stage.addChild(o.container),t.stage.addChild(a.container),s.kickoff(),i.kickoff(),o.kickoff(),a.kickoff()}),e}};jn.parameters={...jn.parameters,docs:{...jn.parameters?.docs,source:{originalSource:`{
  render: () => {
    const wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '400px';
    wrapper.style.position = 'relative';
    const app = new Application();
    app.init({
      width: 800,
      height: 400,
      backgroundColor: 0xf5f5f5,
      antialias: true
    }).then(async () => {
      wrapper.appendChild(app.canvas);

      // Load placeholder texture
      const texture = await Assets.load('/placeholder-art.png');
      const styleTree = createDefaultStyleTree();

      // Icon-only buttons (no labels) using sprites
      const button1 = new ButtonStore({
        id: 'btn-1',
        mode: 'icon',
        sprite: createIconSprite(texture, 0x4488cc),
        onClick: () => console.log('Blue clicked')
      }, styleTree, app);
      button1.setPosition(50, 50);
      const button2 = new ButtonStore({
        id: 'btn-2',
        mode: 'icon',
        sprite: createIconSprite(texture, 0x44cc88),
        onClick: () => console.log('Green clicked')
      }, styleTree, app);
      button2.setPosition(110, 50);
      const button3 = new ButtonStore({
        id: 'btn-3',
        mode: 'icon',
        sprite: createIconSprite(texture, 0xcc8844),
        isDisabled: true
      }, styleTree, app);
      button3.setPosition(170, 50);
      app.stage.addChild(button1.container);
      app.stage.addChild(button2.container);
      app.stage.addChild(button3.container);
      button1.kickoff();
      button2.kickoff();
      button3.kickoff();
    });
    return wrapper;
  }
}`,...jn.parameters?.docs?.source}}};Nn.parameters={...Nn.parameters,docs:{...Nn.parameters?.docs,source:{originalSource:`{
  render: () => {
    const wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '400px';
    wrapper.style.position = 'relative';
    const app = new Application();
    app.init({
      width: 800,
      height: 400,
      backgroundColor: 0xf5f5f5,
      antialias: true
    }).then(async () => {
      wrapper.appendChild(app.canvas);

      // Load placeholder texture
      const texture = await Assets.load('/placeholder-art.png');
      const styleTree = createDefaultStyleTree();

      // IconVertical buttons (icon with label below) using sprites
      const button1 = new ButtonStore({
        id: 'btn-1',
        mode: 'iconVertical',
        sprite: createIconSprite(texture, 0x4488cc),
        label: 'Blue',
        onClick: () => console.log('Blue clicked')
      }, styleTree, app);
      button1.setPosition(50, 50);
      const button2 = new ButtonStore({
        id: 'btn-2',
        mode: 'iconVertical',
        sprite: createIconSprite(texture, 0x44cc88),
        label: 'Green',
        onClick: () => console.log('Green clicked')
      }, styleTree, app);
      button2.setPosition(130, 50);
      const button3 = new ButtonStore({
        id: 'btn-3',
        mode: 'iconVertical',
        sprite: createIconSprite(texture, 0xcc8844),
        label: 'Orange',
        isDisabled: true
      }, styleTree, app);
      button3.setPosition(210, 50);
      app.stage.addChild(button1.container);
      app.stage.addChild(button2.container);
      app.stage.addChild(button3.container);
      button1.kickoff();
      button2.kickoff();
      button3.kickoff();
    });
    return wrapper;
  }
}`,...Nn.parameters?.docs?.source}}};Un.parameters={...Un.parameters,docs:{...Un.parameters?.docs,source:{originalSource:`{
  render: () => {
    const wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '400px';
    wrapper.style.position = 'relative';
    const app = new Application();
    app.init({
      width: 800,
      height: 400,
      backgroundColor: 0xf5f5f5,
      antialias: true
    }).then(() => {
      wrapper.appendChild(app.canvas);
      const styleTree = createDefaultStyleTree();

      // Create text buttons
      const button1 = new ButtonStore({
        id: 'text-btn-1',
        label: 'Submit',
        mode: 'text',
        onClick: () => console.log('Submit clicked')
      }, styleTree, app);
      button1.setPosition(50, 50);
      const button2 = new ButtonStore({
        id: 'text-btn-2',
        label: 'Cancel',
        mode: 'text',
        onClick: () => console.log('Cancel clicked')
      }, styleTree, app);
      button2.setPosition(180, 50);
      const button3 = new ButtonStore({
        id: 'text-btn-3',
        label: 'Disabled',
        mode: 'text',
        isDisabled: true
      }, styleTree, app);
      button3.setPosition(310, 50);
      app.stage.addChild(button1.container);
      app.stage.addChild(button2.container);
      app.stage.addChild(button3.container);
      button1.kickoff();
      button2.kickoff();
      button3.kickoff();
    });
    return wrapper;
  }
}`,...Un.parameters?.docs?.source}}};Wn.parameters={...Wn.parameters,docs:{...Wn.parameters?.docs,source:{originalSource:`{
  render: () => {
    const wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '400px';
    wrapper.style.position = 'relative';
    const app = new Application();
    app.init({
      width: 800,
      height: 400,
      backgroundColor: 0xf5f5f5,
      antialias: true
    }).then(async () => {
      wrapper.appendChild(app.canvas);

      // Load placeholder texture
      const texture = await Assets.load('/placeholder-art.png');
      const styleTree = createDefaultStyleTree();

      // Row 1: Inline buttons with left icon
      const button1 = new ButtonStore({
        id: 'inline-btn-1',
        sprite: createIconSprite(texture, 0x4488cc),
        label: 'Add Item',
        mode: 'inline',
        onClick: () => console.log('Add Item clicked')
      }, styleTree, app);
      button1.setPosition(50, 50);
      const button2 = new ButtonStore({
        id: 'inline-btn-2',
        sprite: createIconSprite(texture, 0xcc4444),
        label: 'Delete',
        mode: 'inline',
        onClick: () => console.log('Delete clicked')
      }, styleTree, app);
      button2.setPosition(200, 50);
      const button3 = new ButtonStore({
        id: 'inline-btn-3',
        sprite: createIconSprite(texture, 0x888888),
        label: 'Disabled',
        mode: 'inline',
        isDisabled: true
      }, styleTree, app);
      button3.setPosition(330, 50);

      // Row 2: Inline buttons with right icon
      const button4 = new ButtonStore({
        id: 'inline-btn-4',
        label: 'Dropdown',
        rightSprite: createIconSprite(texture, 0xffffff),
        mode: 'inline',
        onClick: () => console.log('Dropdown clicked')
      }, styleTree, app);
      button4.setPosition(50, 120);
      const button5 = new ButtonStore({
        id: 'inline-btn-5',
        sprite: createIconSprite(texture, 0x4488cc),
        label: 'Both Icons',
        rightSprite: createIconSprite(texture, 0xffffff),
        mode: 'inline',
        onClick: () => console.log('Both Icons clicked')
      }, styleTree, app);
      button5.setPosition(200, 120);
      app.stage.addChild(button1.container);
      app.stage.addChild(button2.container);
      app.stage.addChild(button3.container);
      app.stage.addChild(button4.container);
      app.stage.addChild(button5.container);
      button1.kickoff();
      button2.kickoff();
      button3.kickoff();
      button4.kickoff();
      button5.kickoff();
    });
    return wrapper;
  }
}`,...Wn.parameters?.docs?.source}}};Vn.parameters={...Vn.parameters,docs:{...Vn.parameters?.docs,source:{originalSource:`{
  render: () => {
    const wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '400px';
    wrapper.style.position = 'relative';
    const app = new Application();
    app.init({
      width: 800,
      height: 400,
      backgroundColor: 0xf5f5f5,
      antialias: true
    }).then(async () => {
      wrapper.appendChild(app.canvas);

      // Load placeholder texture
      const texture = await Assets.load('/placeholder-art.png');
      const styleTree = createDefaultStyleTree();

      // Row 1: Icon button (icon only, no label)
      const iconBtn = new ButtonStore({
        id: 'icon-demo',
        mode: 'icon',
        sprite: createIconSprite(texture, 0x4488cc),
        onClick: () => console.log('Icon clicked')
      }, styleTree, app);
      iconBtn.setPosition(50, 30);

      // Row 2: IconVertical button (icon with label below)
      const iconVerticalBtn = new ButtonStore({
        id: 'icon-vertical-demo',
        mode: 'iconVertical',
        sprite: createIconSprite(texture, 0x8844cc),
        label: 'Vertical',
        onClick: () => console.log('IconVertical clicked')
      }, styleTree, app);
      iconVerticalBtn.setPosition(50, 100);

      // Row 3: Text button
      const textBtn = new ButtonStore({
        id: 'text-demo',
        mode: 'text',
        label: 'Text Mode',
        onClick: () => console.log('Text clicked')
      }, styleTree, app);
      textBtn.setPosition(50, 190);

      // Row 4: Inline button (icon + text side-by-side)
      const inlineBtn = new ButtonStore({
        id: 'inline-demo',
        mode: 'inline',
        sprite: createIconSprite(texture, 0x44cc88),
        label: 'Inline Mode',
        onClick: () => console.log('Inline clicked')
      }, styleTree, app);
      inlineBtn.setPosition(50, 250);
      app.stage.addChild(iconBtn.container);
      app.stage.addChild(iconVerticalBtn.container);
      app.stage.addChild(textBtn.container);
      app.stage.addChild(inlineBtn.container);
      iconBtn.kickoff();
      iconVerticalBtn.kickoff();
      textBtn.kickoff();
      inlineBtn.kickoff();
    });
    return wrapper;
  }
}`,...Vn.parameters?.docs?.source}}};const OT=["IconButtons","IconVerticalButtons","TextButtons","InlineButtons","AllModes"],GT=Object.freeze(Object.defineProperty({__proto__:null,AllModes:Vn,IconButtons:jn,IconVerticalButtons:Nn,InlineButtons:Wn,TextButtons:Un,__namedExportsOrder:OT,default:RT},Symbol.toStringTag,{value:"Module"}));export{Wt as $,bs as A,er as B,te as C,X as D,qt as E,ie as F,gs as G,yl as H,ln as I,jl as J,Ii as K,Y as L,D as M,Xe as N,df as O,At as P,Ft as Q,at as R,zo as S,U as T,Qr as U,fm as V,gr as W,Ua as X,Xr as Y,Io as Z,Dl as _,$l as a,Il as a0,Wm as a1,Zm as a2,Qm as a3,qm as a4,Kd as a5,ng as a6,Mt as a7,il as a8,Dt as a9,ps as aa,Ta as ab,hn as ac,qy as ad,Mf as ae,Pa as af,Ws as ag,ka as ah,If as ai,cl as aj,Sy as ak,Nl as al,mr as am,zp as an,Pp as ao,Cm as ap,bm as aq,Vm as ar,Hm as as,tg as at,Jm as au,eg as av,GT as aw,Pl as b,an as c,G as d,Ui as e,Wi as f,Dr as g,ut as h,Re as i,gt as j,V as k,Iy as l,Jf as m,gm as n,kt as o,it as p,Yr as q,al as r,E as s,rs as t,hp as u,st as v,Q as w,_g as x,_s as y,hg as z};
